
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Coronary Heart Disease Prediction with Deep Learning &#8212; Arno&#39;s Projects Collection</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'archive/coronary-heart-disease-study';</script>
    <link rel="canonical" href="docs.arnozeng.com/archive/coronary-heart-disease-study.html" />
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Blogs" href="blogs.html" />
    <link rel="prev" title="House Prices (R)" href="house-prices-r.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Arno's Projects Collection - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Arno's Projects Collection - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Arno’s Projects Collection
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="house-prices-py.html">House Prices (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="house-prices-r.html">House Prices (R)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Deep Learning</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Coronary Heart Disease Prediction with Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="blogs.html">Blogs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NLP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cfg-parsers.html">CFG Parsers</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/arnozeng98/data-science-archive" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/arnozeng98/data-science-archive/issues/new?title=Issue%20on%20page%20%2Farchive/coronary-heart-disease-study.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/archive/coronary-heart-disease-study.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Coronary Heart Disease Prediction with Deep Learning</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#objective">Objective</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-description">Dataset Description</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#key-considerations">Key Considerations:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-inspect-the-data">Load and Inspect the Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning-and-visualization">Data Cleaning and Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-data">Understanding the Data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">Data Cleaning</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#renaming-columns">Renaming Columns</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-missing-values">Handling Missing Values</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-visualization">Data Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-numerical-variables">Distribution of Numerical Variables</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-analysis">Correlation Analysis</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#relationship-between-chd-and-other-variables">Relationship Between CHD and Other Variables</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#kaplan-meier-survival-analysis">Kaplan-Meier Survival Analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chd-categorical-variable-analysis-chi-square-tests">CHD &amp; Categorical Variable Analysis (Chi-Square Tests)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#smoking-chd-risk-analysis">Smoking &amp; CHD Risk Analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#blood-pressure-vs-chd-risk">Blood Pressure vs. CHD Risk</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cholesterol-levels-chd">Cholesterol Levels &amp; CHD</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encoding-categorical-variables">Encoding Categorical Variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling">Modeling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#baseline-machine-learning-models">Baseline Machine Learning Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-learning-model-mlp-multi-layer-perceptron">Deep Learning Model (MLP - Multi-Layer Perceptron)</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="coronary-heart-disease-prediction-with-deep-learning">
<h1>Coronary Heart Disease Prediction with Deep Learning<a class="headerlink" href="#coronary-heart-disease-prediction-with-deep-learning" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<section id="background">
<h3>Background<a class="headerlink" href="#background" title="Link to this heading">#</a></h3>
<p>Coronary Heart Disease (CHD) is one of the leading causes of mortality worldwide, primarily caused by the narrowing or blockage of coronary arteries due to plaque buildup. Several risk factors, including high cholesterol, high blood pressure, smoking, and behavioral traits, contribute to its development.</p>
<p>The Western Collaborative Group Study (WCGS) was one of the earliest large-scale prospective studies to examine the relationship between personality traits, lifestyle factors, and CHD. The study began in 1960 with a cohort of 3,154 middle-aged men (39-59 years old) who were initially free from CHD. Participants were monitored for 8.5 years, and CHD outcomes were recorded.</p>
<p>This dataset provides an opportunity to explore the impact of behavioral, physiological, and demographic factors on CHD risk, and to develop machine learning models for predicting CHD incidence.</p>
</section>
<section id="objective">
<h3>Objective<a class="headerlink" href="#objective" title="Link to this heading">#</a></h3>
<p>The primary goal of this project is to build an advanced predictive model for Coronary Heart Disease using deep learning techniques, while also comparing the performance of traditional machine learning models. Specifically, we aim to:</p>
<ul class="simple">
<li><p>Explore key risk factors associated with CHD through statistical and exploratory analysis.</p></li>
<li><p>Compare traditional machine learning models (Logistic Regression, KNN, Boosting) with deep learning models (Multi-Layer Perceptron - MLP) for CHD prediction.</p></li>
<li><p>Implement robust evaluation metrics (Confusion Matrix, Precision, Recall, F1-score, and ROC-AUC) to enhance the interpretability and clinical relevance of the models.</p></li>
<li><p>Apply explainability techniques (SHAP &amp; LIME) to understand model decisions and provide insights into feature importance.</p></li>
</ul>
</section>
<section id="dataset-description">
<h3>Dataset Description<a class="headerlink" href="#dataset-description" title="Link to this heading">#</a></h3>
<p>This dataset originates from the Western Collaborative Group Study (WCGS), which aimed to investigate CHD risk factors among middle-aged men. The study followed 3,154 participants over 8.5 years and recorded various behavioral, physiological, and medical data.</p>
<p>The dataset includes the following variables:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">age</span></code></p></td>
<td><p>Age in years (39-59)</p></td>
<td><p>Integer</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">height</span></code></p></td>
<td><p>Height in inches</p></td>
<td><p>Integer</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">weight</span></code></p></td>
<td><p>Weight in pounds</p></td>
<td><p>Integer</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sdp</span></code></p></td>
<td><p>Systolic Blood Pressure (mmHg)</p></td>
<td><p>Integer</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dbp</span></code></p></td>
<td><p>Diastolic Blood Pressure (mmHg)</p></td>
<td><p>Integer</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">chol</span></code></p></td>
<td><p>Fasting Serum Cholesterol (mg/dL)</p></td>
<td><p>Integer</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">behave</span></code></p></td>
<td><p>Behavior type (A1, A2, B3, B4)</p></td>
<td><p>Categorical</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cigs</span></code></p></td>
<td><p>Number of cigarettes smoked per day</p></td>
<td><p>Integer</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dibep</span></code></p></td>
<td><p>Personality type: A (Aggressive) or B (Passive)</p></td>
<td><p>Categorical</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">chd</span></code></p></td>
<td><p>Presence of CHD: “no” or “yes”</p></td>
<td><p>Categorical (Target Variable)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">typechd</span></code></p></td>
<td><p>Type of CHD: None, Silent, Angina, Infdeath</p></td>
<td><p>Categorical</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">timechd</span></code></p></td>
<td><p>Time of CHD event (days) or study endpoint</p></td>
<td><p>Integer</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">arcus</span></code></p></td>
<td><p>Presence of Arcus Senilis (eye condition): Absent/Present</p></td>
<td><p>Categorical</p></td>
</tr>
</tbody>
</table>
</div>
<section id="key-considerations">
<h4>Key Considerations:<a class="headerlink" href="#key-considerations" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Behavioral Traits (<code class="docutils literal notranslate"><span class="pre">behave</span></code>, <code class="docutils literal notranslate"><span class="pre">dibep</span></code>):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">behave</span></code> contains four personality categories (A1, A2, B3, B4), though the exact definitions are unclear in the dataset documentation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dibep</span></code> categorizes participants into Type A (aggressive, competitive) and Type B (relaxed, passive) personalities, which have been hypothesized to impact CHD risk.</p></li>
</ul>
</li>
<li><p>CHD Outcome (<code class="docutils literal notranslate"><span class="pre">chd</span></code>, <code class="docutils literal notranslate"><span class="pre">typechd</span></code>, <code class="docutils literal notranslate"><span class="pre">timechd</span></code>):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">chd</span></code>: Indicates whether the participant developed CHD during the study (<code class="docutils literal notranslate"><span class="pre">yes</span></code> or <code class="docutils literal notranslate"><span class="pre">no</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typechd</span></code>: Specifies the type of CHD, categorized into:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: No CHD developed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;silent&quot;</span></code>: Asymptomatic CHD, detected only through medical exams.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;angina&quot;</span></code>: Chest pain due to restricted blood flow.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;infdeath&quot;</span></code>: Sudden cardiac death (likely due to myocardial infarction).</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">timechd</span></code>: If CHD developed, records the time of occurrence in days; otherwise, it marks the participant’s last follow-up.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standard Libraries</span>
<span class="kn">import</span> <span class="nn">os</span>  <span class="c1"># Provides functions to interact with the operating system</span>

<span class="c1"># Data Manipulation &amp; Visualization</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1"># Data manipulation and analysis</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>   <span class="c1"># Numerical computations and array handling</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># Data visualization (static plots)</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>            <span class="c1"># Statistical data visualization (extends Matplotlib)</span>

<span class="c1"># Preprocessing &amp; Model Selection</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>  <span class="c1"># Handles missing data imputation</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>  <span class="c1"># Splits dataset into training and test sets</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>      <span class="c1"># Standardizes features by removing the mean </span>
                                                      <span class="c1"># and scaling to unit variance</span>
<span class="c1"># Statistical Analysis</span>
<span class="kn">from</span> <span class="nn">lifelines</span> <span class="kn">import</span> <span class="n">KaplanMeierFitter</span>   <span class="c1"># Survival analysis using Kaplan-Meier estimator</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>  <span class="c1"># Performs the chi-squared test for categorical variables</span>

<span class="c1"># Machine Learning Models</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>      <span class="c1"># Logistic Regression classifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>       <span class="c1"># K-Nearest Neighbors classifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>  <span class="c1"># Gradient Boosting classifier</span>

<span class="c1"># Model Evaluation Metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">roc_auc_score</span>  <span class="c1"># Performance metrics for models</span>

<span class="c1"># Imbalanced Data Handling</span>
<span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">SMOTE</span>  <span class="c1"># Synthetic Minority Over-sampling Technique (SMOTE) for handling imbalanced data</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>  <span class="c1"># Helps in counting occurrences of elements (useful for class distribution checks)</span>

<span class="c1"># Deep Learning (TensorFlow/Keras)</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>       <span class="c1"># Core TensorFlow library for deep learning</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>  <span class="c1"># High-level API for building neural networks</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>        <span class="c1"># Sequential model structure for deep learning</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Input</span>  <span class="c1"># Neural network layers</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span>          <span class="c1"># Adam optimizer for training deep learning models</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.callbacks</span> <span class="kn">import</span> <span class="n">EarlyStopping</span>  <span class="c1"># Stops training early to prevent overfitting</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="exploratory-data-analysis-eda">
<h2>Exploratory Data Analysis (EDA)<a class="headerlink" href="#exploratory-data-analysis-eda" title="Link to this heading">#</a></h2>
<section id="load-and-inspect-the-data">
<h3>Load and Inspect the Data<a class="headerlink" href="#load-and-inspect-the-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the data path using os.path.join for cross-platform compatibility</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;wcgs&quot;</span><span class="p">,</span> <span class="s2">&quot;datawcgs.csv&quot;</span><span class="p">)</span>

<span class="c1"># Load the dataset</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display basic information about the dataset</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 3154 entries, 0 to 3153
Data columns (total 15 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   Unnamed: 0  3154 non-null   int64  
 1   id          3154 non-null   int64  
 2   age0        3154 non-null   int64  
 3   height0     3154 non-null   int64  
 4   weight0     3154 non-null   int64  
 5   sbp0        3154 non-null   int64  
 6   dbp0        3154 non-null   int64  
 7   chol0       3142 non-null   float64
 8   behpat0     3154 non-null   int64  
 9   ncigs0      3154 non-null   int64  
 10  dibpat0     3154 non-null   int64  
 11  chd69       3154 non-null   int64  
 12  typechd     3154 non-null   int64  
 13  time169     3154 non-null   int64  
 14  arcus0      3152 non-null   float64
dtypes: float64(2), int64(13)
memory usage: 369.7 KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the first few rows</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>id</th>
      <th>age0</th>
      <th>height0</th>
      <th>weight0</th>
      <th>sbp0</th>
      <th>dbp0</th>
      <th>chol0</th>
      <th>behpat0</th>
      <th>ncigs0</th>
      <th>dibpat0</th>
      <th>chd69</th>
      <th>typechd</th>
      <th>time169</th>
      <th>arcus0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2001</td>
      <td>49</td>
      <td>73</td>
      <td>150</td>
      <td>110</td>
      <td>76</td>
      <td>225.0</td>
      <td>2</td>
      <td>25</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1664</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2002</td>
      <td>42</td>
      <td>70</td>
      <td>160</td>
      <td>154</td>
      <td>84</td>
      <td>177.0</td>
      <td>2</td>
      <td>20</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>3071</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>2003</td>
      <td>42</td>
      <td>69</td>
      <td>160</td>
      <td>110</td>
      <td>78</td>
      <td>181.0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3071</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>2004</td>
      <td>41</td>
      <td>68</td>
      <td>152</td>
      <td>124</td>
      <td>78</td>
      <td>132.0</td>
      <td>4</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3064</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>2005</td>
      <td>59</td>
      <td>70</td>
      <td>150</td>
      <td>144</td>
      <td>86</td>
      <td>255.0</td>
      <td>3</td>
      <td>20</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1885</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="data-cleaning-and-visualization">
<h3>Data Cleaning and Visualization<a class="headerlink" href="#data-cleaning-and-visualization" title="Link to this heading">#</a></h3>
<section id="understanding-the-data">
<h4>Understanding the Data<a class="headerlink" href="#understanding-the-data" title="Link to this heading">#</a></h4>
<p>Before performing any analysis, it is crucial to inspect the dataset and understand its structure.</p>
<ul>
<li><p>Dataset Size: 3,154 observations and 15 columns.</p></li>
<li><p>Missing Values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">chol0</span></code> (cholesterol) has 12 missing values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">arcus0</span></code> (Arcus Senilis) has 2 missing values.</p></li>
</ul>
</li>
<li><p>Column Renaming Required:</p>
<p>The current column names differ from standard medical terms and need renaming for better readability.</p>
</li>
<li><p>Unnecessary Columns:</p>
<p><code class="docutils literal notranslate"><span class="pre">Unnamed:</span> <span class="pre">0</span></code> (index column) and <code class="docutils literal notranslate"><span class="pre">id</span></code> (participant ID) are irrelevant for analysis.</p>
</li>
</ul>
</section>
<section id="data-cleaning">
<h4>Data Cleaning<a class="headerlink" href="#data-cleaning" title="Link to this heading">#</a></h4>
<section id="renaming-columns">
<h5>Renaming Columns<a class="headerlink" href="#renaming-columns" title="Link to this heading">#</a></h5>
<p>We rename columns to align with medical terminology and improve clarity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rename columns to match documentation</span>
<span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;age0&quot;</span><span class="p">:</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;height0&quot;</span><span class="p">:</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;weight0&quot;</span><span class="p">:</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sbp0&quot;</span><span class="p">:</span> <span class="s2">&quot;sdp&quot;</span><span class="p">,</span> <span class="s2">&quot;dbp0&quot;</span><span class="p">:</span> <span class="s2">&quot;dbp&quot;</span><span class="p">,</span> <span class="s2">&quot;chol0&quot;</span><span class="p">:</span> <span class="s2">&quot;chol&quot;</span><span class="p">,</span>
    <span class="s2">&quot;behpat0&quot;</span><span class="p">:</span> <span class="s2">&quot;behave&quot;</span><span class="p">,</span> <span class="s2">&quot;ncigs0&quot;</span><span class="p">:</span> <span class="s2">&quot;cigs&quot;</span><span class="p">,</span> <span class="s2">&quot;dibpat0&quot;</span><span class="p">:</span> <span class="s2">&quot;dibep&quot;</span><span class="p">,</span>
    <span class="s2">&quot;chd69&quot;</span><span class="p">:</span> <span class="s2">&quot;chd&quot;</span><span class="p">,</span> <span class="s2">&quot;typechd&quot;</span><span class="p">:</span> <span class="s2">&quot;typechd&quot;</span><span class="p">,</span> <span class="s2">&quot;time169&quot;</span><span class="p">:</span> <span class="s2">&quot;timechd&quot;</span><span class="p">,</span>
    <span class="s2">&quot;arcus0&quot;</span><span class="p">:</span> <span class="s2">&quot;arcus&quot;</span>
<span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Drop unnecessary columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Unnamed: 0&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="handling-missing-values">
<h5>Handling Missing Values<a class="headerlink" href="#handling-missing-values" title="Link to this heading">#</a></h5>
<p>Since <code class="docutils literal notranslate"><span class="pre">chol</span></code> and <code class="docutils literal notranslate"><span class="pre">arcus</span></code> contain missing values, we need to impute them appropriately:</p>
<p>Numerical (<code class="docutils literal notranslate"><span class="pre">chol</span></code>): Use median imputation as cholesterol levels might have a skewed distribution.
Categorical (<code class="docutils literal notranslate"><span class="pre">arcus</span></code>): Use most frequent category as missing values are minimal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Impute numerical columns (median for chol)</span>
<span class="n">num_imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;chol&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">num_imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;chol&#39;</span><span class="p">]])</span>

<span class="c1"># Impute categorical columns (most frequent for arcus)</span>
<span class="n">cat_imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;most_frequent&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;arcus&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">cat_imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;arcus&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="data-visualization">
<h4>Data Visualization<a class="headerlink" href="#data-visualization" title="Link to this heading">#</a></h4>
<section id="distribution-of-numerical-variables">
<h5>Distribution of Numerical Variables<a class="headerlink" href="#distribution-of-numerical-variables" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define numerical columns</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;sdp&#39;</span><span class="p">,</span> <span class="s1">&#39;dbp&#39;</span><span class="p">,</span> <span class="s1">&#39;chol&#39;</span><span class="p">,</span> <span class="s1">&#39;cigs&#39;</span><span class="p">,</span> <span class="s1">&#39;timechd&#39;</span><span class="p">]</span>

<span class="c1"># Plot distributions of numerical features</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">num_cols</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribution of </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/89687c8a246f184de1503caf28ea37a205473587edf25cbf4980b6ed532791e7.png" src="../_images/89687c8a246f184de1503caf28ea37a205473587edf25cbf4980b6ed532791e7.png" />
</div>
</div>
<p>Based on the histograms and KDE (Kernel Density Estimation) plots of the six numerical variables, we can derive the following insights:</p>
<ol class="arabic">
<li><p>Age (age)</p>
<p>The distribution is right-skewed, meaning that younger individuals dominate the dataset, while older individuals are fewer. This suggests a potential sample selection bias toward individuals aged between 40 and 55.</p>
</li>
<li><p>Systolic Blood Pressure (sdp)</p>
<p>The distribution is positively skewed (right-skewed), with most individuals having systolic blood pressure in the range of 100-160, but some extreme values exceed 180, indicating hypertension cases. Outliers should be further examined to identify individuals at high risk of hypertension.</p>
</li>
<li><p>Diastolic Blood Pressure (dbp)</p>
<p>The distribution is approximately normal but slightly right-skewed. Most values fall between 60-100, but a few cases exceed 120, suggesting possible hypertension cases.</p>
</li>
<li><p>Cholesterol Level (chol)</p>
<p>The distribution appears to be roughly normal, with most individuals having cholesterol levels between 150-250. Some individuals exhibit high cholesterol levels (&gt;300), which might indicate hyperlipidemia or other health conditions.</p>
</li>
<li><p>Cigarette Consumption (cigs)</p>
<p>The distribution is highly right-skewed, with a significant proportion of individuals being non-smokers (high peak at 0). Among smokers, the consumption is quite variable, with some individuals smoking 10-40 cigarettes per day, while a few extreme cases smoke nearly 100 cigarettes daily. It might be beneficial to separate smokers and non-smokers for further analysis to evaluate the impact of smoking on health.</p>
</li>
<li><p>Time to CHD Event (timechd)</p>
<ul class="simple">
<li><p>The distribution exhibits a bimodal pattern, suggesting two distinct groups:</p>
<ul>
<li><p>First peak (left side): Individuals who experience CHD (Coronary Heart Disease) events relatively early.</p></li>
<li><p>Second peak (right side): Individuals who do not experience CHD for a long time (possibly those with protective factors or lower risk).</p></li>
</ul>
</li>
<li><p>This distribution suggests that some individuals develop CHD much earlier than others, likely due to genetic, lifestyle, or environmental factors.</p></li>
</ul>
</li>
</ol>
</section>
<section id="correlation-analysis">
<h5>Correlation Analysis<a class="headerlink" href="#correlation-analysis" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only numeric columns for correlation calculation</span>
<span class="n">numeric_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>

<span class="c1"># Compute correlation matrix</span>
<span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">numeric_df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Plot correlation heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Feature Correlation Heatmap&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8b07426406a4913923a1de17e4b123baa1a49bcf942af0557a69b6374088acc2.png" src="../_images/8b07426406a4913923a1de17e4b123baa1a49bcf942af0557a69b6374088acc2.png" />
</div>
</div>
<p>This heatmap displays the Pearson correlation coefficients between numerical features in the dataset. The color scale ranges from red (positive correlation) to blue (negative correlation), with values between -1 and 1.</p>
<p>Key Observations:</p>
<ol class="arabic">
<li><p>Strong Positive Correlation Between Blood Pressure Metrics (sdp and dbp)</p>
<p>Systolic Blood Pressure (sdp) and Diastolic Blood Pressure (dbp) have a correlation of <code class="docutils literal notranslate"><span class="pre">0.77</span></code>, indicating that individuals with high systolic blood pressure also tend to have high diastolic blood pressure. This aligns with medical knowledge, as hypertensive patients typically experience increases in both measures.</p>
</li>
<li><p>High Correlation Between Coronary Heart Disease (chd) and Its Type (typechd)</p>
<p><code class="docutils literal notranslate"><span class="pre">chd</span></code> and <code class="docutils literal notranslate"><span class="pre">typechd</span></code> have a very high correlation (0.90), suggesting that typechd is likely a subcategory or closely related to <code class="docutils literal notranslate"><span class="pre">chd</span></code>.</p>
</li>
<li><p>Moderate Negative Correlation Between Coronary Heart Disease (chd) and Time to CHD Event (timechd)</p>
<p>The correlation between <code class="docutils literal notranslate"><span class="pre">chd</span></code> and <code class="docutils literal notranslate"><span class="pre">timechd</span></code> is <code class="docutils literal notranslate"><span class="pre">-0.46</span></code>, meaning that individuals who experience CHD events earlier tend to have lower <code class="docutils literal notranslate"><span class="pre">timechd</span></code> values. This suggests that those at higher risk for CHD tend to develop it sooner.</p>
</li>
<li><p>Moderate Positive Correlation Between Weight and Height</p>
<p><code class="docutils literal notranslate"><span class="pre">weight</span></code> and <code class="docutils literal notranslate"><span class="pre">height</span></code> have a correlation of <code class="docutils literal notranslate"><span class="pre">0.53</span></code>, indicating that taller individuals generally have higher body weight. This is expected due to natural body proportions.</p>
</li>
<li><p>Strong Negative Correlation Between Behavioral Pattern (behave) and Diabetes (dibep)</p>
<p><code class="docutils literal notranslate"><span class="pre">behave</span></code> and <code class="docutils literal notranslate"><span class="pre">dibep</span></code> have a strong negative correlation (<code class="docutils literal notranslate"><span class="pre">-0.87</span></code>), suggesting that certain behavioral patterns may significantly influence diabetes risk. Healthier behaviors might reduce the likelihood of diabetes, or conversely, certain behaviors could be risk factors.</p>
</li>
<li><p>Strong Negative Correlation Between Smoking (cigs) and Behavioral Pattern (behave)</p>
<p><code class="docutils literal notranslate"><span class="pre">cigs</span></code> and <code class="docutils literal notranslate"><span class="pre">behave</span></code> show a negative correlation (<code class="docutils literal notranslate"><span class="pre">-0.87</span></code>), suggesting that smoking habits are closely linked to specific behaviors. This could indicate that unhealthy lifestyle choices are often associated with smoking.</p>
</li>
<li><p>Weak Positive Correlation Between Age and Arcus</p>
<p><code class="docutils literal notranslate"><span class="pre">age</span></code> and <code class="docutils literal notranslate"><span class="pre">arcus</span></code> have a correlation of <code class="docutils literal notranslate"><span class="pre">0.19</span></code>, indicating that older individuals are slightly more likely to develop <code class="docutils literal notranslate"><span class="pre">arcus</span></code> (possibly a vascular or ocular condition).</p>
</li>
</ol>
</section>
<section id="relationship-between-chd-and-other-variables">
<h5>Relationship Between CHD and Other Variables<a class="headerlink" href="#relationship-between-chd-and-other-variables" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Boxplot of key variables vs CHD</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">num_cols</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;chd&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">3</span>])
    <span class="n">axes</span><span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">3</span>].set_title(f&#39;{col} vs CHD&#39;)

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a3f56ee5e8cd0acb469a069e8c7a6597ceba62bcddf266ee22a02509790d2255.png" src="../_images/a3f56ee5e8cd0acb469a069e8c7a6597ceba62bcddf266ee22a02509790d2255.png" />
</div>
</div>
<p>These boxplots illustrate the distribution of key numerical variables across two groups: CHD (Coronary Heart Disease) present (<code class="docutils literal notranslate"><span class="pre">chd=1</span></code>) vs. CHD absent (<code class="docutils literal notranslate"><span class="pre">chd=0</span></code>). This helps us understand how different factors might influence CHD risk.</p>
<ol class="arabic">
<li><p>Age (age) vs CHD</p>
<p>The median age of <code class="docutils literal notranslate"><span class="pre">chd=1</span></code> (CHD patients) is slightly higher than that of <code class="docutils literal notranslate"><span class="pre">chd=0</span></code>. The overall age distribution is similar, but CHD patients tend to be slightly older. Possible explanation: Older individuals are generally at a higher risk for CHD.</p>
</li>
<li><p>Systolic Blood Pressure (sdp) vs CHD</p>
<p>The median systolic blood pressure (sdp) is higher in the <code class="docutils literal notranslate"><span class="pre">chd=1</span></code> group than in the <code class="docutils literal notranslate"><span class="pre">chd=0</span></code> group. The <code class="docutils literal notranslate"><span class="pre">chd=1</span></code> group also has a higher upper quartile and more extreme outliers, indicating that high blood pressure is common among CHD patients. Possible explanation: Hypertension is likely a major risk factor for CHD.</p>
</li>
<li><p>Diastolic Blood Pressure (dbp) vs CHD</p>
<p>The diastolic blood pressure (dbp) distribution is similar to sdp, but the difference between <code class="docutils literal notranslate"><span class="pre">chd=0</span></code> and <code class="docutils literal notranslate"><span class="pre">chd=1</span></code> is less pronounced. While the median is slightly higher for CHD patients, the distinction is not as strong as for sdp. Possible explanation: Systolic blood pressure may have a stronger impact on CHD risk compared to diastolic blood pressure.</p>
</li>
<li><p>Cholesterol (chol) vs CHD</p>
<p>The median cholesterol (chol) levels are similar for both groups. However, <code class="docutils literal notranslate"><span class="pre">chd=1</span></code> has more extreme outliers (values exceeding 400-600), suggesting that high cholesterol levels might be more prevalent in CHD patients. Possible explanation: Extremely high cholesterol could contribute to CHD, but the overall trend does not show a significant difference between groups.</p>
</li>
<li><p>Cigarette Consumption (cigs) vs CHD</p>
<p>The median number of cigarettes smoked per day is slightly higher for CHD patients, but there is substantial overlap between the two groups. The <code class="docutils literal notranslate"><span class="pre">chd=1</span></code> group includes more heavy smokers (outliers reaching nearly 100 cigarettes per day). Possible explanation: Smoking may be a risk factor for CHD, but the variation suggests other contributing factors.</p>
</li>
<li><p>Time to CHD Event (timechd) vs CHD</p>
<p>The <code class="docutils literal notranslate"><span class="pre">chd=1</span></code> group has a much lower median timechd, with a more evenly spread distribution. In contrast, <code class="docutils literal notranslate"><span class="pre">chd=0</span></code> has many high values (right-skewed), indicating that these individuals have not developed CHD for a long time. Possible explanation: People who develop CHD tend to have lower <code class="docutils literal notranslate"><span class="pre">timechd</span></code> values, meaning CHD occurs earlier in their lifetime.</p>
</li>
</ol>
</section>
</section>
<section id="kaplan-meier-survival-analysis">
<h4>Kaplan-Meier Survival Analysis<a class="headerlink" href="#kaplan-meier-survival-analysis" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize Kaplan-Meier Fitter</span>
<span class="n">kmf</span> <span class="o">=</span> <span class="n">KaplanMeierFitter</span><span class="p">()</span>

<span class="c1"># Fit model: Survival time until CHD occurrence</span>
<span class="n">kmf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;timechd&#39;</span><span class="p">],</span> <span class="n">event_observed</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;chd&#39;</span><span class="p">])</span>

<span class="c1"># Plot Survival Curve</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">kmf</span><span class="o">.</span><span class="n">plot_survival_function</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Kaplan-Meier Survival Curve for CHD&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Days Followed Up&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Survival Probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/85a8bb626405983c8f254046f29924438c53a05c108db5f76235368e38b27e21.png" src="../_images/85a8bb626405983c8f254046f29924438c53a05c108db5f76235368e38b27e21.png" />
</div>
</div>
<p>The Kaplan-Meier survival curve displayed above represents the probability of remaining free from Coronary Heart Disease (CHD) over time, based on the dataset.</p>
<p>Key Observations:</p>
<ol class="arabic">
<li><p>Overall Declining Trend:</p>
<p>The survival probability decreases gradually over time, indicating that as more time passes, the likelihood of remaining CHD-free decreases. This suggests that CHD incidence accumulates as individuals age.</p>
</li>
<li><p>Survival Probability:</p>
<p>Initially, the survival probability starts close to 1.0 (100%), meaning that at the beginning of the study, nearly everyone is free from CHD. Over time, this probability declines, approaching approximately 0.85 (85%) at the later stages of follow-up.</p>
</li>
<li><p>Confidence Interval (Shaded Area):</p>
<p>The light blue shaded area represents the 95% confidence interval (CI) around the survival estimate. The wider CI towards the end of the curve suggests increasing uncertainty due to fewer remaining participants in the study. The survival estimates are more reliable in the early stages and become less precise later due to a smaller sample size.</p>
</li>
<li><p>Small Drops in the Curve:</p>
<p>The stepwise declines indicate instances where CHD cases occurred. Each step down in the curve corresponds to an event where an individual developed CHD. The gradual decrease suggests no abrupt increase in CHD incidence but rather a steady accumulation of cases over time.</p>
</li>
</ol>
</section>
<section id="chd-categorical-variable-analysis-chi-square-tests">
<h4>CHD &amp; Categorical Variable Analysis (Chi-Square Tests)<a class="headerlink" href="#chd-categorical-variable-analysis-chi-square-tests" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define categorical variables</span>
<span class="n">cat_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;behave&#39;</span><span class="p">,</span> <span class="s1">&#39;dibep&#39;</span><span class="p">,</span> <span class="s1">&#39;arcus&#39;</span><span class="p">,</span> <span class="s1">&#39;typechd&#39;</span><span class="p">]</span>

<span class="c1"># Conduct chi-square test for each categorical feature</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">cat_vars</span><span class="p">:</span>
    <span class="n">contingency_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;chd&#39;</span><span class="p">])</span>
    <span class="n">chi2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi-Square Test for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">: p-value = </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-Square Test for behave: p-value = 0.00000
Chi-Square Test for dibep: p-value = 0.00000
Chi-Square Test for arcus: p-value = 0.00041
Chi-Square Test for typechd: p-value = 0.00000
</pre></div>
</div>
</div>
</div>
<ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">behave</span></code> (Behavior Pattern) and CHD (p = 0.00000)</p>
<p>The extremely low p-value indicates a strong association between behavior patterns (<code class="docutils literal notranslate"><span class="pre">behave</span></code>) and CHD occurrence. Certain lifestyle habits or behaviors may significantly contribute to CHD risk.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">dibep</span></code> (Diabetes Presence) and CHD (p = 0.00000)</p>
<p>A very strong statistical association exists between diabetes (<code class="docutils literal notranslate"><span class="pre">dibep</span></code>) and CHD. This confirms that individuals with diabetes are at a significantly higher risk of developing CHD.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">arcus</span></code> (Arcus Cornealis) and CHD (p = 0.00041)</p>
<p>While not as strong as the previous two variables, <code class="docutils literal notranslate"><span class="pre">arcus</span></code> still shows a statistically significant association with CHD. Arcus cornealis is a lipid deposit in the cornea, often associated with high cholesterol levels, which could explain its link to CHD.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">typechd</span></code> (CHD Type) and CHD (p = 0.00000)</p>
<p>The strongest association (p = 0.00000) is between <code class="docutils literal notranslate"><span class="pre">typechd</span></code> and <code class="docutils literal notranslate"><span class="pre">chd</span></code>, which is expected because <code class="docutils literal notranslate"><span class="pre">typechd</span></code> likely represents a classification of CHD cases.</p>
</li>
</ol>
</section>
<section id="smoking-chd-risk-analysis">
<h4>Smoking &amp; CHD Risk Analysis<a class="headerlink" href="#smoking-chd-risk-analysis" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># KDE Plot: Smoking habits by CHD status</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;chd&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;cigs&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No CHD&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;chd&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;cigs&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CHD&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Smoking Habit Distribution (CHD vs. No CHD)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Cigarettes Per Day&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6a5eec2ea09f2979784b6e1ae7b5e7b159fae30d91baf4871bf70683becd8d71.png" src="../_images/6a5eec2ea09f2979784b6e1ae7b5e7b159fae30d91baf4871bf70683becd8d71.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare smoking habits statistically</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;chd&#39;</span><span class="p">)[</span><span class="s1">&#39;cigs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>chd</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2897.0</td>
      <td>11.151191</td>
      <td>14.328812</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>20.0</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>257.0</td>
      <td>16.665370</td>
      <td>15.657120</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>20.0</td>
      <td>30.0</td>
      <td>60.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="blood-pressure-vs-chd-risk">
<h4>Blood Pressure vs. CHD Risk<a class="headerlink" href="#blood-pressure-vs-chd-risk" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Boxplots for Blood Pressure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;chd&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sdp&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Systolic Blood Pressure (SBP) vs CHD&quot;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;chd&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;dbp&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Diastolic Blood Pressure (DBP) vs CHD&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c47177d6c67721c4be83eac23130046ea7a241c42da8914386feac70a9733f72.png" src="../_images/c47177d6c67721c4be83eac23130046ea7a241c42da8914386feac70a9733f72.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare blood pressure between CHD and non-CHD</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;chd&#39;</span><span class="p">)[[</span><span class="s1">&#39;sdp&#39;</span><span class="p">,</span> <span class="s1">&#39;dbp&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">sdp</th>
      <th colspan="8" halign="left">dbp</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>chd</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2897.0</td>
      <td>128.033828</td>
      <td>14.745688</td>
      <td>98.0</td>
      <td>118.0</td>
      <td>126.0</td>
      <td>136.0</td>
      <td>230.0</td>
      <td>2897.0</td>
      <td>81.722817</td>
      <td>9.620751</td>
      <td>58.0</td>
      <td>76.0</td>
      <td>80.0</td>
      <td>86.0</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>257.0</td>
      <td>135.385214</td>
      <td>17.472620</td>
      <td>100.0</td>
      <td>124.0</td>
      <td>130.0</td>
      <td>144.0</td>
      <td>200.0</td>
      <td>257.0</td>
      <td>85.315175</td>
      <td>10.310695</td>
      <td>64.0</td>
      <td>80.0</td>
      <td>84.0</td>
      <td>90.0</td>
      <td>122.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="cholesterol-levels-chd">
<h4>Cholesterol Levels &amp; CHD<a class="headerlink" href="#cholesterol-levels-chd" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Boxplot for Cholesterol vs CHD</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;chd&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;chol&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Cholesterol Levels vs CHD&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/346509cec4926546979f5018b3af28285dda6e43e72b11e7da88f5ff474cf248.png" src="../_images/346509cec4926546979f5018b3af28285dda6e43e72b11e7da88f5ff474cf248.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># KDE Plot for Cholesterol</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;chd&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;chol&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No CHD&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;chd&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;chol&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CHD&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Cholesterol Distribution (CHD vs. No CHD)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Cholesterol Level (mg/dL)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bf3fcab22ca51f1ea124da7e12c99ad20355bc9f5e81e8a69397830842f94e15.png" src="../_images/bf3fcab22ca51f1ea124da7e12c99ad20355bc9f5e81e8a69397830842f94e15.png" />
</div>
</div>
</section>
</section>
<section id="preprocessing">
<h3>Preprocessing<a class="headerlink" href="#preprocessing" title="Link to this heading">#</a></h3>
<section id="encoding-categorical-variables">
<h4>Encoding Categorical Variables<a class="headerlink" href="#encoding-categorical-variables" title="Link to this heading">#</a></h4>
<p>Several columns are categorical but stored as integers. We need to convert them into appropriate data types and apply encoding:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert categorical variables to string type</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;behave&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;behave&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;dibep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dibep&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;arcus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;arcus&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;typechd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;typechd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c1"># One-hot encode categorical variables</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;behave&#39;</span><span class="p">,</span> <span class="s1">&#39;dibep&#39;</span><span class="p">,</span> <span class="s1">&#39;arcus&#39;</span><span class="p">,</span> <span class="s1">&#39;typechd&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>One-hot encoding converts categorical variables into binary indicator columns. <code class="docutils literal notranslate"><span class="pre">drop_first=True</span></code> avoids the “dummy variable trap” by removing the first category from each variable (preventing multicollinearity in models). New binary columns are created for all unique categories (except the first one).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define features (X) and target variable (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;chd&#39;</span><span class="p">,</span> <span class="s1">&#39;timechd&#39;</span><span class="p">,</span> <span class="s1">&#39;typechd_1&#39;</span><span class="p">,</span> <span class="s1">&#39;typechd_2&#39;</span><span class="p">,</span> <span class="s1">&#39;typechd_3&#39;</span><span class="p">])</span>  <span class="c1"># Features</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;chd&#39;</span><span class="p">]</span>  <span class="c1"># Target variable</span>
</pre></div>
</div>
</div>
</div>
<p>Features (<code class="docutils literal notranslate"><span class="pre">X</span></code>):</p>
<ul class="simple">
<li><p>Removes <code class="docutils literal notranslate"><span class="pre">chd</span></code> (target variable) and timechd (time until CHD event, which is not used in classification).</p></li>
<li><p>Drops <code class="docutils literal notranslate"><span class="pre">typechd_1</span></code>, <code class="docutils literal notranslate"><span class="pre">typechd_2</span></code>, and <code class="docutils literal notranslate"><span class="pre">typechd_3</span></code> (highly correlated with <code class="docutils literal notranslate"><span class="pre">chd</span></code>).</p></li>
</ul>
<p>Target (<code class="docutils literal notranslate"><span class="pre">y</span></code>):
<code class="docutils literal notranslate"><span class="pre">chd</span></code> (whether the person developed CHD or not) is set as the prediction target.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split the dataset into training (80%) and testing (20%)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Splits the data into 80% training and 20% testing sets. <code class="docutils literal notranslate"><span class="pre">stratify=y</span></code> ensures class balance in both training and testing sets. <code class="docutils literal notranslate"><span class="pre">random_state=42</span></code> ensures reproducibility.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standardize numerical features</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Print dataset shapes</span>
<span class="n">X_train_scaled</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((2523, 12), (631, 12), (2523,), (631,))
</pre></div>
</div>
</div>
</div>
<p>Standardizes numerical features to have zero mean and unit variance. <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code> is applied to <code class="docutils literal notranslate"><span class="pre">X_train</span></code>, while <code class="docutils literal notranslate"><span class="pre">transform</span></code> is applied to <code class="docutils literal notranslate"><span class="pre">X_test</span></code> to prevent data leakage. Standardization improves model convergence and performance, especially for distance-based models (e.g., KNN, logistic regression).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply SMOTE to balance the dataset</span>
<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Print new class distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Class distribution after SMOTE:&quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_resampled</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Class distribution after SMOTE: Counter({0: 2317, 1: 2317})
</pre></div>
</div>
</div>
</div>
<p>Synthetic Minority Over-sampling Technique (SMOTE) generates synthetic samples for the minority class (CHD-positive cases) to balance the dataset. Prevents the model from being biased towards the majority class (<code class="docutils literal notranslate"><span class="pre">chd=0</span></code>). <code class="docutils literal notranslate"><span class="pre">random_state=42</span></code> ensures reproducibility.</p>
</section>
</section>
</section>
<section id="modeling">
<h2>Modeling<a class="headerlink" href="#modeling" title="Link to this heading">#</a></h2>
<section id="baseline-machine-learning-models">
<h3>Baseline Machine Learning Models<a class="headerlink" href="#baseline-machine-learning-models" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize models</span>
<span class="n">log_reg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">gbm</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Train models</span>
<span class="n">log_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span><span class="p">)</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span><span class="p">)</span>
<span class="n">gbm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span><span class="p">)</span>

<span class="c1"># Predictions</span>
<span class="n">log_reg_preds</span> <span class="o">=</span> <span class="n">log_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="n">knn_preds</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="n">gbm_preds</span> <span class="o">=</span> <span class="n">gbm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

<span class="c1"># Model Evaluation</span>
<span class="k">def</span> <span class="nf">evaluate_model</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔹 </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> Model Performance:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ROC-AUC Score: </span><span class="si">{</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Evaluate models</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="s2">&quot;Logistic Regression&quot;</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">log_reg_preds</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="s2">&quot;K-Nearest Neighbors&quot;</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">knn_preds</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="s2">&quot;Gradient Boosting&quot;</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">gbm_preds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>🔹 Logistic Regression Model Performance:
              precision    recall  f1-score   support

           0       0.96      0.70      0.81       580
           1       0.16      0.65      0.26        51

    accuracy                           0.70       631
   macro avg       0.56      0.67      0.53       631
weighted avg       0.89      0.70      0.77       631

ROC-AUC Score: 0.6744
--------------------------------------------------
🔹 K-Nearest Neighbors Model Performance:
              precision    recall  f1-score   support

           0       0.94      0.74      0.83       580
           1       0.12      0.41      0.19        51

    accuracy                           0.72       631
   macro avg       0.53      0.58      0.51       631
weighted avg       0.87      0.72      0.78       631

ROC-AUC Score: 0.5783
--------------------------------------------------
🔹 Gradient Boosting Model Performance:
              precision    recall  f1-score   support

           0       0.93      0.93      0.93       580
           1       0.21      0.20      0.20        51

    accuracy                           0.87       631
   macro avg       0.57      0.57      0.57       631
weighted avg       0.87      0.87      0.87       631

ROC-AUC Score: 0.5653
--------------------------------------------------
</pre></div>
</div>
</div>
</div>
<p>Limitations of the Machine Learning Models</p>
<p>The current machine learning models have several limitations, particularly in predicting CHD (<code class="docutils literal notranslate"><span class="pre">chd=1</span></code>). Below are the key issues and reasons for switching to a deep learning model:</p>
<p>1️⃣ Imbalance in CHD Predictions</p>
<p>All models struggle to predict CHD cases (chd=1) effectively. Low precision (16%-21%) and recall (20%-65%) indicate that CHD patients are either missed or wrongly classified. The majority class (chd=0) dominates predictions, leading to high overall accuracy but poor performance on the minority class.</p>
<p>2️⃣ Limited Feature Interactions in Traditional Models</p>
<p>Logistic regression assumes linear relationships, which may oversimplify complex medical interactions. KNN and GBM rely on manually engineered features but may fail to capture deep non-linear patterns in the data.</p>
<p>3️⃣ Lack of Robust Generalization</p>
<p>Gradient Boosting (GBM) has poor recall (20%), meaning it fails to identify many CHD cases. KNN’s performance is unstable in high-dimensional space, making it unsuitable for large feature sets. SMOTE-generated synthetic data may not generalize well, as traditional models rely heavily on existing training distributions.</p>
<p>4️⃣ Inefficiency in Handling High-Dimensional Data</p>
<p>With one-hot encoding, categorical variables increase feature space, making models prone to overfitting. Feature selection is required to reduce dimensionality for machine learning models. Traditional models lack representation learning, requiring careful preprocessing and feature engineering.</p>
<p>5️⃣ Inability to Capture Temporal Patterns</p>
<p>The dataset includes time-based information (timechd), which traditional models treat as a static feature. Time-based progression of CHD is ignored, limiting predictive power.</p>
</section>
<section id="deep-learning-model-mlp-multi-layer-perceptron">
<h3>Deep Learning Model (MLP - Multi-Layer Perceptron)<a class="headerlink" href="#deep-learning-model-mlp-multi-layer-perceptron" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define MLP (Multi-Layer Perceptron) Model</span>
<span class="n">mlp_model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
    <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],)),</span>  <span class="c1"># Define the input layer</span>
    <span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
    <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span>                   <span class="c1"># Regularization to prevent overfitting</span>
    <span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>   <span class="c1"># Hidden layer</span>
    <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
    <span class="n">Dense</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>   <span class="c1"># Hidden layer</span>
    <span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">)</span>  <span class="c1"># Output layer (binary classification)</span>
<span class="p">])</span>

<span class="c1"># Compile Model</span>
<span class="n">mlp_model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span> 
                  <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span> 
                  <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>

<span class="c1"># Define Early Stopping</span>
<span class="n">early_stopping</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Train Model</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">mlp_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span><span class="p">,</span> 
                         <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span> 
                         <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> 
                         <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> 
                         <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stopping</span><span class="p">],</span> 
                         <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Evaluate Model</span>
<span class="n">mlp_preds</span> <span class="o">=</span> <span class="p">(</span><span class="n">mlp_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Print Evaluation</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="s2">&quot;Deep Learning MLP&quot;</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">mlp_preds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">2s</span> 3ms/step - accuracy: 0.5710 - loss: 0.6801 - val_accuracy: 0.7100 - val_loss: 0.5442
Epoch 2/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.6999 - loss: 0.5855 - val_accuracy: 0.6894 - val_loss: 0.5455
Epoch 3/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7040 - loss: 0.5747 - val_accuracy: 0.7052 - val_loss: 0.5216
Epoch 4/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7155 - loss: 0.5594 - val_accuracy: 0.6862 - val_loss: 0.5407
Epoch 5/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7300 - loss: 0.5351 - val_accuracy: 0.6751 - val_loss: 0.5486
Epoch 6/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7232 - loss: 0.5396 - val_accuracy: 0.6973 - val_loss: 0.5278
Epoch 7/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7422 - loss: 0.5192 - val_accuracy: 0.6862 - val_loss: 0.5245
Epoch 8/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 2ms/step - accuracy: 0.7321 - loss: 0.5232 - val_accuracy: 0.6973 - val_loss: 0.5142
Epoch 9/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7377 - loss: 0.5193 - val_accuracy: 0.6751 - val_loss: 0.5480
Epoch 10/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7495 - loss: 0.5071 - val_accuracy: 0.6561 - val_loss: 0.5678
Epoch 11/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7462 - loss: 0.4992 - val_accuracy: 0.7005 - val_loss: 0.5178
Epoch 12/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7692 - loss: 0.4775 - val_accuracy: 0.7100 - val_loss: 0.5003
Epoch 13/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7743 - loss: 0.4829 - val_accuracy: 0.7147 - val_loss: 0.5022
Epoch 14/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7668 - loss: 0.4746 - val_accuracy: 0.7100 - val_loss: 0.5127
Epoch 15/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7753 - loss: 0.4601 - val_accuracy: 0.7211 - val_loss: 0.4867
Epoch 16/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7555 - loss: 0.4762 - val_accuracy: 0.6830 - val_loss: 0.5324
Epoch 17/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7720 - loss: 0.4628 - val_accuracy: 0.7084 - val_loss: 0.5046
Epoch 18/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7853 - loss: 0.4572 - val_accuracy: 0.6894 - val_loss: 0.5327
Epoch 19/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7905 - loss: 0.4449 - val_accuracy: 0.7290 - val_loss: 0.4717
Epoch 20/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7928 - loss: 0.4417 - val_accuracy: 0.7258 - val_loss: 0.4923
Epoch 21/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8001 - loss: 0.4232 - val_accuracy: 0.7211 - val_loss: 0.4784
Epoch 22/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8058 - loss: 0.4268 - val_accuracy: 0.7322 - val_loss: 0.4791
Epoch 23/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7998 - loss: 0.4302 - val_accuracy: 0.7211 - val_loss: 0.4928
Epoch 24/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.7960 - loss: 0.4185 - val_accuracy: 0.7401 - val_loss: 0.4665
Epoch 25/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8036 - loss: 0.4151 - val_accuracy: 0.7242 - val_loss: 0.4950
Epoch 26/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8009 - loss: 0.4183 - val_accuracy: 0.7242 - val_loss: 0.4974
Epoch 27/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 2ms/step - accuracy: 0.8187 - loss: 0.4060 - val_accuracy: 0.7512 - val_loss: 0.4626
Epoch 28/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 2ms/step - accuracy: 0.8126 - loss: 0.4208 - val_accuracy: 0.7353 - val_loss: 0.4835
Epoch 29/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 2ms/step - accuracy: 0.8062 - loss: 0.4182 - val_accuracy: 0.7369 - val_loss: 0.4874
Epoch 30/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8216 - loss: 0.3963 - val_accuracy: 0.7464 - val_loss: 0.4845
Epoch 31/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8286 - loss: 0.3851 - val_accuracy: 0.7559 - val_loss: 0.4634
Epoch 32/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8094 - loss: 0.4102 - val_accuracy: 0.7591 - val_loss: 0.4698
Epoch 33/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8225 - loss: 0.3850 - val_accuracy: 0.7655 - val_loss: 0.4557
Epoch 34/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8135 - loss: 0.3958 - val_accuracy: 0.7433 - val_loss: 0.4910
Epoch 35/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8308 - loss: 0.3645 - val_accuracy: 0.7385 - val_loss: 0.5019
Epoch 36/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8354 - loss: 0.3713 - val_accuracy: 0.7623 - val_loss: 0.4707
Epoch 37/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8302 - loss: 0.3704 - val_accuracy: 0.7544 - val_loss: 0.4673
Epoch 38/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8276 - loss: 0.3931 - val_accuracy: 0.7845 - val_loss: 0.4464
Epoch 39/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8313 - loss: 0.3807 - val_accuracy: 0.7686 - val_loss: 0.4661
Epoch 40/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8225 - loss: 0.3826 - val_accuracy: 0.7369 - val_loss: 0.5090
Epoch 41/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8355 - loss: 0.3796 - val_accuracy: 0.7496 - val_loss: 0.5049
Epoch 42/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8449 - loss: 0.3537 - val_accuracy: 0.7607 - val_loss: 0.4845
Epoch 43/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8412 - loss: 0.3550 - val_accuracy: 0.7750 - val_loss: 0.4722
Epoch 44/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8434 - loss: 0.3468 - val_accuracy: 0.7702 - val_loss: 0.4722
Epoch 45/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8416 - loss: 0.3475 - val_accuracy: 0.7623 - val_loss: 0.4977
Epoch 46/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8331 - loss: 0.3614 - val_accuracy: 0.7861 - val_loss: 0.4715
Epoch 47/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8387 - loss: 0.3592 - val_accuracy: 0.7750 - val_loss: 0.4819
Epoch 48/50
<span class=" -Color -Color-Bold">145/145</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 2ms/step - accuracy: 0.8422 - loss: 0.3467 - val_accuracy: 0.7750 - val_loss: 0.4714
<span class=" -Color -Color-Bold">20/20</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 3ms/step 
🔹 Deep Learning MLP Model Performance:
              precision    recall  f1-score   support

           0       0.95      0.81      0.87       580
           1       0.18      0.47      0.26        51

    accuracy                           0.78       631
   macro avg       0.56      0.64      0.57       631
weighted avg       0.88      0.78      0.82       631

ROC-AUC Score: 0.6413
--------------------------------------------------
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./archive"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="house-prices-r.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">House Prices (R)</p>
      </div>
    </a>
    <a class="right-next"
       href="blogs.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Blogs</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#objective">Objective</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-description">Dataset Description</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#key-considerations">Key Considerations:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-inspect-the-data">Load and Inspect the Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning-and-visualization">Data Cleaning and Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-data">Understanding the Data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">Data Cleaning</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#renaming-columns">Renaming Columns</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-missing-values">Handling Missing Values</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-visualization">Data Visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-numerical-variables">Distribution of Numerical Variables</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#correlation-analysis">Correlation Analysis</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#relationship-between-chd-and-other-variables">Relationship Between CHD and Other Variables</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#kaplan-meier-survival-analysis">Kaplan-Meier Survival Analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chd-categorical-variable-analysis-chi-square-tests">CHD &amp; Categorical Variable Analysis (Chi-Square Tests)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#smoking-chd-risk-analysis">Smoking &amp; CHD Risk Analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#blood-pressure-vs-chd-risk">Blood Pressure vs. CHD Risk</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cholesterol-levels-chd">Cholesterol Levels &amp; CHD</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#encoding-categorical-variables">Encoding Categorical Variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling">Modeling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#baseline-machine-learning-models">Baseline Machine Learning Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-learning-model-mlp-multi-layer-perceptron">Deep Learning Model (MLP - Multi-Layer Perceptron)</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Arno Zeng
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>