
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MongoDB &#8212; Arno&#39;s Projects Collection</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'archive/mongodb';</script>
    <link rel="canonical" href="docs.arnozeng.com/archive/mongodb.html" />
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visualization" href="visualization.html" />
    <link rel="prev" title="PostgreSQL" href="postgresql.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Arno's Projects Collection - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Arno's Projects Collection - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Arno’s Projects Collection
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="house-prices%28py%29.html">House Prices (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="house-prices%28r%29.html">House Prices (R)</a></li>
<li class="toctree-l1"><a class="reference internal" href="coronary-heart-disease-study.html">Coronary Heart Disease Study</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Deep Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="blogs.html">Blogs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NLP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cfg-parsers.html">CFG Parsers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Database</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="postgresql.html">PostgreSQL</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">MongoDB</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/arnozeng98/data-science-archive" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/arnozeng98/data-science-archive/issues/new?title=Issue%20on%20page%20%2Farchive/mongodb.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/archive/mongodb.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MongoDB</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#instructions">Instructions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-set-up">Getting set up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-getting-to-know-your-mongodb-databases">Exercise 1: Getting to know your MongoDB databases</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">1.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">1.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">1.4</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-basic-mongodb-queries">Exercise 2: Basic MongoDB queries</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">2.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">2.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">2.4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">2.5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">2.6</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-conditionals-embedded-documents-arrays">Exercise 3: Conditionals, embedded documents &amp; arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">3.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">3.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">3.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">3.4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">3.5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-end">The end</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="mongodb">
<h1>MongoDB<a class="headerlink" href="#mongodb" title="Link to this heading">#</a></h1>
<section id="instructions">
<h2>Instructions<a class="headerlink" href="#instructions" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>rubric={mechanics:2}</p>
<ul class="simple">
<li><p>Follow the <a class="reference external" href="https://ubc-mds.github.io/resources_pages/general_lab_instructions/">general lab instructions</a></p></li>
<li><p>You submit 3 files to Gradescope (<em><strong>upload it separately, not as a zip file, or folder</strong></em>)</p>
<ul>
<li><p>Fully rendered ipynb notebook,</p></li>
<li><p>HTML of the fully rendered ipynb notebook</p></li>
<li><p>PDF of the fully rendered ipynb notebook</p></li>
</ul>
</li>
<li><p>Add a link to your GitHub repository here: <a class="reference external" href="https://github.ubc.ca/mds-2024-25/DSCI_513_lab4_lingsong">https://github.ubc.ca/mds-2024-25/DSCI_513_lab4_lingsong</a></p></li>
</ul>
<blockquote>
<div><p>NOTE: There is no autograding for any of our labs. So, the idea of Gradescope is just to upload the 3 files listed above. You just need to make sure that it is uploaded. You must upload 3 files individually to Gradescope (not in a folder or a zipped folder).</p>
</div></blockquote>
</section>
<section id="getting-set-up">
<h2>Getting set up<a class="headerlink" href="#getting-set-up" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Before running the following cell, make sure that you have the correct login information in the <code class="docutils literal notranslate"><span class="pre">credentials_mongodb.json</span></code> file:</p>
<blockquote>
<div><p>You should be careful where your credentials file is <code class="docutils literal notranslate"><span class="pre">credentials_mongodb.json</span></code>. Revise concepts on absolute path and relative path.</p>
</div></blockquote>
<blockquote>
<div><p>Please refer to the lecture notes for information on setting up your MongoDB and uploading dumps. <a class="reference external" href="https://pages.github.ubc.ca/MDS-2024-25/DSCI_513_database-data-retr_instructors/theme/Mongodb_installation.html">Here is the link.</a></p>
</div></blockquote>
<blockquote>
<div><p>In this week’s lab, a .gitignore file has been added. If you don’t see a credentials_mongodb.json file in the student/data directory, please create one with the following content:
{
“host”: “&lt;cluster0.<clustername>.mongodb.net&gt;”,
“port”: <MongodbPort>,
“username”: “<MongodbUsername>”,
“password”: “<MongodbPassword>”
}</p>
</div></blockquote>
<blockquote>
<div><p>Make sure to replace <clustername>, <MongodbPort>, <MongodbUsername>, and <MongodbPassword> with the appropriate values for your MongoDB setup.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pymongo</span> <span class="kn">import</span> <span class="n">MongoClient</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">urllib.parse</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/credentials_mongodb.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">login</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">username</span> <span class="o">=</span> <span class="n">login</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">login</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">])</span>
<span class="n">host</span> <span class="o">=</span> <span class="n">login</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;mongodb+srv://</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">@</span><span class="si">{}</span><span class="s2">/?retryWrites=true&amp;w=majority&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">host</span><span class="p">)</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">MongoClient</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-1-getting-to-know-your-mongodb-databases">
<h2>Exercise 1: Getting to know your MongoDB databases<a class="headerlink" href="#exercise-1-getting-to-know-your-mongodb-databases" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<section id="id1">
<h3>1.1<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:1}</p>
<p>List the databases that exist on your MongoDB Atlas cluster after loading sample databases. You can do this either by checking out the databases using Compass or by using <code class="docutils literal notranslate"><span class="pre">pymongo</span></code>’s <code class="docutils literal notranslate"><span class="pre">.list_database_names()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">list_database_names</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;sample_airbnb&#39;,
 &#39;sample_analytics&#39;,
 &#39;sample_geospatial&#39;,
 &#39;sample_guides&#39;,
 &#39;sample_mflix&#39;,
 &#39;sample_restaurants&#39;,
 &#39;sample_supplies&#39;,
 &#39;sample_training&#39;,
 &#39;sample_weatherdata&#39;,
 &#39;admin&#39;,
 &#39;local&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>1.2<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:1}</p>
<p>List the collections stored in the <code class="docutils literal notranslate"><span class="pre">sample_mflix</span></code> and <code class="docutils literal notranslate"><span class="pre">sample_airbnb</span></code> databases. You can do this either by checking out the databases using Compass or by using <code class="docutils literal notranslate"><span class="pre">pymongo</span></code>’s <code class="docutils literal notranslate"><span class="pre">.list_collection_names()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">sample_mflix</span><span class="o">.</span><span class="n">list_collection_names</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;movies&#39;, &#39;embedded_movies&#39;, &#39;comments&#39;, &#39;sessions&#39;, &#39;theaters&#39;, &#39;users&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">sample_airbnb</span><span class="o">.</span><span class="n">list_collection_names</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;listingsAndReviews&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3>1.3<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:2}</p>
<p>We would like to create a summary report to get the number of documents in each collection of each database on our cluster. Write a python loop that produces an output similar to the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Database</span><span class="p">:</span> <span class="n">sample_airbnb</span>
<span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">n_docs</span><span class="p">)</span> <span class="o">=</span>  <span class="p">(</span><span class="s1">&#39;listingsAndReviews&#39;</span><span class="p">,</span> <span class="mi">5555</span><span class="p">)</span>

<span class="n">Database</span><span class="p">:</span> <span class="n">sample_analytics</span>
<span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">n_docs</span><span class="p">)</span> <span class="o">=</span>  <span class="p">(</span><span class="s1">&#39;transactions&#39;</span><span class="p">,</span> <span class="mi">1746</span><span class="p">)</span>
<span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">n_docs</span><span class="p">)</span> <span class="o">=</span>  <span class="p">(</span><span class="s1">&#39;accounts&#39;</span><span class="p">,</span> <span class="mi">1746</span><span class="p">)</span>
<span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">n_docs</span><span class="p">)</span> <span class="o">=</span>  <span class="p">(</span><span class="s1">&#39;customers&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="o">.</span>
</pre></div>
</div>
<p>In previous questions, you’ve been introduced to the two methods of <code class="docutils literal notranslate"><span class="pre">pymongo</span></code> which are used to return database and collection names. Moreover, you can use the <code class="docutils literal notranslate"><span class="pre">.count_documents(filter={}))</span></code> method to count all documents in each collection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List all databases</span>
<span class="n">databases</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_database_names</span><span class="p">()</span>

<span class="c1"># Iterate over each database</span>
<span class="k">for</span> <span class="n">db_name</span> <span class="ow">in</span> <span class="n">databases</span><span class="p">:</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">client</span><span class="p">[</span><span class="n">db_name</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Database: </span><span class="si">{</span><span class="n">db_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># List all collections in the current database</span>
    <span class="n">collections</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">list_collection_names</span><span class="p">()</span>
    
    <span class="c1"># Iterate over each collection and count documents</span>
    <span class="k">for</span> <span class="n">collection_name</span> <span class="ow">in</span> <span class="n">collections</span><span class="p">:</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]</span>
        <span class="n">n_docs</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">count_documents</span><span class="p">({})</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(collection, n_docs) = (&#39;</span><span class="si">{</span><span class="n">collection_name</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">n_docs</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># Line break between db</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Database: sample_airbnb
(collection, n_docs) = (&#39;listingsAndReviews&#39;, 5555)


Database: sample_analytics
(collection, n_docs) = (&#39;customers&#39;, 500)
(collection, n_docs) = (&#39;accounts&#39;, 1746)
(collection, n_docs) = (&#39;transactions&#39;, 1746)


Database: sample_geospatial
(collection, n_docs) = (&#39;shipwrecks&#39;, 11095)


Database: sample_guides
(collection, n_docs) = (&#39;planets&#39;, 8)


Database: sample_mflix
(collection, n_docs) = (&#39;movies&#39;, 21349)
(collection, n_docs) = (&#39;embedded_movies&#39;, 3483)
(collection, n_docs) = (&#39;comments&#39;, 41079)
(collection, n_docs) = (&#39;sessions&#39;, 1)
(collection, n_docs) = (&#39;theaters&#39;, 1564)
(collection, n_docs) = (&#39;users&#39;, 185)


Database: sample_restaurants
(collection, n_docs) = (&#39;restaurants&#39;, 25359)
(collection, n_docs) = (&#39;neighborhoods&#39;, 195)


Database: sample_supplies
(collection, n_docs) = (&#39;sales&#39;, 5000)


Database: sample_training
(collection, n_docs) = (&#39;posts&#39;, 500)
(collection, n_docs) = (&#39;trips&#39;, 10000)
(collection, n_docs) = (&#39;companies&#39;, 9500)
(collection, n_docs) = (&#39;routes&#39;, 66985)
(collection, n_docs) = (&#39;zips&#39;, 29470)
(collection, n_docs) = (&#39;inspections&#39;, 80047)
(collection, n_docs) = (&#39;grades&#39;, 100000)


Database: sample_weatherdata
(collection, n_docs) = (&#39;data&#39;, 10000)


Database: admin


Database: local
(collection, n_docs) = (&#39;oplog.rs&#39;, 139)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>1.4<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:1}</p>
<p>The <em>Schema</em> tab of the Compass application provides a nice schema analyzer tool that helps to quickly obtain summary information about collections in a database both visually and in text format.</p>
<p>Suppose that we would like to find out how high-rated movies on <em>metacritic</em> are rated on IMDB. Use the schema analyzer tool to find the distribution of the <code class="docutils literal notranslate"><span class="pre">imdb.rating</span></code> field for movies in the <code class="docutils literal notranslate"><span class="pre">sample_mflix</span></code> database that have a metacritic rating of greater than 90. Paste a screenshot of the distribution that you find here.</p>
<p><strong>Hint:</strong> There are 111 documents with a metacritic rating of greater than 90.</p>
<p><img alt="image.png" src="archive/attachment:429bfa37-71ee-4620-a840-5c36a3ef4622.png" /></p>
</section>
</section>
<section id="exercise-2-basic-mongodb-queries">
<h2>Exercise 2: Basic MongoDB queries<a class="headerlink" href="#exercise-2-basic-mongodb-queries" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<section id="id5">
<h3>2.1<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:1}</p>
<p>Retrieve one (random) document associated with a movie produced in 2015.</p>
<p>You can use <code class="docutils literal notranslate"><span class="pre">.find_one()</span></code> method to do this, or use <code class="docutils literal notranslate"><span class="pre">.find()</span></code> but limit your results to 1 document.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">sample_mflix</span>

<span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2015</span><span class="p">}</span>
<span class="n">movie</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">movies</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="n">movie</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;_id&#39;: ObjectId(&#39;573a13adf29313caabd2b765&#39;),
 &#39;plot&#39;: &quot;A new theme park is built on the original site of Jurassic Park. Everything is going well until the park&#39;s newest attraction--a genetically modified giant stealth killing machine--escapes containment and goes on a killing spree.&quot;,
 &#39;genres&#39;: [&#39;Action&#39;, &#39;Adventure&#39;, &#39;Sci-Fi&#39;],
 &#39;runtime&#39;: 124,
 &#39;metacritic&#39;: 59,
 &#39;rated&#39;: &#39;PG-13&#39;,
 &#39;cast&#39;: [&#39;Chris Pratt&#39;,
  &#39;Bryce Dallas Howard&#39;,
  &#39;Irrfan Khan&#39;,
  &quot;Vincent D&#39;Onofrio&quot;],
 &#39;num_mflix_comments&#39;: 0,
 &#39;poster&#39;: &#39;https://m.media-amazon.com/images/M/MV5BNzQ3OTY4NjAtNzM5OS00N2ZhLWJlOWUtYzYwZjNmOWRiMzcyXkEyXkFqcGdeQXVyMTMxODk2OTU@._V1_SY1000_SX677_AL_.jpg&#39;,
 &#39;title&#39;: &#39;Jurassic World&#39;,
 &#39;fullplot&#39;: &#39;22 years after the original Jurassic Park failed, the new park (also known as Jurassic World) is open for business. After years of studying genetics the scientists on the park genetically engineer a new breed of dinosaur. When everything goes horribly wrong, will our heroes make it off the island?&#39;,
 &#39;languages&#39;: [&#39;English&#39;],
 &#39;released&#39;: datetime.datetime(2015, 6, 12, 0, 0),
 &#39;directors&#39;: [&#39;Colin Trevorrow&#39;],
 &#39;writers&#39;: [&#39;Rick Jaffa (screenplay)&#39;,
  &#39;Amanda Silver (screenplay)&#39;,
  &#39;Colin Trevorrow (screenplay)&#39;,
  &#39;Derek Connolly (screenplay)&#39;,
  &#39;Rick Jaffa (story)&#39;,
  &#39;Amanda Silver (story)&#39;,
  &#39;Michael Crichton (characters)&#39;],
 &#39;awards&#39;: {&#39;wins&#39;: 0, &#39;nominations&#39;: 5, &#39;text&#39;: &#39;5 nominations.&#39;},
 &#39;lastupdated&#39;: &#39;2015-09-11 00:21:41.630000000&#39;,
 &#39;year&#39;: 2015,
 &#39;imdb&#39;: {&#39;rating&#39;: 7.3, &#39;votes&#39;: 252556, &#39;id&#39;: 369610},
 &#39;countries&#39;: [&#39;USA&#39;, &#39;China&#39;],
 &#39;type&#39;: &#39;movie&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h3>2.2<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:1}</p>
<p>Retrieve all TV series produced in 1995.</p>
<blockquote>
<div><p><strong>Hint:</strong> Inspect possible values for the <code class="docutils literal notranslate"><span class="pre">type</span></code> field.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">1995</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;series&#39;</span><span class="p">}</span>
<span class="n">tv_series_1995</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">movies</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="k">for</span> <span class="n">series</span> <span class="ow">in</span> <span class="n">tv_series_1995</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Title:&#39;</span><span class="p">,</span> <span class="n">series</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Title: Streets of Laredo
Title: The Langoliers
Title: Pride and Prejudice
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h3>2.3<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:2}</p>
<p>Retrieve the title and cast of movies produced in 2010, but limit your results to 5 documents.</p>
<blockquote>
<div><p><strong>Note:</strong> Don’t forget to exclude the <code class="docutils literal notranslate"><span class="pre">_id</span></code> field from your returned documents.</p>
</div></blockquote>
<blockquote>
<div><p><strong>Note:</strong> The exact returned documents returned by <code class="docutils literal notranslate"><span class="pre">pymongo</span></code> might be different in different sessions and on different computers. This is perfectly fine.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2010</span><span class="p">}</span>
<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;cast&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">movies_2010</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">movies</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">movies_2010</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Title:&#39;</span><span class="p">,</span> <span class="n">movie</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cast:&#39;</span><span class="p">,</span> <span class="n">movie</span><span class="p">[</span><span class="s1">&#39;cast&#39;</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Title: Pèl Adrienn
Cast: [&#39;èva Gèbor&#39;, &#39;Istvèn Znamenèk&#39;, &#39;èkos Horvèth&#39;, &#39;Lia Pokorny&#39;] 

Title: In My Sleep
Cast: [&#39;Philip Winchester&#39;, &#39;Tim Draxl&#39;, &#39;Lacey Chabert&#39;, &#39;Abigail Spencer&#39;] 

Title: The Pacific
Cast: [&#39;James Badge Dale&#39;, &#39;Joseph Mazzello&#39;, &#39;Jon Seda&#39;, &#39;Sebastian Bertoli&#39;] 

Title: Tangled
Cast: [&#39;Mandy Moore&#39;, &#39;Zachary Levi&#39;, &#39;Donna Murphy&#39;, &#39;Ron Perlman&#39;] 

Title: Utomlyonnye solntsem 2: Predstoyanie
Cast: [&#39;Nikita Mikhalkov&#39;, &#39;Oleg Menshikov&#39;, &#39;Nadezhda Mikhalkova&#39;, &#39;Sergey Makovetskiy&#39;] 
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h3>2.4<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:2}</p>
<p>Retrieve the top 15 movies produced in 2010 that have the longest duration. Exclude TV series from your results. The returned documents should only contain the <code class="docutils literal notranslate"><span class="pre">title</span></code> and <code class="docutils literal notranslate"><span class="pre">runtime</span></code> fields (exclude the <code class="docutils literal notranslate"><span class="pre">_id</span></code> field).</p>
<blockquote>
<div><p><strong>Note:</strong> It’s ok if your results contain duplicate movies.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2010</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$ne&#39;</span><span class="p">:</span> <span class="s1">&#39;series&#39;</span><span class="p">}}</span>
<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;runtime&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">movies_2010</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">movies</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;runtime&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">movies_2010</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Title:&#39;</span><span class="p">,</span> <span class="n">movie</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Runtime:&#39;</span><span class="p">,</span> <span class="n">movie</span><span class="p">[</span><span class="s1">&#39;runtime&#39;</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Title: Mysteries of Lisbon
Runtime: 272 

Title: Utomlyonnye solntsem 2: Predstoyanie
Runtime: 181 

Title: Aurora
Runtime: 181 

Title: Thorne: Sleepyhead
Runtime: 180 

Title: The Autobiography of Nicolae Ceausescu
Runtime: 180 

Title: Riverworld
Runtime: 178 

Title: Enthiran
Runtime: 174 

Title: Khaleja
Runtime: 170 

Title: We Believed
Runtime: 170 

Title: My Name Is Khan
Runtime: 165 

Title: Moss
Runtime: 163 

Title: Raajneeti
Runtime: 163 

Title: Singam
Runtime: 160 

Title: Black Venus
Runtime: 159 

Title: Will You Cross the Skies for Me?
Runtime: 157 
</pre></div>
</div>
</div>
</div>
</section>
<section id="id9">
<h3>2.5<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:2}</p>
<p>For year 2015, return the number of movies with a metacritic rating of exactly 90.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2015</span><span class="p">,</span> <span class="s1">&#39;metacritic&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">}</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">movies</span><span class="o">.</span><span class="n">count_documents</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="n">count</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
</section>
<section id="id10">
<h3>2.6<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:2}</p>
<p>Retrieve the title and runtime of the 10 shortest movies in the <code class="docutils literal notranslate"><span class="pre">movies</span></code> collection.</p>
<p>For this exercise, you need to make sure that the field <code class="docutils literal notranslate"><span class="pre">runtime</span></code> exists in the returned documents, otherwise by default those documents would appear first which don’t have a <code class="docutils literal notranslate"><span class="pre">runtime</span></code> field at all!</p>
<blockquote>
<div><p><strong>Hint:</strong> You need the <code class="docutils literal notranslate"><span class="pre">$exists</span></code> operator (see <a class="reference external" href="https://docs.mongodb.com/manual/reference/operator/query/exists/">here</a> for help).</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;runtime&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$exists&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}</span>
<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;runtime&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">shortest_movies</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">movies</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;runtime&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">shortest_movies</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">movie</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;runtime&#39;: 1, &#39;title&#39;: &#39;Neko no shukai&#39;}
{&#39;runtime&#39;: 1, &#39;title&#39;: &#39;The Kiss&#39;}
{&#39;runtime&#39;: 1, &#39;title&#39;: &#39;The Kiss&#39;}
{&#39;runtime&#39;: 2, &#39;title&#39;: &#39;Fresh Guacamole&#39;}
{&#39;runtime&#39;: 2, &#39;title&#39;: &#39;Pixels&#39;}
{&#39;runtime&#39;: 2, &#39;title&#39;: &#39;Game Over&#39;}
{&#39;runtime&#39;: 2, &#39;title&#39;: &#39;Andrè and Wally B.&#39;}
{&#39;runtime&#39;: 2, &#39;title&#39;: &#39;Luxo Jr.&#39;}
{&#39;runtime&#39;: 3, &#39;title&#39;: &#39;Sisyphus&#39;}
{&#39;runtime&#39;: 3, &#39;title&#39;: &#39;Gagarin&#39;}
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="exercise-3-conditionals-embedded-documents-arrays">
<h2>Exercise 3: Conditionals, embedded documents &amp; arrays<a class="headerlink" href="#exercise-3-conditionals-embedded-documents-arrays" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<section id="id11">
<h3>3.1<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:2}</p>
<p>Retrieve the title, production year, and number of awards of all movies that</p>
<ul class="simple">
<li><p>have been produced between 1950 and 2000 (inclusive)</p></li>
<li><p>have an IMDB rating of 8.5 or better</p></li>
<li><p>won at least 30 awards.</p></li>
</ul>
<p>Sort the results by production year in descending order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gte&#39;</span><span class="p">:</span> <span class="mi">1950</span><span class="p">,</span> <span class="s1">&#39;$lte&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">},</span>
    <span class="s1">&#39;imdb.rating&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gte&#39;</span><span class="p">:</span> <span class="mf">8.5</span><span class="p">},</span>
    <span class="s1">&#39;awards.wins&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gte&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}</span>
<span class="p">}</span>
<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;awards.wins&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">movies</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">movies</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">movie</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;year&#39;: 2000, &#39;title&#39;: &#39;Memento&#39;, &#39;awards&#39;: {&#39;wins&#39;: 54}}
{&#39;year&#39;: 2000, &#39;title&#39;: &#39;Gladiator&#39;, &#39;awards&#39;: {&#39;wins&#39;: 63}}
{&#39;year&#39;: 1999, &#39;title&#39;: &#39;The Matrix&#39;, &#39;awards&#39;: {&#39;wins&#39;: 37}}
{&#39;year&#39;: 1998, &#39;title&#39;: &#39;Saving Private Ryan&#39;, &#39;awards&#39;: {&#39;wins&#39;: 83}}
{&#39;title&#39;: &#39;Life Is Beautiful&#39;, &#39;awards&#39;: {&#39;wins&#39;: 66}, &#39;year&#39;: 1997}
{&#39;year&#39;: 1997, &#39;title&#39;: &#39;Life Is Beautiful&#39;, &#39;awards&#39;: {&#39;wins&#39;: 66}}
{&#39;year&#39;: 1995, &#39;title&#39;: &#39;The Usual Suspects&#39;, &#39;awards&#39;: {&#39;wins&#39;: 36}}
{&#39;year&#39;: 1995, &#39;title&#39;: &#39;Se7en&#39;, &#39;awards&#39;: {&#39;wins&#39;: 32}}
{&#39;year&#39;: 1994, &#39;title&#39;: &#39;Pulp Fiction&#39;, &#39;awards&#39;: {&#39;wins&#39;: 64}}
{&#39;year&#39;: 1994, &#39;title&#39;: &#39;Forrest Gump&#39;, &#39;awards&#39;: {&#39;wins&#39;: 46}}
{&#39;title&#39;: &quot;Schindler&#39;s List&quot;, &#39;awards&#39;: {&#39;wins&#39;: 81}, &#39;year&#39;: 1993}
{&#39;year&#39;: 1991, &#39;title&#39;: &#39;The Silence of the Lambs&#39;, &#39;awards&#39;: {&#39;wins&#39;: 56}}
{&#39;year&#39;: 1990, &#39;title&#39;: &#39;Goodfellas&#39;, &#39;awards&#39;: {&#39;wins&#39;: 43}}
{&#39;year&#39;: 1981, &#39;title&#39;: &#39;Raiders of the Lost Ark&#39;, &#39;awards&#39;: {&#39;wins&#39;: 32}}
{&#39;year&#39;: 1977, &#39;title&#39;: &#39;Star Wars: Episode IV - A New Hope&#39;, &#39;awards&#39;: {&#39;wins&#39;: 44}}
{&#39;year&#39;: 1975, &#39;title&#39;: &quot;One Flew Over the Cuckoo&#39;s Nest&quot;, &#39;awards&#39;: {&#39;wins&#39;: 36}}
{&#39;year&#39;: 1972, &#39;title&#39;: &#39;The Godfather&#39;, &#39;awards&#39;: {&#39;wins&#39;: 33}}
</pre></div>
</div>
</div>
</div>
</section>
<section id="id12">
<h3>3.2<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:2}</p>
<p>Find the top 15 highest-rated movies according to IMDB for movies that have at least 100,000 votes. Your returned documents should only contain the <code class="docutils literal notranslate"><span class="pre">title</span></code>, <code class="docutils literal notranslate"><span class="pre">year</span></code>, and <code class="docutils literal notranslate"><span class="pre">imdb.rating</span></code> fields.</p>
<blockquote>
<div><p><strong>Hint:</strong> Be careful about documents which have a blank space in their <code class="docutils literal notranslate"><span class="pre">imdb.rating</span></code> field!</p>
</div></blockquote>
<blockquote>
<div><p><strong>Note:</strong> It’s ok if your results contain duplicates. Return 15 documents in any case.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;imdb.votes&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gte&#39;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">},</span> 
    <span class="s1">&#39;imdb.rating&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$exists&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;$ne&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
<span class="p">}</span>
<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;imdb.rating&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">top_movies</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">movies</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;imdb.rating&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">top_movies</span><span class="p">:</span> 
    <span class="nb">print</span><span class="p">(</span><span class="n">movie</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;title&#39;: &#39;Band of Brothers&#39;, &#39;year&#39;: 2001, &#39;imdb&#39;: {&#39;rating&#39;: 9.6}}
{&#39;imdb&#39;: {&#39;rating&#39;: 9.3}, &#39;year&#39;: 1994, &#39;title&#39;: &#39;The Shawshank Redemption&#39;}
{&#39;imdb&#39;: {&#39;rating&#39;: 9.3}, &#39;year&#39;: 1994, &#39;title&#39;: &#39;The Shawshank Redemption&#39;}
{&#39;imdb&#39;: {&#39;rating&#39;: 9.2}, &#39;year&#39;: 1972, &#39;title&#39;: &#39;The Godfather&#39;}
{&#39;imdb&#39;: {&#39;rating&#39;: 9.1}, &#39;year&#39;: 1974, &#39;title&#39;: &#39;The Godfather: Part II&#39;}
{&#39;imdb&#39;: {&#39;rating&#39;: 9.0}, &#39;year&#39;: 2008, &#39;title&#39;: &#39;The Dark Knight&#39;}
{&#39;imdb&#39;: {&#39;rating&#39;: 8.9}, &#39;year&#39;: 1999, &#39;title&#39;: &#39;Fight Club&#39;}
{&#39;imdb&#39;: {&#39;rating&#39;: 8.9}, &#39;year&#39;: 1994, &#39;title&#39;: &#39;Pulp Fiction&#39;}
{&#39;imdb&#39;: {&#39;rating&#39;: 8.9}, &#39;year&#39;: 2003, &#39;title&#39;: &#39;The Lord of the Rings: The Return of the King&#39;}
{&#39;title&#39;: &quot;Schindler&#39;s List&quot;, &#39;year&#39;: 1993, &#39;imdb&#39;: {&#39;rating&#39;: 8.9}}
{&#39;imdb&#39;: {&#39;rating&#39;: 8.8}, &#39;year&#39;: 1980, &#39;title&#39;: &#39;Star Wars: Episode V - The Empire Strikes Back&#39;}
{&#39;imdb&#39;: {&#39;rating&#39;: 8.8}, &#39;year&#39;: 2001, &#39;title&#39;: &#39;The Lord of the Rings: The Fellowship of the Ring&#39;}
{&#39;imdb&#39;: {&#39;rating&#39;: 8.8}, &#39;year&#39;: 2010, &#39;title&#39;: &#39;Inception&#39;}
{&#39;imdb&#39;: {&#39;rating&#39;: 8.8}, &#39;year&#39;: 1994, &#39;title&#39;: &#39;Forrest Gump&#39;}
{&#39;imdb&#39;: {&#39;rating&#39;: 8.7}, &#39;year&#39;: 1990, &#39;title&#39;: &#39;Goodfellas&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h3>3.3<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:1}</p>
<p>Retrieve the title, production year, and IMDB rating of movies in which both <strong>Morgan Freeman</strong> and <strong>Clint Eastwood</strong> played a role (among other actors in those movies). Sort the returned documents by year in descending order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cast&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$all&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Morgan Freeman&#39;</span><span class="p">,</span> <span class="s1">&#39;Clint Eastwood&#39;</span><span class="p">]}}</span>
<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;imdb.rating&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">movies</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">movies</span><span class="p">:</span> 
    <span class="nb">print</span><span class="p">(</span><span class="n">movie</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;imdb&#39;: {&#39;rating&#39;: 8.1}, &#39;year&#39;: 2004, &#39;title&#39;: &#39;Million Dollar Baby&#39;}
{&#39;imdb&#39;: {&#39;rating&#39;: 8.3}, &#39;year&#39;: 1992, &#39;title&#39;: &#39;Unforgiven&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h3>3.4<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:3}</p>
<p>Retrieve documents associated with movies which:</p>
<ul class="simple">
<li><p>are available in both German and French (among other languages), but not in English,</p></li>
<li><p>are either rated above 8 according to IMDB, or above 7.5 according to the critic ratings of <a class="reference external" href="https://www.rottentomatoes.com/">Rotten Tomatoes</a> (inspect the <code class="docutils literal notranslate"><span class="pre">tomatoes</span></code> field),</p></li>
<li><p>have at least 50 Rotten Tomatoes critic reviews.</p></li>
</ul>
<p>The returned documents should include the title, year, IMDB rating, Rotten Tomatoes critic rating and country of production fields. Sort the results by IMDB rating in descending order.</p>
<p><strong>Note:</strong> Duplicates in the results are ok.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;languages&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$all&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;German&#39;</span><span class="p">,</span> <span class="s1">&#39;French&#39;</span><span class="p">],</span> <span class="s1">&#39;$nin&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;English&#39;</span><span class="p">]},</span>
    <span class="s1">&#39;$or&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;imdb.rating&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gt&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}},</span> 
        <span class="p">{</span><span class="s1">&#39;tomatoes.critic.rating&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gt&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">}}</span>
    <span class="p">],</span> 
    <span class="s1">&#39;tomatoes.critic.numReviews&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$gte&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}</span>
<span class="p">}</span>
<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> 
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="s1">&#39;imdb.rating&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="s1">&#39;tomatoes.critic.rating&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="s1">&#39;countries&#39;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">movies</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;imdb.rating&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">movies</span><span class="p">:</span> 
    <span class="nb">print</span><span class="p">(</span><span class="n">movie</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;imdb&#39;: {&#39;rating&#39;: 7.8}, &#39;year&#39;: 2013, &#39;title&#39;: &#39;The Wind Rises&#39;, &#39;tomatoes&#39;: {&#39;critic&#39;: {&#39;rating&#39;: 7.9}}, &#39;countries&#39;: [&#39;Japan&#39;]}
{&#39;title&#39;: &#39;The Wind Rises&#39;, &#39;year&#39;: 2013, &#39;imdb&#39;: {&#39;rating&#39;: 7.8}, &#39;countries&#39;: [&#39;Japan&#39;], &#39;tomatoes&#39;: {&#39;critic&#39;: {&#39;rating&#39;: 7.9}}}
</pre></div>
</div>
</div>
</div>
</section>
<section id="id15">
<h3>3.5<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<p>rubric={accuracy:2}</p>
<p>Find the title and production year of the top 20 award-winning movies which have <strong>not</strong> been produced in USA, Canada, UK, or Australia.</p>
<p><strong>Note:</strong> Duplicates are ok. Return 20 documents in any case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;countries&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$nin&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="s1">&#39;Canada&#39;</span><span class="p">,</span> <span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="s1">&#39;Australia&#39;</span><span class="p">]},</span> 
    <span class="s1">&#39;awards.wins&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;$exists&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;$ne&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
<span class="p">}</span>
<span class="n">projection</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">movies</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">projection</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;awards.wins&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">movies</span><span class="p">:</span> 
    <span class="nb">print</span><span class="p">(</span><span class="n">movie</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;title&#39;: &#39;The Artist&#39;, &#39;year&#39;: 2011}
{&#39;title&#39;: &#39;Amour&#39;, &#39;year&#39;: 2012}
{&#39;title&#39;: &#39;Amour&#39;, &#39;year&#39;: 2012}
{&#39;title&#39;: &#39;A Separation&#39;, &#39;year&#39;: 2011}
{&#39;year&#39;: 2006, &#39;title&#39;: &#39;The Lives of Others&#39;}
{&#39;title&#39;: &#39;Let the Right One In&#39;, &#39;year&#39;: 2008}
{&#39;year&#39;: 2002, &#39;title&#39;: &#39;City of God&#39;}
{&#39;year&#39;: 2006, &#39;title&#39;: &#39;Volver&#39;}
{&#39;title&#39;: &#39;Life Is Beautiful&#39;, &#39;year&#39;: 1997}
{&#39;title&#39;: &#39;The Sea Inside&#39;, &#39;year&#39;: 2004}
{&#39;year&#39;: 1997, &#39;title&#39;: &#39;Life Is Beautiful&#39;}
{&#39;year&#39;: 2009, &#39;title&#39;: &#39;The White Ribbon&#39;}
{&#39;year&#39;: 2001, &#39;title&#39;: &#39;Amèlie&#39;}
{&#39;year&#39;: 2000, &#39;title&#39;: &#39;Amores Perros&#39;}
{&#39;title&#39;: &#39;Shall We Dance?&#39;, &#39;year&#39;: 1996}
{&#39;title&#39;: &#39;Shall We Dance?&#39;, &#39;year&#39;: 1996}
{&#39;year&#39;: 2013, &#39;title&#39;: &#39;The Grandmaster&#39;}
{&#39;year&#39;: 1999, &#39;title&#39;: &#39;All About My Mother&#39;}
{&#39;year&#39;: 2001, &#39;title&#39;: &#39;Spirited Away&#39;}
{&#39;year&#39;: 2009, &#39;title&#39;: &#39;The Secret in Their Eyes&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-end">
<h3>The end<a class="headerlink" href="#the-end" title="Link to this heading">#</a></h3>
<img src="img/nosql_cartoon.jpeg" width="500">
<p>(<a class="reference external" href="https://www.deviantart.com/harshadpd/art/Relational-Issues-719533744">image source</a>)</p>
<img src="img/thanks.png" width="500">
<img src="img/andy.JPG" width="300"></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./archive"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="postgresql.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">PostgreSQL</p>
      </div>
    </a>
    <a class="right-next"
       href="visualization.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Visualization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#instructions">Instructions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-set-up">Getting set up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-getting-to-know-your-mongodb-databases">Exercise 1: Getting to know your MongoDB databases</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">1.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">1.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">1.4</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-basic-mongodb-queries">Exercise 2: Basic MongoDB queries</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">2.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">2.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">2.4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">2.5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">2.6</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-conditionals-embedded-documents-arrays">Exercise 3: Conditionals, embedded documents &amp; arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">3.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">3.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">3.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">3.4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">3.5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-end">The end</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Arno Zeng
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>