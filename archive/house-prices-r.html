
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>House Prices - Advanced Regression Techniques (R) &#8212; Arno&#39;s Projects Collection</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'archive/house-prices-r';</script>
    <link rel="canonical" href="docs.arnozeng.com/archive/house-prices-r.html" />
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tweet Sentiment Extraction" href="twitter-sentiment-extactio.html" />
    <link rel="prev" title="House Prices - Advanced Regression Techniques (Python)" href="house-prices-py.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Arno's Projects Collection - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Arno's Projects Collection - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Arnoâ€™s Projects Collection
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="icd-prediction.html">CCL2025 Chinese Electronic Medical Record ICD Diagnosis Coding Evaluation Competition</a></li>
<li class="toctree-l1"><a class="reference internal" href="house-prices-py.html">House Prices - Advanced Regression Techniques (Python)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">House Prices - Advanced Regression Techniques (R)</a></li>
<li class="toctree-l1"><a class="reference internal" href="twitter-sentiment-extactio.html">Tweet Sentiment Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="coronary-heart-disease-study.html">Coronary Heart Disease Prediction with Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="authorship-attribution.html">Authorship Attribution</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/arnozeng98/data-science-archive" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/arnozeng98/data-science-archive/issues/new?title=Issue%20on%20page%20%2Farchive/house-prices-r.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/archive/house-prices-r.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>House Prices - Advanced Regression Techniques (R)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practice-skills">Practice Skills</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgments">Acknowledgments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation">Evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#goal">Goal</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metric">Metric</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#file-descriptions">File descriptions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-engineering">Feature Engineering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-missing-values">Handling Missing Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encoding">Encoding</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#label-encoding">Label Encoding</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#one-hot-encoding">One-Hot Encoding</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize-data-standard-scaling">Normalize Data (Standard Scaling)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling">Modeling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#knn">kNN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#svm">SVM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression">Linear Regression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso">Lasso</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge">Ridge</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#elasticnet">ElasticNet</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-tree">Decision Tree</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bagging">Bagging</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest">Random Forest</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost">XGBoost</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking">Stacking</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="house-prices-advanced-regression-techniques-r">
<h1>House Prices - Advanced Regression Techniques (R)<a class="headerlink" href="#house-prices-advanced-regression-techniques-r" title="Link to this heading">#</a></h1>
<p>Predict sales prices and practice feature engineering, RFs, and gradient boosting</p>
<p><strong>Author:</strong> Lingsong Zeng<br>
<strong>Date:</strong> 04/20/2020</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<section id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h3>
<blockquote>
<div><p>This competition runs indefinitely with a rolling leaderboard. <a class="reference external" href="https://www.kaggle.com/docs/competitions#getting-started">Learn more</a></p>
</div></blockquote>
</section>
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Link to this heading">#</a></h3>
<p><img alt="" src="https://storage.googleapis.com/kaggle-media/competitions/House%20Prices/kaggle_5407_media_housesbanner.png" /></p>
<p>Ask a home buyer to describe their dream house, and they probably wonâ€™t begin with the height of the basement ceiling or the proximity to an east-west railroad. But this playground competitionâ€™s dataset proves that much more influences price negotiations than the number of bedrooms or a white-picket fence.</p>
<p>With 79 explanatory variables describing (almost) every aspect of residential homes in Ames, Iowa, this competition challenges you to predict the final price of each home.</p>
</section>
<section id="practice-skills">
<h3>Practice Skills<a class="headerlink" href="#practice-skills" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Creative feature engineering</p></li>
<li><p>Advanced regression techniques like random forest and gradient boosting</p></li>
</ul>
</section>
<section id="acknowledgments">
<h3>Acknowledgments<a class="headerlink" href="#acknowledgments" title="Link to this heading">#</a></h3>
<p>The <a class="reference external" href="https://www.amstat.org/publications/jse/v19n3/decock.pdf">Ames Housing dataset</a> was compiled by Dean De Cock for use in data science education. Itâ€™s an incredible alternative for data scientists looking for a modernized and expanded version of the often cited Boston Housing dataset.</p>
<p>Photo by <a class="reference external" href="https://unsplash.com/&#64;tthfilms">Tom Thain</a> on Unsplash.</p>
</section>
<section id="evaluation">
<h3>Evaluation<a class="headerlink" href="#evaluation" title="Link to this heading">#</a></h3>
<section id="goal">
<h4>Goal<a class="headerlink" href="#goal" title="Link to this heading">#</a></h4>
<p>It is my job to predict the sales price for each house. For each Id in the test set, predict the value of the <code class="docutils literal notranslate"><span class="pre">SalePrice</span></code> variable.</p>
</section>
<section id="metric">
<h4>Metric<a class="headerlink" href="#metric" title="Link to this heading">#</a></h4>
<p>Submissions are evaluated on <a class="reference external" href="https://en.wikipedia.org/wiki/Root_mean_square_deviation">Root-Mean-Squared-Error (RMSE)</a> between the logarithm of the predicted value and the logarithm of the observed sales price. (Taking logs means that errors in predicting expensive houses and cheap houses will affect the result equally.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load required packages</span>

<span class="nf">suppressWarnings</span><span class="p">({</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span><span class="w">         </span><span class="c1"># Read CSV files</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">         </span><span class="c1"># Data manipulation</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span><span class="w">         </span><span class="c1"># Data tidying</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">       </span><span class="c1"># Data visualization</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">moments</span><span class="p">)</span><span class="w">       </span><span class="c1"># Skewness &amp; kurtosis analysis</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span><span class="w">        </span><span class="c1"># Scaling and formatting plots</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">VIM</span><span class="p">)</span><span class="w">           </span><span class="c1"># kNN imputation for missing values</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span><span class="w">           </span><span class="c1"># Variance Inflation Factor (VIF) for multicollinearity</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">caret</span><span class="p">)</span><span class="w">         </span><span class="c1"># Machine learning framework (model training &amp; tuning)</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">e1071</span><span class="p">)</span><span class="w">         </span><span class="c1"># Support Vector Machines (SVM)</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">kernlab</span><span class="p">)</span><span class="w">       </span><span class="c1"># Advanced SVM implementation</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">glmnet</span><span class="p">)</span><span class="w">        </span><span class="c1"># Lasso, Ridge, and ElasticNet regression</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">rpart</span><span class="p">)</span><span class="w">         </span><span class="c1"># Decision Tree modeling</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">rpart.plot</span><span class="p">)</span><span class="w">    </span><span class="c1"># Decision Tree visualization</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">randomForest</span><span class="p">)</span><span class="w">  </span><span class="c1"># Random Forest (bagging)</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">xgboost</span><span class="p">)</span><span class="w">       </span><span class="c1"># Extreme Gradient Boosting (XGBoost)</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attaching package: &#39;dplyr&#39;


The following objects are masked from &#39;package:stats&#39;:

    filter, lag


The following objects are masked from &#39;package:base&#39;:

    intersect, setdiff, setequal, union



Attaching package: &#39;scales&#39;


The following object is masked from &#39;package:readr&#39;:

    col_factor


Loading required package: colorspace

Loading required package: grid

VIM is ready to use.


Suggestions and bug-reports can be submitted at: https://github.com/statistikat/VIM/issues


Attaching package: &#39;VIM&#39;


The following object is masked from &#39;package:datasets&#39;:

    sleep


Loading required package: carData


Attaching package: &#39;car&#39;


The following object is masked from &#39;package:dplyr&#39;:

    recode


Loading required package: lattice


Attaching package: &#39;e1071&#39;


The following objects are masked from &#39;package:moments&#39;:

    kurtosis, moment, skewness



Attaching package: &#39;kernlab&#39;


The following object is masked from &#39;package:scales&#39;:

    alpha


The following object is masked from &#39;package:ggplot2&#39;:

    alpha


Loading required package: Matrix


Attaching package: &#39;Matrix&#39;


The following objects are masked from &#39;package:tidyr&#39;:

    expand, pack, unpack


Loaded glmnet 4.1-8

randomForest 4.7-1.2

Type rfNews() to see new features/changes/bug fixes.


Attaching package: &#39;randomForest&#39;


The following object is masked from &#39;package:ggplot2&#39;:

    margin


The following object is masked from &#39;package:dplyr&#39;:

    combine



Attaching package: &#39;xgboost&#39;


The following object is masked from &#39;package:dplyr&#39;:

    slice
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Link to this heading">#</a></h2>
<section id="file-descriptions">
<h3>File descriptions<a class="headerlink" href="#file-descriptions" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">train.csv</span></code> - the training set</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test.csv</span></code> - the test set</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data_description.txt</span></code> - full description of each column, originally prepared by Dean De Cock but lightly edited to match the column names used here</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_submission.csv</span></code> - a benchmark submission from a linear regression on year and month of sale, lot square footage, and number of bedrooms</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct file paths</span>
<span class="n">train_path</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;raw&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;train.csv&quot;</span><span class="p">)</span>
<span class="n">test_path</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;raw&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;test.csv&quot;</span><span class="p">)</span>

<span class="c1"># Read data</span>
<span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="n">train_path</span><span class="p">)</span>
<span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="n">test_path</span><span class="p">)</span>

<span class="c1"># Extract the Id column</span>
<span class="n">Id</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">Id</span>

<span class="c1"># Remove the Id column</span>
<span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="n">Id</span><span class="p">)</span>
<span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="n">Id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Rows: </span><span class=" -Color -Color-Blue">1460</span> <span class=" -Color -Color-Bold">Columns: </span><span class=" -Color -Color-Blue">81</span>
<span class=" -Color -Color-Cyan">â”€â”€</span> <span class=" -Color -Color-Bold">Column specification</span> <span class=" -Color -Color-Cyan">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class=" -Color -Color-Bold">Delimiter:</span> &quot;,&quot;
<span class=" -Color -Color-Red">chr</span> (43): MSZoning, Street, Alley, LotShape, LandContour, Utilities, LotConf...
<span class=" -Color -Color-Green">dbl</span> (38): Id, MSSubClass, LotFrontage, LotArea, OverallQual, OverallCond, Ye...

<span class=" -Color -Color-Cyan">â„¹</span> Use `spec()` to retrieve the full column specification for this data.
<span class=" -Color -Color-Cyan">â„¹</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.
<span class=" -Color -Color-Bold">Rows: </span><span class=" -Color -Color-Blue">1459</span> <span class=" -Color -Color-Bold">Columns: </span><span class=" -Color -Color-Blue">80</span>
<span class=" -Color -Color-Cyan">â”€â”€</span> <span class=" -Color -Color-Bold">Column specification</span> <span class=" -Color -Color-Cyan">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class=" -Color -Color-Bold">Delimiter:</span> &quot;,&quot;
<span class=" -Color -Color-Red">chr</span> (43): MSZoning, Street, Alley, LotShape, LandContour, Utilities, LotConf...
<span class=" -Color -Color-Green">dbl</span> (37): Id, MSSubClass, LotFrontage, LotArea, OverallQual, OverallCond, Ye...

<span class=" -Color -Color-Cyan">â„¹</span> Use `spec()` to retrieve the full column specification for this data.
<span class=" -Color -Color-Cyan">â„¹</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.
</pre></div>
</div>
</div>
</div>
<p>Here we using <code class="docutils literal notranslate"><span class="pre">file.path</span></code> , the dynamic path generation, instead of using hard-coded paths is aiming to provide better compatibility across different platforms.</p>
<p>Different operating systems use different path separators (e.g. Windows uses <code class="docutils literal notranslate"><span class="pre">\</span></code>, while Linux and macOS use <code class="docutils literal notranslate"><span class="pre">/</span></code>). <code class="docutils literal notranslate"><span class="pre">file.path</span></code> automatically chooses the correct separator based on the operating system.</p>
<p>The size of the training dataset and the test dataset are roughly the same. The test dataset has one less column than the training dataset, which is our target column <code class="docutils literal notranslate"><span class="pre">SalePrice</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">glimpse</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rows: 1,460
Columns: 80
$ MSSubClass    &lt;dbl&gt; 60, 20, 60, 70, 60, 50, 20, 60, 50, 190, 20, 60, 20, 20,â€¦
$ MSZoning      &lt;chr&gt; &quot;RL&quot;, &quot;RL&quot;, &quot;RL&quot;, &quot;RL&quot;, &quot;RL&quot;, &quot;RL&quot;, &quot;RL&quot;, &quot;RL&quot;, &quot;RM&quot;, &quot;Râ€¦
$ LotFrontage   &lt;dbl&gt; 65, 80, 68, 60, 84, 85, 75, NA, 51, 50, 70, 85, NA, 91, â€¦
$ LotArea       &lt;dbl&gt; 8450, 9600, 11250, 9550, 14260, 14115, 10084, 10382, 612â€¦
$ Street        &lt;chr&gt; &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, â€¦
$ Alley         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, â€¦
$ LotShape      &lt;chr&gt; &quot;Reg&quot;, &quot;Reg&quot;, &quot;IR1&quot;, &quot;IR1&quot;, &quot;IR1&quot;, &quot;IR1&quot;, &quot;Reg&quot;, &quot;IR1&quot;, â€¦
$ LandContour   &lt;chr&gt; &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, â€¦
$ Utilities     &lt;chr&gt; &quot;AllPub&quot;, &quot;AllPub&quot;, &quot;AllPub&quot;, &quot;AllPub&quot;, &quot;AllPub&quot;, &quot;AllPuâ€¦
$ LotConfig     &lt;chr&gt; &quot;Inside&quot;, &quot;FR2&quot;, &quot;Inside&quot;, &quot;Corner&quot;, &quot;FR2&quot;, &quot;Inside&quot;, &quot;Iâ€¦
$ LandSlope     &lt;chr&gt; &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, â€¦
$ Neighborhood  &lt;chr&gt; &quot;CollgCr&quot;, &quot;Veenker&quot;, &quot;CollgCr&quot;, &quot;Crawfor&quot;, &quot;NoRidge&quot;, &quot;â€¦
$ Condition1    &lt;chr&gt; &quot;Norm&quot;, &quot;Feedr&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;,â€¦
$ Condition2    &lt;chr&gt; &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, â€¦
$ BldgType      &lt;chr&gt; &quot;1Fam&quot;, &quot;1Fam&quot;, &quot;1Fam&quot;, &quot;1Fam&quot;, &quot;1Fam&quot;, &quot;1Fam&quot;, &quot;1Fam&quot;, â€¦
$ HouseStyle    &lt;chr&gt; &quot;2Story&quot;, &quot;1Story&quot;, &quot;2Story&quot;, &quot;2Story&quot;, &quot;2Story&quot;, &quot;1.5Fiâ€¦
$ OverallQual   &lt;dbl&gt; 7, 6, 7, 7, 8, 5, 8, 7, 7, 5, 5, 9, 5, 7, 6, 7, 6, 4, 5,â€¦
$ OverallCond   &lt;dbl&gt; 5, 8, 5, 5, 5, 5, 5, 6, 5, 6, 5, 5, 6, 5, 5, 8, 7, 5, 5,â€¦
$ YearBuilt     &lt;dbl&gt; 2003, 1976, 2001, 1915, 2000, 1993, 2004, 1973, 1931, 19â€¦
$ YearRemodAdd  &lt;dbl&gt; 2003, 1976, 2002, 1970, 2000, 1995, 2005, 1973, 1950, 19â€¦
$ RoofStyle     &lt;chr&gt; &quot;Gable&quot;, &quot;Gable&quot;, &quot;Gable&quot;, &quot;Gable&quot;, &quot;Gable&quot;, &quot;Gable&quot;, &quot;Gâ€¦
$ RoofMatl      &lt;chr&gt; &quot;CompShg&quot;, &quot;CompShg&quot;, &quot;CompShg&quot;, &quot;CompShg&quot;, &quot;CompShg&quot;, &quot;â€¦
$ Exterior1st   &lt;chr&gt; &quot;VinylSd&quot;, &quot;MetalSd&quot;, &quot;VinylSd&quot;, &quot;Wd Sdng&quot;, &quot;VinylSd&quot;, &quot;â€¦
$ Exterior2nd   &lt;chr&gt; &quot;VinylSd&quot;, &quot;MetalSd&quot;, &quot;VinylSd&quot;, &quot;Wd Shng&quot;, &quot;VinylSd&quot;, &quot;â€¦
$ MasVnrType    &lt;chr&gt; &quot;BrkFace&quot;, &quot;None&quot;, &quot;BrkFace&quot;, &quot;None&quot;, &quot;BrkFace&quot;, &quot;None&quot;,â€¦
$ MasVnrArea    &lt;dbl&gt; 196, 0, 162, 0, 350, 0, 186, 240, 0, 0, 0, 286, 0, 306, â€¦
$ ExterQual     &lt;chr&gt; &quot;Gd&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;Tâ€¦
$ ExterCond     &lt;chr&gt; &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;Tâ€¦
$ Foundation    &lt;chr&gt; &quot;PConc&quot;, &quot;CBlock&quot;, &quot;PConc&quot;, &quot;BrkTil&quot;, &quot;PConc&quot;, &quot;Wood&quot;, &quot;â€¦
$ BsmtQual      &lt;chr&gt; &quot;Gd&quot;, &quot;Gd&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;Gd&quot;, &quot;Ex&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;Tâ€¦
$ BsmtCond      &lt;chr&gt; &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;Tâ€¦
$ BsmtExposure  &lt;chr&gt; &quot;No&quot;, &quot;Gd&quot;, &quot;Mn&quot;, &quot;No&quot;, &quot;Av&quot;, &quot;No&quot;, &quot;Av&quot;, &quot;Mn&quot;, &quot;No&quot;, &quot;Nâ€¦
$ BsmtFinType1  &lt;chr&gt; &quot;GLQ&quot;, &quot;ALQ&quot;, &quot;GLQ&quot;, &quot;ALQ&quot;, &quot;GLQ&quot;, &quot;GLQ&quot;, &quot;GLQ&quot;, &quot;ALQ&quot;, â€¦
$ BsmtFinSF1    &lt;dbl&gt; 706, 978, 486, 216, 655, 732, 1369, 859, 0, 851, 906, 99â€¦
$ BsmtFinType2  &lt;chr&gt; &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;BLQ&quot;, â€¦
$ BsmtFinSF2    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0â€¦
$ BsmtUnfSF     &lt;dbl&gt; 150, 284, 434, 540, 490, 64, 317, 216, 952, 140, 134, 17â€¦
$ TotalBsmtSF   &lt;dbl&gt; 856, 1262, 920, 756, 1145, 796, 1686, 1107, 952, 991, 10â€¦
$ Heating       &lt;chr&gt; &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, â€¦
$ HeatingQC     &lt;chr&gt; &quot;Ex&quot;, &quot;Ex&quot;, &quot;Ex&quot;, &quot;Gd&quot;, &quot;Ex&quot;, &quot;Ex&quot;, &quot;Ex&quot;, &quot;Ex&quot;, &quot;Gd&quot;, &quot;Eâ€¦
$ CentralAir    &lt;chr&gt; &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;â€¦
$ Electrical    &lt;chr&gt; &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;Sâ€¦
$ `1stFlrSF`    &lt;dbl&gt; 856, 1262, 920, 961, 1145, 796, 1694, 1107, 1022, 1077, â€¦
$ `2ndFlrSF`    &lt;dbl&gt; 854, 0, 866, 756, 1053, 566, 0, 983, 752, 0, 0, 1142, 0,â€¦
$ LowQualFinSF  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,â€¦
$ GrLivArea     &lt;dbl&gt; 1710, 1262, 1786, 1717, 2198, 1362, 1694, 2090, 1774, 10â€¦
$ BsmtFullBath  &lt;dbl&gt; 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1,â€¦
$ BsmtHalfBath  &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,â€¦
$ FullBath      &lt;dbl&gt; 2, 2, 2, 1, 2, 1, 2, 2, 2, 1, 1, 3, 1, 2, 1, 1, 1, 2, 1,â€¦
$ HalfBath      &lt;dbl&gt; 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1,â€¦
$ BedroomAbvGr  &lt;dbl&gt; 3, 3, 3, 3, 4, 1, 3, 3, 2, 2, 3, 4, 2, 3, 2, 2, 2, 2, 3,â€¦
$ KitchenAbvGr  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1,â€¦
$ KitchenQual   &lt;chr&gt; &quot;Gd&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;Gd&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;Tâ€¦
$ TotRmsAbvGrd  &lt;dbl&gt; 8, 6, 6, 7, 9, 5, 7, 7, 8, 5, 5, 11, 4, 7, 5, 5, 5, 6, 6â€¦
$ Functional    &lt;chr&gt; &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, â€¦
$ Fireplaces    &lt;dbl&gt; 0, 1, 1, 1, 1, 0, 1, 2, 2, 2, 0, 2, 0, 1, 1, 0, 1, 0, 0,â€¦
$ FireplaceQu   &lt;chr&gt; NA, &quot;TA&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;TA&quot;, NA, &quot;Gd&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, â€¦
$ GarageType    &lt;chr&gt; &quot;Attchd&quot;, &quot;Attchd&quot;, &quot;Attchd&quot;, &quot;Detchd&quot;, &quot;Attchd&quot;, &quot;Attchâ€¦
$ GarageYrBlt   &lt;dbl&gt; 2003, 1976, 2001, 1998, 2000, 1993, 2004, 1973, 1931, 19â€¦
$ GarageFinish  &lt;chr&gt; &quot;RFn&quot;, &quot;RFn&quot;, &quot;RFn&quot;, &quot;Unf&quot;, &quot;RFn&quot;, &quot;Unf&quot;, &quot;RFn&quot;, &quot;RFn&quot;, â€¦
$ GarageCars    &lt;dbl&gt; 2, 2, 2, 3, 3, 2, 2, 2, 2, 1, 1, 3, 1, 3, 1, 2, 2, 2, 2,â€¦
$ GarageArea    &lt;dbl&gt; 548, 460, 608, 642, 836, 480, 636, 484, 468, 205, 384, 7â€¦
$ GarageQual    &lt;chr&gt; &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;Fa&quot;, &quot;Gâ€¦
$ GarageCond    &lt;chr&gt; &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;Tâ€¦
$ PavedDrive    &lt;chr&gt; &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;â€¦
$ WoodDeckSF    &lt;dbl&gt; 0, 298, 0, 0, 192, 40, 255, 235, 90, 0, 0, 147, 140, 160â€¦
$ OpenPorchSF   &lt;dbl&gt; 61, 0, 42, 35, 84, 30, 57, 204, 0, 4, 0, 21, 0, 33, 213,â€¦
$ EnclosedPorch &lt;dbl&gt; 0, 0, 0, 272, 0, 0, 0, 228, 205, 0, 0, 0, 0, 0, 176, 0, â€¦
$ `3SsnPorch`   &lt;dbl&gt; 0, 0, 0, 0, 0, 320, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, â€¦
$ ScreenPorch   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 176, 0, 0, 0, 0, 0, â€¦
$ PoolArea      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,â€¦
$ PoolQC        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, â€¦
$ Fence         &lt;chr&gt; NA, NA, NA, NA, NA, &quot;MnPrv&quot;, NA, NA, NA, NA, NA, NA, NA,â€¦
$ MiscFeature   &lt;chr&gt; NA, NA, NA, NA, NA, &quot;Shed&quot;, NA, &quot;Shed&quot;, NA, NA, NA, NA, â€¦
$ MiscVal       &lt;dbl&gt; 0, 0, 0, 0, 0, 700, 0, 350, 0, 0, 0, 0, 0, 0, 0, 0, 700,â€¦
$ MoSold        &lt;dbl&gt; 2, 5, 9, 2, 12, 10, 8, 11, 4, 1, 2, 7, 9, 8, 5, 7, 3, 10â€¦
$ YrSold        &lt;dbl&gt; 2008, 2007, 2008, 2006, 2008, 2009, 2007, 2009, 2008, 20â€¦
$ SaleType      &lt;chr&gt; &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;Wâ€¦
$ SaleCondition &lt;chr&gt; &quot;Normal&quot;, &quot;Normal&quot;, &quot;Normal&quot;, &quot;Abnorml&quot;, &quot;Normal&quot;, &quot;Normâ€¦
$ SalePrice     &lt;dbl&gt; 208500, 181500, 223500, 140000, 250000, 143000, 307000, â€¦
</pre></div>
</div>
</div>
</div>
<p>Because we will use all features for modeling later, we need to convert all features in chr format to factor format. Therefore, we now need to filter out categorical features and numerical features separately.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">    </span><span class="s">&#39;MSSubClass&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MSZoning&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Street&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Alley&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LotShape&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LandContour&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&#39;Utilities&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LotConfig&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LandSlope&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Neighborhood&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Condition1&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="s">&#39;Condition2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;BldgType&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;HouseStyle&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;RoofStyle&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;RoofMatl&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="s">&#39;Exterior1st&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Exterior2nd&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MasVnrType&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ExterQual&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ExterCond&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="s">&#39;Foundation&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;BsmtQual&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;BsmtCond&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;BsmtExposure&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;BsmtFinType1&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="s">&#39;BsmtFinType2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Heating&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;HeatingQC&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;CentralAir&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Electrical&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="s">&#39;KitchenQual&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Functional&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;FireplaceQu&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;GarageType&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;GarageFinish&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="s">&#39;GarageQual&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;GarageCond&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;PavedDrive&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;PoolQC&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Fence&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MiscFeature&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="s">&#39;SaleType&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;SaleCondition&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;OverallQual&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;OverallCond&#39;</span>
<span class="p">)</span>

<span class="n">numerical_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">    </span><span class="s">&#39;LotFrontage&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LotArea&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;YearBuilt&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;YearRemodAdd&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MasVnrArea&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&#39;BsmtFinSF1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;BsmtFinSF2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;BsmtUnfSF&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;TotalBsmtSF&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;1stFlrSF&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&#39;2ndFlrSF&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LowQualFinSF&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;GrLivArea&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;BsmtFullBath&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;BsmtHalfBath&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&#39;FullBath&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;HalfBath&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;BedroomAbvGr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;KitchenAbvGr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;TotRmsAbvGrd&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&#39;Fireplaces&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;GarageYrBlt&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;GarageCars&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;GarageArea&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;WoodDeckSF&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&#39;OpenPorchSF&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;EnclosedPorch&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;3SsnPorch&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ScreenPorch&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;PoolArea&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&#39;MiscVal&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;MoSold&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;YrSold&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">categorical_features</span></code> and <code class="docutils literal notranslate"><span class="pre">numerical_features</span></code>, the reason we cannot directly select features with values of <code class="docutils literal notranslate"><span class="pre">int64</span></code> or <code class="docutils literal notranslate"><span class="pre">float64</span></code>, because some features such as <code class="docutils literal notranslate"><span class="pre">MSSubClass</span></code>:</p>
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>MSSubClass: Identifies the type of dwelling involved in the sale.	

        20	1-STORY 1946 &amp; NEWER ALL STYLES
        30	1-STORY 1945 &amp; OLDER
        40	1-STORY W/FINISHED ATTIC ALL AGES
        45	1-1/2 STORY - UNFINISHED ALL AGES
        50	1-1/2 STORY FINISHED ALL AGES
        60	2-STORY 1946 &amp; NEWER
        70	2-STORY 1945 &amp; OLDER
        75	2-1/2 STORY ALL AGES
        80	SPLIT OR MULTI-LEVEL
        85	SPLIT FOYER
        90	DUPLEX - ALL STYLES AND AGES
       120	1-STORY PUD (Planned Unit Development) - 1946 &amp; NEWER
       150	1-1/2 STORY PUD - ALL AGES
       160	2-STORY PUD - 1946 &amp; NEWER
       180	PUD - MULTILEVEL - INCL SPLIT LEV/FOYER
       190	2 FAMILY CONVERSION - ALL STYLES AND AGES
</pre></div>
</div>
<p>Its value is <code class="docutils literal notranslate"><span class="pre">int64</span></code> format, but it is actually a categorical feature. Therefore, here I manually distinguish all <code class="docutils literal notranslate"><span class="pre">categorical_features</span></code> and <code class="docutils literal notranslate"><span class="pre">numerical_features</span></code> according to the description in <code class="docutils literal notranslate"><span class="pre">data_description.txt</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert all categorical features to factor</span>
<span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="nf">across</span><span class="p">(</span><span class="nf">all_of</span><span class="p">(</span><span class="n">categorical_features</span><span class="p">),</span><span class="w"> </span><span class="n">as.factor</span><span class="p">))</span>

<span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="nf">across</span><span class="p">(</span><span class="nf">all_of</span><span class="p">(</span><span class="n">categorical_features</span><span class="p">),</span><span class="w"> </span><span class="n">as.factor</span><span class="p">))</span>

<span class="nf">glimpse</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rows: 1,460
Columns: 80
$ MSSubClass    &lt;fct&gt; 60, 20, 60, 70, 60, 50, 20, 60, 50, 190, 20, 60, 20, 20,â€¦
$ MSZoning      &lt;fct&gt; RL, RL, RL, RL, RL, RL, RL, RL, RM, RL, RL, RL, RL, RL, â€¦
$ LotFrontage   &lt;dbl&gt; 65, 80, 68, 60, 84, 85, 75, NA, 51, 50, 70, 85, NA, 91, â€¦
$ LotArea       &lt;dbl&gt; 8450, 9600, 11250, 9550, 14260, 14115, 10084, 10382, 612â€¦
$ Street        &lt;fct&gt; Pave, Pave, Pave, Pave, Pave, Pave, Pave, Pave, Pave, Paâ€¦
$ Alley         &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, â€¦
$ LotShape      &lt;fct&gt; Reg, Reg, IR1, IR1, IR1, IR1, Reg, IR1, Reg, Reg, Reg, Iâ€¦
$ LandContour   &lt;fct&gt; Lvl, Lvl, Lvl, Lvl, Lvl, Lvl, Lvl, Lvl, Lvl, Lvl, Lvl, Lâ€¦
$ Utilities     &lt;fct&gt; AllPub, AllPub, AllPub, AllPub, AllPub, AllPub, AllPub, â€¦
$ LotConfig     &lt;fct&gt; Inside, FR2, Inside, Corner, FR2, Inside, Inside, Cornerâ€¦
$ LandSlope     &lt;fct&gt; Gtl, Gtl, Gtl, Gtl, Gtl, Gtl, Gtl, Gtl, Gtl, Gtl, Gtl, Gâ€¦
$ Neighborhood  &lt;fct&gt; CollgCr, Veenker, CollgCr, Crawfor, NoRidge, Mitchel, Soâ€¦
$ Condition1    &lt;fct&gt; Norm, Feedr, Norm, Norm, Norm, Norm, Norm, PosN, Artery,â€¦
$ Condition2    &lt;fct&gt; Norm, Norm, Norm, Norm, Norm, Norm, Norm, Norm, Norm, Arâ€¦
$ BldgType      &lt;fct&gt; 1Fam, 1Fam, 1Fam, 1Fam, 1Fam, 1Fam, 1Fam, 1Fam, 1Fam, 2fâ€¦
$ HouseStyle    &lt;fct&gt; 2Story, 1Story, 2Story, 2Story, 2Story, 1.5Fin, 1Story, â€¦
$ OverallQual   &lt;fct&gt; 7, 6, 7, 7, 8, 5, 8, 7, 7, 5, 5, 9, 5, 7, 6, 7, 6, 4, 5,â€¦
$ OverallCond   &lt;fct&gt; 5, 8, 5, 5, 5, 5, 5, 6, 5, 6, 5, 5, 6, 5, 5, 8, 7, 5, 5,â€¦
$ YearBuilt     &lt;dbl&gt; 2003, 1976, 2001, 1915, 2000, 1993, 2004, 1973, 1931, 19â€¦
$ YearRemodAdd  &lt;dbl&gt; 2003, 1976, 2002, 1970, 2000, 1995, 2005, 1973, 1950, 19â€¦
$ RoofStyle     &lt;fct&gt; Gable, Gable, Gable, Gable, Gable, Gable, Gable, Gable, â€¦
$ RoofMatl      &lt;fct&gt; CompShg, CompShg, CompShg, CompShg, CompShg, CompShg, Coâ€¦
$ Exterior1st   &lt;fct&gt; VinylSd, MetalSd, VinylSd, Wd Sdng, VinylSd, VinylSd, Viâ€¦
$ Exterior2nd   &lt;fct&gt; VinylSd, MetalSd, VinylSd, Wd Shng, VinylSd, VinylSd, Viâ€¦
$ MasVnrType    &lt;fct&gt; BrkFace, None, BrkFace, None, BrkFace, None, Stone, Stonâ€¦
$ MasVnrArea    &lt;dbl&gt; 196, 0, 162, 0, 350, 0, 186, 240, 0, 0, 0, 286, 0, 306, â€¦
$ ExterQual     &lt;fct&gt; Gd, TA, Gd, TA, Gd, TA, Gd, TA, TA, TA, TA, Ex, TA, Gd, â€¦
$ ExterCond     &lt;fct&gt; TA, TA, TA, TA, TA, TA, TA, TA, TA, TA, TA, TA, TA, TA, â€¦
$ Foundation    &lt;fct&gt; PConc, CBlock, PConc, BrkTil, PConc, Wood, PConc, CBlockâ€¦
$ BsmtQual      &lt;fct&gt; Gd, Gd, Gd, TA, Gd, Gd, Ex, Gd, TA, TA, TA, Ex, TA, Gd, â€¦
$ BsmtCond      &lt;fct&gt; TA, TA, TA, Gd, TA, TA, TA, TA, TA, TA, TA, TA, TA, TA, â€¦
$ BsmtExposure  &lt;fct&gt; No, Gd, Mn, No, Av, No, Av, Mn, No, No, No, No, No, Av, â€¦
$ BsmtFinType1  &lt;fct&gt; GLQ, ALQ, GLQ, ALQ, GLQ, GLQ, GLQ, ALQ, Unf, GLQ, Rec, Gâ€¦
$ BsmtFinSF1    &lt;dbl&gt; 706, 978, 486, 216, 655, 732, 1369, 859, 0, 851, 906, 99â€¦
$ BsmtFinType2  &lt;fct&gt; Unf, Unf, Unf, Unf, Unf, Unf, Unf, BLQ, Unf, Unf, Unf, Uâ€¦
$ BsmtFinSF2    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0â€¦
$ BsmtUnfSF     &lt;dbl&gt; 150, 284, 434, 540, 490, 64, 317, 216, 952, 140, 134, 17â€¦
$ TotalBsmtSF   &lt;dbl&gt; 856, 1262, 920, 756, 1145, 796, 1686, 1107, 952, 991, 10â€¦
$ Heating       &lt;fct&gt; GasA, GasA, GasA, GasA, GasA, GasA, GasA, GasA, GasA, Gaâ€¦
$ HeatingQC     &lt;fct&gt; Ex, Ex, Ex, Gd, Ex, Ex, Ex, Ex, Gd, Ex, Ex, Ex, TA, Ex, â€¦
$ CentralAir    &lt;fct&gt; Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y,â€¦
$ Electrical    &lt;fct&gt; SBrkr, SBrkr, SBrkr, SBrkr, SBrkr, SBrkr, SBrkr, SBrkr, â€¦
$ `1stFlrSF`    &lt;dbl&gt; 856, 1262, 920, 961, 1145, 796, 1694, 1107, 1022, 1077, â€¦
$ `2ndFlrSF`    &lt;dbl&gt; 854, 0, 866, 756, 1053, 566, 0, 983, 752, 0, 0, 1142, 0,â€¦
$ LowQualFinSF  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,â€¦
$ GrLivArea     &lt;dbl&gt; 1710, 1262, 1786, 1717, 2198, 1362, 1694, 2090, 1774, 10â€¦
$ BsmtFullBath  &lt;dbl&gt; 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1,â€¦
$ BsmtHalfBath  &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,â€¦
$ FullBath      &lt;dbl&gt; 2, 2, 2, 1, 2, 1, 2, 2, 2, 1, 1, 3, 1, 2, 1, 1, 1, 2, 1,â€¦
$ HalfBath      &lt;dbl&gt; 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1,â€¦
$ BedroomAbvGr  &lt;dbl&gt; 3, 3, 3, 3, 4, 1, 3, 3, 2, 2, 3, 4, 2, 3, 2, 2, 2, 2, 3,â€¦
$ KitchenAbvGr  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1,â€¦
$ KitchenQual   &lt;fct&gt; Gd, TA, Gd, Gd, Gd, TA, Gd, TA, TA, TA, TA, Ex, TA, Gd, â€¦
$ TotRmsAbvGrd  &lt;dbl&gt; 8, 6, 6, 7, 9, 5, 7, 7, 8, 5, 5, 11, 4, 7, 5, 5, 5, 6, 6â€¦
$ Functional    &lt;fct&gt; Typ, Typ, Typ, Typ, Typ, Typ, Typ, Typ, Min1, Typ, Typ, â€¦
$ Fireplaces    &lt;dbl&gt; 0, 1, 1, 1, 1, 0, 1, 2, 2, 2, 0, 2, 0, 1, 1, 0, 1, 0, 0,â€¦
$ FireplaceQu   &lt;fct&gt; NA, TA, TA, Gd, TA, NA, Gd, TA, TA, TA, NA, Gd, NA, Gd, â€¦
$ GarageType    &lt;fct&gt; Attchd, Attchd, Attchd, Detchd, Attchd, Attchd, Attchd, â€¦
$ GarageYrBlt   &lt;dbl&gt; 2003, 1976, 2001, 1998, 2000, 1993, 2004, 1973, 1931, 19â€¦
$ GarageFinish  &lt;fct&gt; RFn, RFn, RFn, Unf, RFn, Unf, RFn, RFn, Unf, RFn, Unf, Fâ€¦
$ GarageCars    &lt;dbl&gt; 2, 2, 2, 3, 3, 2, 2, 2, 2, 1, 1, 3, 1, 3, 1, 2, 2, 2, 2,â€¦
$ GarageArea    &lt;dbl&gt; 548, 460, 608, 642, 836, 480, 636, 484, 468, 205, 384, 7â€¦
$ GarageQual    &lt;fct&gt; TA, TA, TA, TA, TA, TA, TA, TA, Fa, Gd, TA, TA, TA, TA, â€¦
$ GarageCond    &lt;fct&gt; TA, TA, TA, TA, TA, TA, TA, TA, TA, TA, TA, TA, TA, TA, â€¦
$ PavedDrive    &lt;fct&gt; Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y, Y,â€¦
$ WoodDeckSF    &lt;dbl&gt; 0, 298, 0, 0, 192, 40, 255, 235, 90, 0, 0, 147, 140, 160â€¦
$ OpenPorchSF   &lt;dbl&gt; 61, 0, 42, 35, 84, 30, 57, 204, 0, 4, 0, 21, 0, 33, 213,â€¦
$ EnclosedPorch &lt;dbl&gt; 0, 0, 0, 272, 0, 0, 0, 228, 205, 0, 0, 0, 0, 0, 176, 0, â€¦
$ `3SsnPorch`   &lt;dbl&gt; 0, 0, 0, 0, 0, 320, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, â€¦
$ ScreenPorch   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 176, 0, 0, 0, 0, 0, â€¦
$ PoolArea      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,â€¦
$ PoolQC        &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, â€¦
$ Fence         &lt;fct&gt; NA, NA, NA, NA, NA, MnPrv, NA, NA, NA, NA, NA, NA, NA, Nâ€¦
$ MiscFeature   &lt;fct&gt; NA, NA, NA, NA, NA, Shed, NA, Shed, NA, NA, NA, NA, NA, â€¦
$ MiscVal       &lt;dbl&gt; 0, 0, 0, 0, 0, 700, 0, 350, 0, 0, 0, 0, 0, 0, 0, 0, 700,â€¦
$ MoSold        &lt;dbl&gt; 2, 5, 9, 2, 12, 10, 8, 11, 4, 1, 2, 7, 9, 8, 5, 7, 3, 10â€¦
$ YrSold        &lt;dbl&gt; 2008, 2007, 2008, 2006, 2008, 2009, 2007, 2009, 2008, 20â€¦
$ SaleType      &lt;fct&gt; WD, WD, WD, WD, WD, WD, WD, WD, WD, WD, WD, New, WD, Newâ€¦
$ SaleCondition &lt;fct&gt; Normal, Normal, Normal, Abnorml, Normal, Normal, Normal,â€¦
$ SalePrice     &lt;dbl&gt; 208500, 181500, 223500, 140000, 250000, 143000, 307000, â€¦
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the variables where NA means &quot;None&quot;</span>
<span class="n">none_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">  </span><span class="s">&quot;Alley&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BsmtQual&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BsmtCond&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BsmtExposure&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;BsmtFinType1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BsmtFinType2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;FireplaceQu&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GarageType&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;GarageFinish&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GarageQual&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GarageCond&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;PoolQC&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;Fence&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MiscFeature&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>According to the description in <code class="docutils literal notranslate"><span class="pre">data_description.txt</span></code>, <code class="docutils literal notranslate"><span class="pre">NA</span></code> in some features does not mean Missing Value, but means that the observation does not have the feature, such as <code class="docutils literal notranslate"><span class="pre">Alley</span></code>:</p>
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>Alley: Type of alley access to property

       Grvl	Gravel
       Pave	Paved
       NA 	No alley access
</pre></div>
</div>
<p>Therefore, the missing value filling treatment of these features should be different. I filtered out all similar features here to prepare for the missing value filling in the subsequent preprocessing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Replace NA with &quot;None&quot; and ensure &quot;None&quot; is the lowest factor level</span>
<span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span>
<span class="w">    </span><span class="nf">across</span><span class="p">(</span><span class="nf">all_of</span><span class="p">(</span><span class="n">none_features</span><span class="p">),</span><span class="w"> </span>
<span class="w">    </span><span class="o">~</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span>
<span class="w">        </span><span class="nf">replace_na</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">.</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;None&quot;</span><span class="p">),</span><span class="w">  </span><span class="c1"># fill NA by &quot;None&quot;</span>
<span class="w">        </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="nf">na.omit</span><span class="p">(</span><span class="n">.</span><span class="p">)))))</span><span class="w">  </span><span class="c1"># redefine factor levels</span>
<span class="w">      </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>

<span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span>
<span class="w">    </span><span class="nf">across</span><span class="p">(</span>
<span class="w">      </span><span class="nf">all_of</span><span class="p">(</span><span class="n">none_features</span><span class="p">),</span><span class="w"> </span>
<span class="w">      </span><span class="o">~</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span>
<span class="w">          </span><span class="nf">replace_na</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">.</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;None&quot;</span><span class="p">),</span><span class="w">  </span>
<span class="w">          </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="nf">na.omit</span><span class="p">(</span><span class="n">.</span><span class="p">)))))</span>
<span class="w">      </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>


<span class="c1"># Verify the changes</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">none_features</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Alley      BsmtQual   BsmtCond    BsmtExposure BsmtFinType1 BsmtFinType2
 None:1369   None: 37   None:  37   None: 38     None: 37     None:  38   
 Grvl:  50   Ex  :121   Fa  :  45   Av  :221     ALQ :220     ALQ :  19   
 Pave:  41   Fa  : 35   Gd  :  65   Gd  :134     BLQ :148     BLQ :  33   
             Gd  :618   Po  :   2   Mn  :114     GLQ :418     GLQ :  14   
             TA  :649   TA  :1311   No  :953     LwQ : 74     LwQ :  46   
                                                 Rec :133     Rec :  54   
                                                 Unf :430     Unf :1256   
 FireplaceQu   GarageType  GarageFinish GarageQual  GarageCond   PoolQC    
 None:690    None   : 81   None: 81     None:  81   None:  81   None:1453  
 Ex  : 24    2Types :  6   Fin :352     Ex  :   3   Ex  :   2   Ex  :   2  
 Fa  : 33    Attchd :870   RFn :422     Fa  :  48   Fa  :  35   Fa  :   2  
 Gd  :380    Basment: 19   Unf :605     Gd  :  14   Gd  :   9   Gd  :   3  
 Po  : 20    BuiltIn: 88                Po  :   3   Po  :   7              
 TA  :313    CarPort:  9                TA  :1311   TA  :1326              
             Detchd :387                                                   
   Fence      MiscFeature
 None :1179   None:1406  
 GdPrv:  59   Gar2:   2  
 GdWo :  54   Othr:   2  
 MnPrv: 157   Shed:  49  
 MnWw :  11   TenC:   1  
                         
                         
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">ordinal_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;MSSubClass&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;OverallQual&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;OverallCond&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;LotShape&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;LandSlope&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;ExterQual&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ExterCond&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BsmtQual&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BsmtCond&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BsmtExposure&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;BsmtFinType1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BsmtFinType2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;HeatingQC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;KitchenQual&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Functional&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;FireplaceQu&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GarageFinish&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GarageQual&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GarageCond&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;PavedDrive&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;PoolQC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fence&quot;</span>
<span class="p">)</span>

<span class="n">nominal_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;MSZoning&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Street&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Alley&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;LandContour&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Utilities&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;LotConfig&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Neighborhood&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Condition1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Condition2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BldgType&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;HouseStyle&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;RoofStyle&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;RoofMatl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Exterior1st&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Exterior2nd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MasVnrType&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Foundation&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Heating&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;CentralAir&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Electrical&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GarageType&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;MiscFeature&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SaleType&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SaleCondition&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Similarly, I also distinguish between <code class="docutils literal notranslate"><span class="pre">ordinal_features</span></code> and <code class="docutils literal notranslate"><span class="pre">nominal_features</span></code> here to facilitate subsequent preprocessing. The main difference between them is whether the variable values are ordered. The following are examples of an ordinal feature and a nominal feature respectively.</p>
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>ExterQual: Evaluates the quality of the material on the exterior 
		
       Ex	Excellent
       Gd	Good
       TA	Average/Typical
       Fa	Fair
       Po	Poor

MSZoning: Identifies the general zoning classification of the sale.
		
       A	Agriculture
       C	Commercial
       FV	Floating Village Residential
       I	Industrial
       RH	Residential High Density
       RL	Residential Low Density
       RP	Residential Low Density Park 
       RM	Residential Medium Density
</pre></div>
</div>
<p>In the following preprocessing, ordinal features will be applied with Label Encoding, while nominal features will be applied with One-Hot Encoding.</p>
</section>
</section>
<section id="eda">
<h2>EDA<a class="headerlink" href="#eda" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">train</span><span class="o">$</span><span class="n">SalePrice</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  34900  129975  163000  180921  214000  755000 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">)</span>

<span class="c1"># Create a tibble with SalePrice</span>
<span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SalePrice</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">after_stat</span><span class="p">(</span><span class="n">count</span><span class="p">)),</span><span class="w"> </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_fill_viridis_c</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SalePrice&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;plasma&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span>
<span class="w">    </span><span class="nf">aes</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">SalePrice</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)),</span><span class="w"> </span>
<span class="w">    </span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.2</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">comma_format</span><span class="p">())</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="c1"># not use scientific notation</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SalePrice&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Count&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SalePrice Distribution&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Histogram with Adjusted Density Plot&quot;</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/6b6a5150028ae2bc9668960001d3577b2a9b417677ce2a5f15bc3137a9f783e2.png"><img alt="../_images/6b6a5150028ae2bc9668960001d3577b2a9b417677ce2a5f15bc3137a9f783e2.png" src="../_images/6b6a5150028ae2bc9668960001d3577b2a9b417677ce2a5f15bc3137a9f783e2.png" style="width: 600px; height: 480px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate skewness and kurtosis</span>
<span class="n">skewness_value</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">skewness</span><span class="p">(</span><span class="n">train</span><span class="o">$</span><span class="n">SalePrice</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">kurtosis_value</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">kurtosis</span><span class="p">(</span><span class="n">train</span><span class="o">$</span><span class="n">SalePrice</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># Print skewness and kurtosis</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Skewness of SalePrice:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">skewness_value</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Kurtosis of SalePrice:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">kurtosis_value</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Skewness of SalePrice: 1.879009 
Kurtosis of SalePrice: 6.496789 
</pre></div>
</div>
</div>
</div>
<p>From the histogram and the calculated value of skewness (1.88), we can see that the distribution of <code class="docutils literal notranslate"><span class="pre">SalePrice</span></code> is right-skewed. This may have a negative impact on the training of the model. So we need a log transformation for <code class="docutils literal notranslate"><span class="pre">SalePrice</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Log transformation of SalePrice</span>
<span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="n">SalePrice_log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">SalePrice</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the distribution of log-transformed SalePrice</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SalePrice_log</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">after_stat</span><span class="p">(</span><span class="n">count</span><span class="p">)),</span><span class="w"> </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_fill_viridis_c</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Log SalePrice&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;plasma&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span>
<span class="w">    </span><span class="nf">aes</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">SalePrice_log</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)),</span><span class="w"> </span>
<span class="w">    </span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.2</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">comma_format</span><span class="p">())</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="c1"># not use scientific notation</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Log(SalePrice)&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Count&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Log-Transformed SalePrice Distribution&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Histogram of Log-Transformed SalePrice&quot;</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/d93d8cef35826cabab1e79f7e92783e5399dd4e9b2060cf365190b327238da71.png"><img alt="../_images/d93d8cef35826cabab1e79f7e92783e5399dd4e9b2060cf365190b327238da71.png" src="../_images/d93d8cef35826cabab1e79f7e92783e5399dd4e9b2060cf365190b327238da71.png" style="width: 600px; height: 480px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate skewness and kurtosis for log-transformed SalePrice</span>
<span class="n">skewness_log</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">skewness</span><span class="p">(</span><span class="n">train</span><span class="o">$</span><span class="n">SalePrice_log</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">kurtosis_log</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">kurtosis</span><span class="p">(</span><span class="n">train</span><span class="o">$</span><span class="n">SalePrice_log</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># Print skewness and kurtosis</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Log-Transformed SalePrice_log Skewness:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">skewness_log</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Log-Transformed SalePrice_log Kurtosis:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">kurtosis_log</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log-Transformed SalePrice_log Skewness: 0.1210859 
Log-Transformed SalePrice_log Kurtosis: 0.7974482 
</pre></div>
</div>
</div>
</div>
<p>From the charts and statistics, we can see that after logarithmic transformation, the distribution of <code class="docutils literal notranslate"><span class="pre">SalePrice</span></code> is closer to normal distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove the original SalePrice column</span>
<span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="n">SalePrice</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The following is the distribution of the remaining numerical features:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">)</span>

<span class="c1"># Convert train dataset to long format and remove NA/Inf values</span>
<span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="nf">all_of</span><span class="p">(</span><span class="n">numerical_features</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">pivot_longer</span><span class="p">(</span><span class="n">cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">everything</span><span class="p">(),</span><span class="w"> </span><span class="n">names_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Feature&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">values_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Value&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="nf">is.finite</span><span class="p">(</span><span class="n">Value</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># Remove NA and Inf values</span>

<span class="c1"># Plot histograms for all numerical features</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Value</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">Feature</span><span class="p">,</span><span class="w"> </span><span class="n">scales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;free&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="c1"># Free scales to adjust for different ranges</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Distribution of Numerical Features&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Value&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Count&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/e6fd066fa9ce9f9fdbacfd8ad46068a451afc2ce6a9b0bdb7b2847997e95b50a.png"><img alt="../_images/e6fd066fa9ce9f9fdbacfd8ad46068a451afc2ce6a9b0bdb7b2847997e95b50a.png" src="../_images/e6fd066fa9ce9f9fdbacfd8ad46068a451afc2ce6a9b0bdb7b2847997e95b50a.png" style="width: 900px; height: 900px;" /></a>
</div>
</div>
</section>
<section id="feature-engineering">
<h2>Feature Engineering<a class="headerlink" href="#feature-engineering" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to add features</span>
<span class="n">add_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">create_interactions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">create_base_features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1"># Create a new dataframe to store features</span>
<span class="w">  </span><span class="n">new_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rownames</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Base features</span>
<span class="w">  </span><span class="nf">if </span><span class="p">(</span><span class="n">create_base_features</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">new_features</span><span class="o">$</span><span class="n">HouseAge</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="o">$</span><span class="n">YrSold</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">data</span><span class="o">$</span><span class="n">YearBuilt</span>
<span class="w">    </span><span class="n">new_features</span><span class="o">$</span><span class="n">RemodelAge</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="o">$</span><span class="n">YrSold</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">data</span><span class="o">$</span><span class="n">YearRemodAdd</span>
<span class="w">    </span><span class="n">new_features</span><span class="o">$</span><span class="n">TotalSF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="o">$</span><span class="n">`1stFlrSF`</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">data</span><span class="o">$</span><span class="n">`2ndFlrSF`</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">data</span><span class="o">$</span><span class="n">TotalBsmtSF</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Merge new features into the original dataset</span>
<span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">new_features</span><span class="p">)</span>
<span class="w">  </span><span class="nf">return</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply feature engineering to train and test datasets</span>
<span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">add_features</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">add_features</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="c1"># Define new features</span>
<span class="n">new_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;HouseAge&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;RemodelAge&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TotalSF&quot;</span><span class="p">)</span>

<span class="c1"># Update numerical_features list</span>
<span class="n">numerical_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">numerical_features</span><span class="p">,</span><span class="w"> </span><span class="n">new_features</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">)</span>

<span class="c1"># Plot histograms for new features</span>
<span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="nf">all_of</span><span class="p">(</span><span class="n">new_features</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">pivot_longer</span><span class="p">(</span><span class="n">cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">everything</span><span class="p">(),</span><span class="w"> </span><span class="n">names_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Feature&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">values_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Value&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Value</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">Feature</span><span class="p">,</span><span class="w"> </span><span class="n">scales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;free&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">  </span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Distribution of Newly Created Features&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Value&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Count&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/b65649076f2e48b69ad4d1ee4f6357f8d118ad0ce8d8a6ea45f9d0fec70cd208.png"><img alt="../_images/b65649076f2e48b69ad4d1ee4f6357f8d118ad0ce8d8a6ea45f9d0fec70cd208.png" src="../_images/b65649076f2e48b69ad4d1ee4f6357f8d118ad0ce8d8a6ea45f9d0fec70cd208.png" style="width: 720px; height: 240px;" /></a>
</div>
</div>
</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Link to this heading">#</a></h2>
<section id="handling-missing-values">
<h3>Handling Missing Values<a class="headerlink" href="#handling-missing-values" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to find columns with NA</span>
<span class="n">check_na</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">na_count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">colSums</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="w">  </span><span class="n">na_count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="n">na_count</span><span class="p">[</span><span class="n">na_count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">  </span><span class="c1"># Only keep columns with NA</span>
<span class="w">  </span><span class="nf">return</span><span class="p">(</span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">na_count</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1"># Check missing values in train and test</span>
<span class="n">na_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">check_na</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">na_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">check_na</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="c1"># Print missing value summary</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Missing Values in Train Dataset:\n&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">na_train</span><span class="p">)</span>

<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\nMissing Values in Test Dataset:\n&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">na_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Missing Values in Train Dataset:
            na_count
LotFrontage      259
GarageYrBlt       81
MasVnrType         8
MasVnrArea         8
Electrical         1

Missing Values in Test Dataset:
             na_count
LotFrontage       227
GarageYrBlt        78
MasVnrType         16
MasVnrArea         15
MSZoning            4
Utilities           2
BsmtFullBath        2
BsmtHalfBath        2
Functional          2
Exterior1st         1
Exterior2nd         1
BsmtFinSF1          1
BsmtFinSF2          1
BsmtUnfSF           1
TotalBsmtSF         1
KitchenQual         1
GarageCars          1
GarageArea          1
SaleType            1
TotalSF             1
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">NA</span></code> for these variables means the structure does not exist and should be filled with 0:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GarageYrBlt</span></code> (year garage was built)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MasVnrArea</span></code> (brick facing area)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BsmtFinSF1</span></code>, <code class="docutils literal notranslate"><span class="pre">BsmtFinSF2</span></code>, <code class="docutils literal notranslate"><span class="pre">BsmtUnfSF</span></code> (basement area)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TotalBsmtSF</span></code> (total basement area)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GarageCars</span></code> (number of garage spaces)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GarageArea</span></code> (garage area)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TotalSF</span></code> (total area, usually equal to <code class="docutils literal notranslate"><span class="pre">1stFlrSF</span></code> + <code class="docutils literal notranslate"><span class="pre">2ndFlrSF</span></code> + <code class="docutils literal notranslate"><span class="pre">TotalBsmtSF</span></code>)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">zero_fill_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;GarageYrBlt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MasVnrArea&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BsmtFinSF1&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="s">&quot;BsmtFinSF2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BsmtUnfSF&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TotalBsmtSF&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="s">&quot;GarageCars&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GarageArea&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TotalSF&quot;</span><span class="p">)</span>

<span class="n">train</span><span class="p">[</span><span class="n">zero_fill_features</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">zero_fill_features</span><span class="p">],</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">))</span>
<span class="n">test</span><span class="p">[</span><span class="n">zero_fill_features</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">zero_fill_features</span><span class="p">],</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">NA</span></code> for these variables may be missing data entries and should be filled with the most common category (Mode):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MasVnrType</span></code> (brickwork finish type)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Electrical</span></code> (electrical system)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MSZoning</span></code> (land zoning)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Utilities</span></code> (public facilities)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Functional</span></code> (house function)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Exterior1st</span></code>, <code class="docutils literal notranslate"><span class="pre">Exterior2nd</span></code> (exterior wall material)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">KitchenQual</span></code> (kitchen quality)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SaleType</span></code> (sale type)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mode_fill_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;MasVnrType&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Electrical&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MSZoning&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="s">&quot;Utilities&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Functional&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Exterior1st&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="s">&quot;Exterior2nd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;KitchenQual&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SaleType&quot;</span><span class="p">)</span>

<span class="n">fill_mode</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">mode_value</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))[</span><span class="m">1</span><span class="p">]</span><span class="w">  </span><span class="c1"># get mode</span>
<span class="w">  </span><span class="nf">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">mode_value</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">train</span><span class="p">[</span><span class="n">mode_fill_features</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">mode_fill_features</span><span class="p">],</span><span class="w"> </span><span class="n">fill_mode</span><span class="p">)</span>
<span class="n">test</span><span class="p">[</span><span class="n">mode_fill_features</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">mode_fill_features</span><span class="p">],</span><span class="w"> </span><span class="n">fill_mode</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">NA</span></code> values for these variables may be missing values, and filling the median value can reduce the impact of outliers:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LotFrontage</span></code> (street frontage length)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">Neighborhood</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="n">LotFrontage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">LotFrontage</span><span class="p">),</span><span class="w"> </span><span class="nf">median</span><span class="p">(</span><span class="n">LotFrontage</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="n">LotFrontage</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ungroup</span><span class="p">()</span>

<span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">Neighborhood</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="n">LotFrontage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">LotFrontage</span><span class="p">),</span><span class="w"> </span><span class="nf">median</span><span class="p">(</span><span class="n">LotFrontage</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="n">LotFrontage</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ungroup</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Filled with 0 or 1 (integer feature)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BsmtFullBath</span></code>, <code class="docutils literal notranslate"><span class="pre">BsmtHalfBath</span></code> (basement bathrooms)</p></li>
</ul>
<p>If there is no basement, the number of bathrooms should be 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">bath_fill_features</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;BsmtFullBath&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BsmtHalfBath&quot;</span><span class="p">)</span>

<span class="n">train</span><span class="p">[</span><span class="n">bath_fill_features</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">bath_fill_features</span><span class="p">],</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">))</span>
<span class="n">test</span><span class="p">[</span><span class="n">bath_fill_features</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">bath_fill_features</span><span class="p">],</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Recheck <code class="docutils literal notranslate"><span class="pre">NA</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">na_train_after</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">check_na</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">na_test_after</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">check_na</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;After processing, missing values in Train Dataset:\n&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">na_train_after</span><span class="p">)</span>

<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\nAfter processing, missing values in Test Dataset:\n&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">na_test_after</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>After processing, missing values in Train Dataset:
[1] na_count
&lt;0 rows&gt; (or 0-length row.names)

After processing, missing values in Test Dataset:
[1] na_count
&lt;0 rows&gt; (or 0-length row.names)
</pre></div>
</div>
</div>
</div>
</section>
<section id="encoding">
<h3>Encoding<a class="headerlink" href="#encoding" title="Link to this heading">#</a></h3>
<section id="label-encoding">
<h4>Label Encoding<a class="headerlink" href="#label-encoding" title="Link to this heading">#</a></h4>
<p>Although we previously converted all features that type is <code class="docutils literal notranslate"><span class="pre">chr</span></code> to <code class="docutils literal notranslate"><span class="pre">fct</span></code>. However, when you convert a feature to a factor in R, the levels are automatically assigned based on lexicographic (alphabetical/numeric) order, unless specified otherwise. For example, the default order of <code class="docutils literal notranslate"><span class="pre">factor(c(&quot;Good&quot;,</span> <span class="pre">&quot;Bad&quot;,</span> <span class="pre">&quot;Excellent&quot;))</span></code> is: <code class="docutils literal notranslate"><span class="pre">Bad</span></code> â†’ <code class="docutils literal notranslate"><span class="pre">Excellent</span></code> â†’ <code class="docutils literal notranslate"><span class="pre">Good</span></code> (alphabetical). If our categorical feature represents a ranking (e.g., <code class="docutils literal notranslate"><span class="pre">Ex</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Gd</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">TA</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Fa</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Po</span></code>), incorrect ordering will mislead models that rely on factor levels (e.g., linear regression, decision trees). Therefore, to be on the safe side, we need to perform manual Label Encoding at this time to confirm again that our preprocessing of <code class="docutils literal notranslate"><span class="pre">ordinal_features</span></code> is correct.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">factor_levels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span>
<span class="w">  </span><span class="c1"># Basement Quality (higher is better)</span>
<span class="w">  </span><span class="n">BsmtQual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Po&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fa&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Ex&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Basement Condition (higher is better)</span>
<span class="w">  </span><span class="n">BsmtCond</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Po&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fa&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Ex&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Basement Exposure (higher means more exposure to outside)</span>
<span class="w">  </span><span class="n">BsmtExposure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;No&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Mn&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Av&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gd&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Basement Finishing Type (higher is more finished)</span>
<span class="w">  </span><span class="n">BsmtFinType1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Unf&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;LwQ&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Rec&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BLQ&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ALQ&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GLQ&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="n">BsmtFinType2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Unf&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;LwQ&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Rec&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BLQ&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ALQ&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GLQ&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Heating Quality (higher is better)</span>
<span class="w">  </span><span class="n">HeatingQC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Po&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fa&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Ex&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Kitchen Quality (higher is better)</span>
<span class="w">  </span><span class="n">KitchenQual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Po&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fa&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Ex&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Functional Condition of House</span>
<span class="w">  </span><span class="n">Functional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Sal&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Sev&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Maj2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Maj1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Mod&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Min2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Min1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Typ&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Fireplace Quality (higher is better)</span>
<span class="w">  </span><span class="n">FireplaceQu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Po&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fa&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Ex&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Garage Finish (higher is more finished)</span>
<span class="w">  </span><span class="n">GarageFinish</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Unf&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;RFn&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fin&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Garage Quality (higher is better)</span>
<span class="w">  </span><span class="n">GarageQual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Po&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fa&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Ex&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Garage Condition (higher is better)</span>
<span class="w">  </span><span class="n">GarageCond</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Po&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fa&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Ex&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Paved Driveway (Y = Paved, P = Partial, N = Dirt/Gravel)</span>
<span class="w">  </span><span class="n">PavedDrive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;N&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;P&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Y&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Pool Quality (higher is better)</span>
<span class="w">  </span><span class="n">PoolQC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fa&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Ex&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Fence Quality (higher means better privacy/security)</span>
<span class="w">  </span><span class="n">Fence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MnWw&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GdWo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MnPrv&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GdPrv&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Sale Condition (Normal is typical)</span>
<span class="w">  </span><span class="n">SaleCondition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;AdjLand&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Alloca&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Family&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Normal&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Abnorml&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Partial&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Lot Shape (Regular is the best)</span>
<span class="w">  </span><span class="n">LotShape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;IR3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IR2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;IR1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Reg&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Land Slope (Gtl = gentle slope, best)</span>
<span class="w">  </span><span class="n">LandSlope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Sev&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Mod&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Gtl&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># MSSubClass (Type of dwelling, as a categorical feature)</span>
<span class="w">  </span><span class="n">MSSubClass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;20&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;30&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;40&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;45&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;50&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;60&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;70&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;75&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;80&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;85&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                 </span><span class="s">&quot;90&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;120&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;150&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;160&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;180&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;190&quot;</span><span class="p">),</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Overall Quality (numeric but treated as an ordinal feature)</span>
<span class="w">  </span><span class="n">OverallQual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">),</span><span class="w">  </span><span class="c1"># 1 (Worst) to 10 (Best)</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1"># Overall Condition (numeric but treated as an ordinal feature)</span>
<span class="w">  </span><span class="n">OverallCond</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span><span class="w">   </span><span class="c1"># 1 (Poor) to 10 (Excellent)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">for </span><span class="p">(</span><span class="n">feature</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">factor_levels</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">train</span><span class="p">[[</span><span class="n">feature</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">train</span><span class="p">[[</span><span class="n">feature</span><span class="p">]],</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor_levels</span><span class="p">[[</span><span class="n">feature</span><span class="p">]])</span>
<span class="w">  </span><span class="n">test</span><span class="p">[[</span><span class="n">feature</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">test</span><span class="p">[[</span><span class="n">feature</span><span class="p">]],</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor_levels</span><span class="p">[[</span><span class="n">feature</span><span class="p">]])</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Tree models such as Random Forest (RF), XGBoost, LightGBM, and CatBoost can directly process raw categorical data, so performance may be reduced due to unnecessary preprocessing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tree_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">tree_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="one-hot-encoding">
<h4>One-Hot Encoding<a class="headerlink" href="#one-hot-encoding" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure test dataset has the same factor levels as train</span>
<span class="nf">for </span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">categorical_features</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">if </span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">test</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">test</span><span class="p">[[</span><span class="n">col</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">test</span><span class="p">[[</span><span class="n">col</span><span class="p">]],</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">levels</span><span class="p">(</span><span class="n">train</span><span class="p">[[</span><span class="n">col</span><span class="p">]]))</span><span class="w"> </span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Apply One-Hot Encoding using predefined categorical_features</span>
<span class="n">ohe</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">dummyVars</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="p">[,</span><span class="w"> </span><span class="n">categorical_features</span><span class="p">])</span>

<span class="c1"># Apply transformation to train and test sets</span>
<span class="n">train_ohe</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">ohe</span><span class="p">,</span><span class="w"> </span><span class="n">train</span><span class="p">)</span>
<span class="n">test_ohe</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">ohe</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="p">)</span>

<span class="c1"># Merge transformed categorical features with numerical features</span>
<span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">train</span><span class="p">[,</span><span class="w"> </span><span class="n">numerical_features</span><span class="p">],</span><span class="w"> </span><span class="n">train_ohe</span><span class="p">,</span><span class="w"> </span><span class="n">SalePrice_log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="o">$</span><span class="n">SalePrice_log</span><span class="p">)</span>
<span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">test</span><span class="p">[,</span><span class="w"> </span><span class="n">numerical_features</span><span class="p">],</span><span class="w"> </span><span class="n">test_ohe</span><span class="p">)</span>

<span class="c1"># Ensure all variables are numeric</span>
<span class="nf">str</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;data.frame&#39;:	1460 obs. of  344 variables:
 $ LotFrontage          : num  65 80 68 60 84 85 75 80 51 50 ...
 $ LotArea              : num  8450 9600 11250 9550 14260 ...
 $ YearBuilt            : num  2003 1976 2001 1915 2000 ...
 $ YearRemodAdd         : num  2003 1976 2002 1970 2000 ...
 $ MasVnrArea           : num  196 0 162 0 350 0 186 240 0 0 ...
 $ BsmtFinSF1           : num  706 978 486 216 655 ...
 $ BsmtFinSF2           : num  0 0 0 0 0 0 0 32 0 0 ...
 $ BsmtUnfSF            : num  150 284 434 540 490 64 317 216 952 140 ...
 $ TotalBsmtSF          : num  856 1262 920 756 1145 ...
 $ 1stFlrSF             : num  856 1262 920 961 1145 ...
 $ 2ndFlrSF             : num  854 0 866 756 1053 ...
 $ LowQualFinSF         : num  0 0 0 0 0 0 0 0 0 0 ...
 $ GrLivArea            : num  1710 1262 1786 1717 2198 ...
 $ BsmtFullBath         : num  1 0 1 1 1 1 1 1 0 1 ...
 $ BsmtHalfBath         : num  0 1 0 0 0 0 0 0 0 0 ...
 $ FullBath             : num  2 2 2 1 2 1 2 2 2 1 ...
 $ HalfBath             : num  1 0 1 0 1 1 0 1 0 0 ...
 $ BedroomAbvGr         : num  3 3 3 3 4 1 3 3 2 2 ...
 $ KitchenAbvGr         : num  1 1 1 1 1 1 1 1 2 2 ...
 $ TotRmsAbvGrd         : num  8 6 6 7 9 5 7 7 8 5 ...
 $ Fireplaces           : num  0 1 1 1 1 0 1 2 2 2 ...
 $ GarageYrBlt          : num  2003 1976 2001 1998 2000 ...
 $ GarageCars           : num  2 2 2 3 3 2 2 2 2 1 ...
 $ GarageArea           : num  548 460 608 642 836 480 636 484 468 205 ...
 $ WoodDeckSF           : num  0 298 0 0 192 40 255 235 90 0 ...
 $ OpenPorchSF          : num  61 0 42 35 84 30 57 204 0 4 ...
 $ EnclosedPorch        : num  0 0 0 272 0 0 0 228 205 0 ...
 $ 3SsnPorch            : num  0 0 0 0 0 320 0 0 0 0 ...
 $ ScreenPorch          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ PoolArea             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MiscVal              : num  0 0 0 0 0 700 0 350 0 0 ...
 $ MoSold               : num  2 5 9 2 12 10 8 11 4 1 ...
 $ YrSold               : num  2008 2007 2008 2006 2008 ...
 $ HouseAge             : num  5 31 7 91 8 16 3 36 77 69 ...
 $ RemodelAge           : num  5 31 6 36 8 14 2 36 58 58 ...
 $ TotalSF              : num  2566 2524 2706 2473 3343 ...
 $ MSSubClass.20        : num  0 1 0 0 0 0 1 0 0 0 ...
 $ MSSubClass.30        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSSubClass.40        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSSubClass.45        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSSubClass.50        : num  0 0 0 0 0 1 0 0 1 0 ...
 $ MSSubClass.60        : num  1 0 1 0 1 0 0 1 0 0 ...
 $ MSSubClass.70        : num  0 0 0 1 0 0 0 0 0 0 ...
 $ MSSubClass.75        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSSubClass.80        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSSubClass.85        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSSubClass.90        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSSubClass.120       : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSSubClass.150       : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSSubClass.160       : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSSubClass.180       : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSSubClass.190       : num  0 0 0 0 0 0 0 0 0 1 ...
 $ MSZoning.C (all)     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSZoning.FV          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSZoning.RH          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ MSZoning.RL          : num  1 1 1 1 1 1 1 1 0 1 ...
 $ MSZoning.RM          : num  0 0 0 0 0 0 0 0 1 0 ...
 $ Street.Grvl          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Street.Pave          : num  1 1 1 1 1 1 1 1 1 1 ...
 $ Alley.None           : num  1 1 1 1 1 1 1 1 1 1 ...
 $ Alley.Grvl           : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Alley.Pave           : num  0 0 0 0 0 0 0 0 0 0 ...
 $ LotShape.IR3         : num  0 0 0 0 0 0 0 0 0 0 ...
 $ LotShape.IR2         : num  0 0 0 0 0 0 0 0 0 0 ...
 $ LotShape.IR1         : num  0 0 1 1 1 1 0 1 0 0 ...
 $ LotShape.Reg         : num  1 1 0 0 0 0 1 0 1 1 ...
 $ LandContour.Bnk      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ LandContour.HLS      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ LandContour.Low      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ LandContour.Lvl      : num  1 1 1 1 1 1 1 1 1 1 ...
 $ Utilities.AllPub     : num  1 1 1 1 1 1 1 1 1 1 ...
 $ Utilities.NoSeWa     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ LotConfig.Corner     : num  0 0 0 1 0 0 0 1 0 1 ...
 $ LotConfig.CulDSac    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ LotConfig.FR2        : num  0 1 0 0 1 0 0 0 0 0 ...
 $ LotConfig.FR3        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ LotConfig.Inside     : num  1 0 1 0 0 1 1 0 1 0 ...
 $ LandSlope.Sev        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ LandSlope.Mod        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ LandSlope.Gtl        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ Neighborhood.Blmngtn : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Neighborhood.Blueste : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Neighborhood.BrDale  : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Neighborhood.BrkSide : num  0 0 0 0 0 0 0 0 0 1 ...
 $ Neighborhood.ClearCr : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Neighborhood.CollgCr : num  1 0 1 0 0 0 0 0 0 0 ...
 $ Neighborhood.Crawfor : num  0 0 0 1 0 0 0 0 0 0 ...
 $ Neighborhood.Edwards : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Neighborhood.Gilbert : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Neighborhood.IDOTRR  : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Neighborhood.MeadowV : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Neighborhood.Mitchel : num  0 0 0 0 0 1 0 0 0 0 ...
 $ Neighborhood.NAmes   : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Neighborhood.NoRidge : num  0 0 0 0 1 0 0 0 0 0 ...
 $ Neighborhood.NPkVill : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Neighborhood.NridgHt : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Neighborhood.NWAmes  : num  0 0 0 0 0 0 0 1 0 0 ...
 $ Neighborhood.OldTown : num  0 0 0 0 0 0 0 0 1 0 ...
 $ Neighborhood.Sawyer  : num  0 0 0 0 0 0 0 0 0 0 ...
  [list output truncated]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count the minimum and maximum values of each column</span>
<span class="n">zero_vars</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">train</span><span class="p">)[</span><span class="nf">sapply</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="nf">all</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))]</span>

<span class="c1"># Print all columns that are all zeros</span>
<span class="nf">print</span><span class="p">(</span><span class="n">zero_vars</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;MSSubClass.150&quot; &quot;BsmtQual.Po&quot;    &quot;BsmtCond.Ex&quot;    &quot;KitchenQual.Po&quot;
[5] &quot;Functional.Sal&quot; &quot;PoolQC.TA&quot;      &quot;OverallCond.10&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># If there are all zero columns, remove them</span>
<span class="nf">if </span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">zero_vars</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="nf">all_of</span><span class="p">(</span><span class="n">zero_vars</span><span class="p">))</span>
<span class="w">  </span><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="nf">all_of</span><span class="p">(</span><span class="n">zero_vars</span><span class="p">))</span><span class="w">  </span><span class="c1"># Make sure test is also synchronized</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="normalize-data-standard-scaling">
<h3>Normalize Data (Standard Scaling)<a class="headerlink" href="#normalize-data-standard-scaling" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply Standard Scaling (Z-score normalization)</span>
<span class="n">scaler</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">preProcess</span><span class="p">(</span><span class="n">train</span><span class="p">[,</span><span class="w"> </span><span class="n">numerical_features</span><span class="p">],</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;center&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;scale&quot;</span><span class="p">))</span>

<span class="c1"># Normalize train and test datasets</span>
<span class="n">train</span><span class="p">[,</span><span class="w"> </span><span class="n">numerical_features</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span><span class="w"> </span><span class="n">train</span><span class="p">[,</span><span class="w"> </span><span class="n">numerical_features</span><span class="p">])</span>
<span class="n">test</span><span class="p">[,</span><span class="w"> </span><span class="n">numerical_features</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="p">[,</span><span class="w"> </span><span class="n">numerical_features</span><span class="p">])</span>

<span class="c1"># Check summary to confirm scaling</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">train</span><span class="p">[,</span><span class="w"> </span><span class="n">numerical_features</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  LotFrontage           LotArea          YearBuilt         YearRemodAdd    
 Min.   :-2.193290   Min.   :-0.9234   Min.   :-3.28670   Min.   :-1.6888  
 1st Qu.:-0.454694   1st Qu.:-0.2969   1st Qu.:-0.57173   1st Qu.:-0.8654  
 Median :-0.008901   Median :-0.1040   Median : 0.05735   Median : 0.4424  
 Mean   : 0.000000   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000  
 3rd Qu.: 0.436893   3rd Qu.: 0.1087   3rd Qu.: 0.95131   3rd Qu.: 0.9268  
 Max.   :10.823886   Max.   :20.5112   Max.   : 1.28240   Max.   : 1.2174  
   MasVnrArea        BsmtFinSF1        BsmtFinSF2        BsmtUnfSF      
 Min.   :-0.5706   Min.   :-0.9727   Min.   :-0.2886   Min.   :-1.2837  
 1st Qu.:-0.5706   1st Qu.:-0.9727   1st Qu.:-0.2886   1st Qu.:-0.7791  
 Median :-0.5706   Median :-0.1319   Median :-0.2886   Median :-0.2031  
 Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  
 3rd Qu.: 0.3383   3rd Qu.: 0.5889   3rd Qu.:-0.2886   3rd Qu.: 0.5449  
 Max.   : 8.2824   Max.   :11.4018   Max.   : 8.8486   Max.   : 4.0029  
  TotalBsmtSF         1stFlrSF          2ndFlrSF        LowQualFinSF    
 Min.   :-2.4103   Min.   :-2.1434   Min.   :-0.7949   Min.   :-0.1202  
 1st Qu.:-0.5965   1st Qu.:-0.7259   1st Qu.:-0.7949   1st Qu.:-0.1202  
 Median :-0.1503   Median :-0.1956   Median :-0.7949   Median :-0.1202  
 Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  
 3rd Qu.: 0.5489   3rd Qu.: 0.5914   3rd Qu.: 0.8728   3rd Qu.:-0.1202  
 Max.   :11.5170   Max.   : 9.1296   Max.   : 3.9356   Max.   :11.6438  
   GrLivArea         BsmtFullBath      BsmtHalfBath       FullBath      
 Min.   :-2.24835   Min.   :-0.8197   Min.   :-0.241   Min.   :-2.8408  
 1st Qu.:-0.73450   1st Qu.:-0.8197   1st Qu.:-0.241   1st Qu.:-1.0257  
 Median :-0.09794   Median :-0.8197   Median :-0.241   Median : 0.7895  
 Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.000   Mean   : 0.0000  
 3rd Qu.: 0.49723   3rd Qu.: 1.1074   3rd Qu.:-0.241   3rd Qu.: 0.7895  
 Max.   : 7.85288   Max.   : 4.9617   Max.   : 8.136   Max.   : 2.6046  
    HalfBath        BedroomAbvGr      KitchenAbvGr      TotRmsAbvGrd    
 Min.   :-0.7614   Min.   :-3.5137   Min.   :-4.7499   Min.   :-2.7795  
 1st Qu.:-0.7614   1st Qu.:-1.0621   1st Qu.:-0.2114   1st Qu.:-0.9338  
 Median :-0.7614   Median : 0.1637   Median :-0.2114   Median :-0.3186  
 Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  
 3rd Qu.: 1.2272   3rd Qu.: 0.1637   3rd Qu.:-0.2114   3rd Qu.: 0.2967  
 Max.   : 3.2157   Max.   : 6.2928   Max.   : 8.8656   Max.   : 4.6033  
   Fireplaces       GarageYrBlt        GarageCars        GarageArea      
 Min.   :-0.9509   Min.   :-4.1189   Min.   :-2.3646   Min.   :-2.21220  
 1st Qu.:-0.9509   1st Qu.: 0.1967   1st Qu.:-1.0265   1st Qu.:-0.64769  
 Median : 0.6003   Median : 0.2386   Median : 0.3116   Median : 0.03283  
 Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.00000  
 3rd Qu.: 0.6003   3rd Qu.: 0.2915   3rd Qu.: 0.3116   3rd Qu.: 0.48184  
 Max.   : 3.7027   Max.   : 0.3114   Max.   : 2.9879   Max.   : 4.42001  
   WoodDeckSF       OpenPorchSF      EnclosedPorch       3SsnPorch      
 Min.   :-0.7519   Min.   :-0.7042   Min.   :-0.3592   Min.   :-0.1163  
 1st Qu.:-0.7519   1st Qu.:-0.7042   1st Qu.:-0.3592   1st Qu.:-0.1163  
 Median :-0.7519   Median :-0.3269   Median :-0.3592   Median :-0.1163  
 Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  
 3rd Qu.: 0.5884   3rd Qu.: 0.3221   3rd Qu.:-0.3592   3rd Qu.:-0.1163  
 Max.   : 6.0855   Max.   : 7.5516   Max.   : 8.6723   Max.   :17.2113  
  ScreenPorch         PoolArea           MiscVal             MoSold       
 Min.   :-0.2701   Min.   :-0.06867   Min.   :-0.08766   Min.   :-1.9684  
 1st Qu.:-0.2701   1st Qu.:-0.06867   1st Qu.:-0.08766   1st Qu.:-0.4889  
 Median :-0.2701   Median :-0.06867   Median :-0.08766   Median :-0.1191  
 Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.0000  
 3rd Qu.:-0.2701   3rd Qu.:-0.06867   3rd Qu.:-0.08766   3rd Qu.: 0.6207  
 Max.   : 8.3386   Max.   :18.29991   Max.   :31.15459   Max.   : 2.1002  
     YrSold           HouseAge          RemodelAge         TotalSF       
 Min.   :-1.3672   Min.   :-1.20819   Min.   :-1.1603   Min.   :-2.7175  
 1st Qu.:-0.6142   1st Qu.:-0.94373   1st Qu.:-0.9181   1st Qu.:-0.6785  
 Median : 0.1387   Median :-0.05117   Median :-0.4336   Median :-0.1132  
 Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.0000  
 3rd Qu.: 0.8917   3rd Qu.: 0.57693   3rd Qu.: 0.8745   3rd Qu.: 0.5318  
 Max.   : 1.6446   Max.   : 3.28765   Max.   : 1.7950   Max.   :11.1778  
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="modeling">
<h2>Modeling<a class="headerlink" href="#modeling" title="Link to this heading">#</a></h2>
<section id="knn">
<h3>kNN<a class="headerlink" href="#knn" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define training control</span>
<span class="n">control</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">trainControl</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;cv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>

<span class="c1"># Train KNN model (search for best k from 3 to 20)</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">knn_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="n">SalePrice_log</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span>
<span class="w">                   </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="p">,</span>
<span class="w">                   </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;knn&quot;</span><span class="p">,</span>
<span class="w">                   </span><span class="n">trControl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">control</span><span class="p">,</span>
<span class="w">                   </span><span class="n">tuneGrid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expand.grid</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">knn_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k-Nearest Neighbors 

1460 samples
 336 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 1169, 1169, 1167, 1168, 1167 
Resampling results across tuning parameters:

  k   RMSE       Rsquared   MAE      
   2  0.1845686  0.7900069  0.1276179
   4  0.1792032  0.8048398  0.1211112
   6  0.1758587  0.8133593  0.1193890
   8  0.1755424  0.8161537  0.1199109
  10  0.1743246  0.8207036  0.1192279
  12  0.1732819  0.8249960  0.1188608
  14  0.1733588  0.8257621  0.1195074
  16  0.1735761  0.8261160  0.1197313
  18  0.1740578  0.8256934  0.1201630
  20  0.1741199  0.8273405  0.1204882

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was k = 12.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">knn_model</span><span class="p">,</span>
<span class="w">     </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.25</span><span class="p">,</span>
<span class="w">     </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.75</span><span class="p">,</span>
<span class="w">     </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/7efaa6e96abfe312ea37b312a717422adf92ff99981af4cedefa00cbb712bb5e.png"><img alt="../_images/7efaa6e96abfe312ea37b312a717422adf92ff99981af4cedefa00cbb712bb5e.png" src="../_images/7efaa6e96abfe312ea37b312a717422adf92ff99981af4cedefa00cbb712bb5e.png" style="width: 720px; height: 480px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">knn_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">knn_model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">)</span>
<span class="n">knn_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">knn_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># revert log-transform</span>

<span class="n">knn_submission</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span>
<span class="w">  </span><span class="n">SalePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">knn_predictions</span>
<span class="p">)</span>

<span class="n">save_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;processed(r)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;knn(r).csv&quot;</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="n">knn_submission</span><span class="p">,</span><span class="w"> </span><span class="n">save_dir</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="svm">
<h3>SVM<a class="headerlink" href="#svm" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train SVM model with radial basis function (RBF) kernel</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">svm_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="n">SalePrice_log</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;svmRadial&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="n">trControl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">control</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="n">tuneLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w">  </span><span class="c1"># Automatically searches for best parameters</span>
<span class="w">                   </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here we set <code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">=</span> <span class="pre">FALSE</span></code> because we have manually normalized <code class="docutils literal notranslate"><span class="pre">numerical_features</span></code> in the previous preprocessing stage. In order to avoid SVM to repeat the normalization of the extra columns generated by our one-hot encoding, we need to turn off its scale function here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">svm_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Support Vector Machines with Radial Basis Function Kernel 

1460 samples
 336 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 1169, 1169, 1167, 1168, 1167 
Resampling results across tuning parameters:

  C       RMSE       Rsquared   MAE       
    0.25  0.1400580  0.8793136  0.09348299
    0.50  0.1332413  0.8900571  0.08837307
    1.00  0.1290501  0.8962326  0.08551372
    2.00  0.1262895  0.9005448  0.08413747
    4.00  0.1250289  0.9023650  0.08437091
    8.00  0.1267093  0.8999574  0.08680582
   16.00  0.1295349  0.8962134  0.08979895
   32.00  0.1332403  0.8906846  0.09331982
   64.00  0.1367442  0.8850155  0.09608184
  128.00  0.1374458  0.8838847  0.09664535

Tuning parameter &#39;sigma&#39; was held constant at a value of 0.002345221
RMSE was used to select the optimal model using the smallest value.
The final values used for the model were sigma = 0.002345221 and C = 4.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">svm_model</span><span class="p">,</span>
<span class="w">     </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.25</span><span class="p">,</span>
<span class="w">     </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.75</span><span class="p">,</span>
<span class="w">     </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/7217e6811f735e5a672df8a9457ca4ebd03da7192b7d14246da34ceab7ec75e5.png"><img alt="../_images/7217e6811f735e5a672df8a9457ca4ebd03da7192b7d14246da34ceab7ec75e5.png" src="../_images/7217e6811f735e5a672df8a9457ca4ebd03da7192b7d14246da34ceab7ec75e5.png" style="width: 720px; height: 480px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">svm_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">svm_model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">)</span>
<span class="n">svm_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">svm_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># revert log-transform</span>

<span class="n">svm_submission</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span>
<span class="w">  </span><span class="n">SalePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">svm_predictions</span>
<span class="p">)</span>

<span class="n">save_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;processed(r)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;svm(r).csv&quot;</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="n">svm_submission</span><span class="p">,</span><span class="w"> </span><span class="n">save_dir</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="linear-regression">
<h3>Linear Regression<a class="headerlink" href="#linear-regression" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train Linear Regression model</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">lr_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="n">SalePrice_log</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span>
<span class="w">                  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="p">,</span><span class="w"> </span>
<span class="w">                  </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lm&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                  </span><span class="n">trControl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">control</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in predict.lm(modelFit, newdata):
&quot;prediction from rank-deficient fit; attr(*, &quot;non-estim&quot;) has doubtful cases&quot;
Warning message in predict.lm(modelFit, newdata):
&quot;prediction from rank-deficient fit; attr(*, &quot;non-estim&quot;) has doubtful cases&quot;
Warning message in predict.lm(modelFit, newdata):
&quot;prediction from rank-deficient fit; attr(*, &quot;non-estim&quot;) has doubtful cases&quot;
Warning message in predict.lm(modelFit, newdata):
&quot;prediction from rank-deficient fit; attr(*, &quot;non-estim&quot;) has doubtful cases&quot;
Warning message in predict.lm(modelFit, newdata):
&quot;prediction from rank-deficient fit; attr(*, &quot;non-estim&quot;) has doubtful cases&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">lr_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression 

1460 samples
 336 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 1169, 1169, 1167, 1168, 1167 
Resampling results:

  RMSE       Rsquared   MAE       
  0.1659552  0.8347659  0.09375622

Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">lr_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">lr_model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">)</span>
<span class="n">lr_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">lr_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># revert log-transform</span>

<span class="n">lr_submission</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span>
<span class="w">  </span><span class="n">SalePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lr_predictions</span>
<span class="p">)</span>

<span class="n">save_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;processed(r)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lr(r).csv&quot;</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="n">lr_submission</span><span class="p">,</span><span class="w"> </span><span class="n">save_dir</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in predict.lm(modelFit, newdata):
&quot;prediction from rank-deficient fit; attr(*, &quot;non-estim&quot;) has doubtful cases&quot;
</pre></div>
</div>
</div>
</div>
</section>
<section id="lasso">
<h3>Lasso<a class="headerlink" href="#lasso" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert train and test to matrices for glmnet</span>
<span class="n">x_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">train</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="n">SalePrice_log</span><span class="p">))</span>
<span class="n">y_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">train</span><span class="o">$</span><span class="n">SalePrice_log</span>
<span class="n">x_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train Lasso Regression (alpha = 1)</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">lasso_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cv.glmnet</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="w"> </span><span class="n">y_train</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">lasso_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:  cv.glmnet(x = x_train, y = y_train, alpha = 1) 

Measure: Mean-Squared Error 

      Lambda Index Measure       SE Nonzero
min 0.005178    45 0.02198 0.005656     105
1se 0.020902    30 0.02708 0.005587      39
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">lasso_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/065a4f09efafaeed62a9e4b8a5f147fab3333c91fa393138da4e2585d1ef07b8.png"><img alt="../_images/065a4f09efafaeed62a9e4b8a5f147fab3333c91fa393138da4e2585d1ef07b8.png" src="../_images/065a4f09efafaeed62a9e4b8a5f147fab3333c91fa393138da4e2585d1ef07b8.png" style="width: 720px; height: 480px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">lasso_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">lasso_model</span><span class="p">,</span><span class="w"> </span><span class="n">newx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lambda.min&quot;</span><span class="p">)</span>
<span class="n">lasso_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">lasso_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># revert log-transform</span>

<span class="n">lasso_submission</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span>
<span class="w">  </span><span class="n">SalePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.vector</span><span class="p">(</span><span class="n">lasso_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># avoid including column names</span>
<span class="p">)</span>

<span class="n">save_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;processed(r)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lasso(r).csv&quot;</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="n">lasso_submission</span><span class="p">,</span><span class="w"> </span><span class="n">save_dir</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="ridge">
<h3>Ridge<a class="headerlink" href="#ridge" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train Ridge Regression (alpha = 0)</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">ridge_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cv.glmnet</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="w"> </span><span class="n">y_train</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">ridge_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:  cv.glmnet(x = x_train, y = y_train, alpha = 0) 

Measure: Mean-Squared Error 

    Lambda Index Measure       SE Nonzero
min 0.2403    78 0.02060 0.003955     336
1se 1.0648    62 0.02413 0.002847     336
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">ridge_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/bb7425375abe1ea87bb32555c6377baa292f8e9090842d7d9c0f4235e7d7d250.png"><img alt="../_images/bb7425375abe1ea87bb32555c6377baa292f8e9090842d7d9c0f4235e7d7d250.png" src="../_images/bb7425375abe1ea87bb32555c6377baa292f8e9090842d7d9c0f4235e7d7d250.png" style="width: 720px; height: 480px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">ridge_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">ridge_model</span><span class="p">,</span><span class="w"> </span><span class="n">newx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lambda.min&quot;</span><span class="p">)</span>
<span class="n">ridge_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">ridge_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># revert log-transform</span>

<span class="n">ridge_submission</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span>
<span class="w">  </span><span class="n">SalePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.vector</span><span class="p">(</span><span class="n">ridge_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># avoid including column names</span>
<span class="p">)</span>

<span class="n">save_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;processed(r)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ridge(r).csv&quot;</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="n">ridge_submission</span><span class="p">,</span><span class="w"> </span><span class="n">save_dir</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="elasticnet">
<h3>ElasticNet<a class="headerlink" href="#elasticnet" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train Elastic Net (alpha = 0.5)</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">elastic_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cv.glmnet</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="w"> </span><span class="n">y_train</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">elastic_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:  cv.glmnet(x = x_train, y = y_train, alpha = 0.5) 

Measure: Mean-Squared Error 

     Lambda Index Measure       SE Nonzero
min 0.01136    44 0.02169 0.005466     108
1se 0.04180    30 0.02646 0.005162      45
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">elastic_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/d807215a79e3750fc45f7860b9263ad89a69cc717f1cceaa800bfed2d7daba8e.png"><img alt="../_images/d807215a79e3750fc45f7860b9263ad89a69cc717f1cceaa800bfed2d7daba8e.png" src="../_images/d807215a79e3750fc45f7860b9263ad89a69cc717f1cceaa800bfed2d7daba8e.png" style="width: 720px; height: 480px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">elastic_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">elastic_model</span><span class="p">,</span><span class="w"> </span><span class="n">newx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lambda.min&quot;</span><span class="p">)</span>
<span class="n">elastic_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">elastic_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># revert log-transform</span>

<span class="n">elastic_submission</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span>
<span class="w">  </span><span class="n">SalePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.vector</span><span class="p">(</span><span class="n">elastic_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># avoid including column names</span>
<span class="p">)</span>

<span class="n">save_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;processed(r)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;elastic(r).csv&quot;</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="n">elastic_submission</span><span class="p">,</span><span class="w"> </span><span class="n">save_dir</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="decision-tree">
<h3>Decision Tree<a class="headerlink" href="#decision-tree" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train Decision Tree</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">dt_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_train</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="n">SalePrice_log</span><span class="p">),</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_train</span><span class="o">$</span><span class="n">SalePrice_log</span><span class="p">,</span>
<span class="w">  </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;rpart&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">trControl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">control</span><span class="p">,</span>
<span class="w">  </span><span class="n">tuneGrid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expand.grid</span><span class="p">(</span><span class="n">cp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">0.0001</span><span class="p">,</span><span class="w"> </span><span class="m">0.0005</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">))</span><span class="w"> </span><span class="c1"># More detailed search</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">dt_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CART 

1460 samples
  82 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 1169, 1169, 1167, 1168, 1167 
Resampling results across tuning parameters:

  cp            RMSE       Rsquared   MAE      
  0.0001000000  0.1776512  0.8045802  0.1284635
  0.0001444444  0.1777805  0.8042541  0.1285073
  0.0001888889  0.1779049  0.8039320  0.1285442
  0.0002333333  0.1777713  0.8041841  0.1279156
  0.0002777778  0.1779330  0.8037993  0.1282692
  0.0003222222  0.1778216  0.8038857  0.1283249
  0.0003666667  0.1777085  0.8041335  0.1280759
  0.0004111111  0.1775049  0.8045104  0.1281117
  0.0004555556  0.1775586  0.8043727  0.1283061
  0.0005000000  0.1779052  0.8034988  0.1283916

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was cp = 0.0004111111.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">dt_model</span><span class="p">,</span>
<span class="w">     </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.25</span><span class="p">,</span>
<span class="w">     </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.75</span><span class="p">,</span>
<span class="w">     </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/5926b832aae4de8ab7da40dab0d2660cd38eed638e0a0815b8ac5c7f436a0815.png"><img alt="../_images/5926b832aae4de8ab7da40dab0d2660cd38eed638e0a0815b8ac5c7f436a0815.png" src="../_images/5926b832aae4de8ab7da40dab0d2660cd38eed638e0a0815b8ac5c7f436a0815.png" style="width: 720px; height: 480px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">dt_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">dt_model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_test</span><span class="p">)</span>
<span class="n">dt_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">dt_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># revert log-transform</span>

<span class="n">dt_submission</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span>
<span class="w">  </span><span class="n">SalePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt_predictions</span>
<span class="p">)</span>

<span class="n">save_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;processed(r)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;dt(r).csv&quot;</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="n">dt_submission</span><span class="p">,</span><span class="w"> </span><span class="n">save_dir</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="bagging">
<h3>Bagging<a class="headerlink" href="#bagging" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train Bagging model (explicit feature selection)</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">bagging_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_train</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="n">SalePrice_log</span><span class="p">),</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_train</span><span class="o">$</span><span class="n">SalePrice_log</span><span class="p">,</span>
<span class="w">  </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;treebag&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">trControl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">control</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">bagging_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bagged CART 

1460 samples
  82 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 1169, 1169, 1167, 1168, 1167 
Resampling results:

  RMSE       Rsquared   MAE     
  0.1731034  0.8162952  0.123942
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">bagging_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">bagging_model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_test</span><span class="p">)</span>
<span class="n">bagging_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">bagging_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># revert log-transform</span>

<span class="n">bagging_submission</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span>
<span class="w">  </span><span class="n">SalePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bagging_predictions</span>
<span class="p">)</span>

<span class="n">save_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;processed(r)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;bagging(r).csv&quot;</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="n">bagging_submission</span><span class="p">,</span><span class="w"> </span><span class="n">save_dir</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="random-forest">
<h3>Random Forest<a class="headerlink" href="#random-forest" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train Random Forest model</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">rf_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="n">SalePrice_log</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span>
<span class="w">                  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_train</span><span class="p">,</span><span class="w"> </span>
<span class="w">                  </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;rf&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                  </span><span class="n">trControl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">control</span><span class="p">,</span>
<span class="w">                  </span><span class="n">tuneGrid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expand.grid</span><span class="p">(</span><span class="n">mtry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="m">32</span><span class="p">,</span><span class="w"> </span><span class="m">64</span><span class="p">)),</span><span class="w"> </span>
<span class="w">                  </span><span class="n">ntree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">)</span><span class="w">  </span><span class="c1"># Optimize mtry and use 500 trees</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">rf_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random Forest 

1460 samples
  82 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 1169, 1169, 1167, 1168, 1167 
Resampling results across tuning parameters:

  mtry  RMSE       Rsquared   MAE       
   2    0.2249974  0.8100716  0.15743714
   4    0.1770039  0.8484972  0.11895918
   8    0.1544689  0.8719228  0.10174286
  16    0.1462462  0.8785325  0.09590145
  32    0.1427482  0.8800158  0.09394998
  64    0.1418422  0.8785970  0.09393652

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was mtry = 64.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">rf_model</span><span class="p">,</span>
<span class="w">     </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.25</span><span class="p">,</span>
<span class="w">     </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.75</span><span class="p">,</span>
<span class="w">     </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/3dc953edc0c7b00b82051379640850ed4aae100e0908115b9f359b8fae11687f.png"><img alt="../_images/3dc953edc0c7b00b82051379640850ed4aae100e0908115b9f359b8fae11687f.png" src="../_images/3dc953edc0c7b00b82051379640850ed4aae100e0908115b9f359b8fae11687f.png" style="width: 720px; height: 480px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">rf_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">rf_model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_test</span><span class="p">)</span>
<span class="n">rf_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">rf_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># revert log-transform</span>

<span class="n">rf_submission</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span>
<span class="w">  </span><span class="n">SalePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rf_predictions</span>
<span class="p">)</span>

<span class="n">save_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;processed(r)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;rf(r).csv&quot;</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="n">rf_submission</span><span class="p">,</span><span class="w"> </span><span class="n">save_dir</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="xgboost">
<h3>XGBoost<a class="headerlink" href="#xgboost" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define training control for cross-validation</span>
<span class="n">xgb_control</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">trainControl</span><span class="p">(</span>
<span class="w">  </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;cv&quot;</span><span class="p">,</span><span class="w">        </span><span class="c1"># Cross-validation</span>
<span class="w">  </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w">           </span><span class="c1"># 5-fold CV</span>
<span class="w">  </span><span class="n">verboseIter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w">  </span><span class="c1"># Don&#39;t show training progress</span>
<span class="w">  </span><span class="n">allowParallel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="w">  </span><span class="c1"># Enable parallel processing</span>
<span class="p">)</span>

<span class="c1"># Define the tuning grid for hyperparameters</span>
<span class="n">xgb_grid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">expand.grid</span><span class="p">(</span>
<span class="w">  </span><span class="n">nrounds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">400</span><span class="p">,</span><span class="w"> </span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="m">600</span><span class="p">),</span><span class="w">       </span><span class="c1"># Number of boosting rounds</span>
<span class="w">  </span><span class="n">eta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="m">0.05</span><span class="p">),</span><span class="w">                </span><span class="c1"># Learning rate</span>
<span class="w">  </span><span class="n">max_depth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w">             </span><span class="c1"># Tree depth</span>
<span class="w">  </span><span class="n">gamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.1</span><span class="p">),</span><span class="w">                  </span><span class="c1"># Minimum loss reduction</span>
<span class="w">  </span><span class="n">colsample_bytree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w">       </span><span class="c1"># Feature sampling ratio</span>
<span class="w">  </span><span class="n">min_child_weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w">         </span><span class="c1"># Minimum sum of instance weight</span>
<span class="w">  </span><span class="n">subsample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">               </span><span class="c1"># Row sampling ratio</span>
<span class="p">)</span>

<span class="c1"># Train the XGBoost model</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">xgb_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
<span class="w">  </span><span class="n">SalePrice_log</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_train</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;xgbTree&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">trControl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xgb_control</span><span class="p">,</span>
<span class="w">  </span><span class="n">tuneGrid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xgb_grid</span><span class="p">,</span>
<span class="w">  </span><span class="n">verbosity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">            </span><span class="c1"># don&#39;t print training process</span>
<span class="w">  </span><span class="n">nthread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="w">             </span><span class="c1"># Adjust based on CPU cores</span>
<span class="w">  </span><span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RMSE&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">maximize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">xgb_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eXtreme Gradient Boosting 

1460 samples
  82 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 1169, 1169, 1167, 1168, 1167 
Resampling results across tuning parameters:

  eta   max_depth  gamma  colsample_bytree  min_child_weight  subsample
  0.01  2          0.0    0.8               1                 0.8      
  0.01  2          0.0    0.8               1                 1.0      
  0.01  2          0.0    0.8               2                 0.8      
  0.01  2          0.0    0.8               2                 1.0      
  0.01  2          0.0    1.0               1                 0.8      
  0.01  2          0.0    1.0               1                 1.0      
  0.01  2          0.0    1.0               2                 0.8      
  0.01  2          0.0    1.0               2                 1.0      
  0.01  2          0.1    0.8               1                 0.8      
  0.01  2          0.1    0.8               1                 1.0      
  0.01  2          0.1    0.8               2                 0.8      
  0.01  2          0.1    0.8               2                 1.0      
  0.01  2          0.1    1.0               1                 0.8      
  0.01  2          0.1    1.0               1                 1.0      
  0.01  2          0.1    1.0               2                 0.8      
  0.01  2          0.1    1.0               2                 1.0      
  0.01  3          0.0    0.8               1                 0.8      
  0.01  3          0.0    0.8               1                 1.0      
  0.01  3          0.0    0.8               2                 0.8      
  0.01  3          0.0    0.8               2                 1.0      
  0.01  3          0.0    1.0               1                 0.8      
  0.01  3          0.0    1.0               1                 1.0      
  0.01  3          0.0    1.0               2                 0.8      
  0.01  3          0.0    1.0               2                 1.0      
  0.01  3          0.1    0.8               1                 0.8      
  0.01  3          0.1    0.8               1                 1.0      
  0.01  3          0.1    0.8               2                 0.8      
  0.01  3          0.1    0.8               2                 1.0      
  0.01  3          0.1    1.0               1                 0.8      
  0.01  3          0.1    1.0               1                 1.0      
  0.01  3          0.1    1.0               2                 0.8      
  0.01  3          0.1    1.0               2                 1.0      
  0.01  4          0.0    0.8               1                 0.8      
  0.01  4          0.0    0.8               1                 1.0      
  0.01  4          0.0    0.8               2                 0.8      
  0.01  4          0.0    0.8               2                 1.0      
  0.01  4          0.0    1.0               1                 0.8      
  0.01  4          0.0    1.0               1                 1.0      
  0.01  4          0.0    1.0               2                 0.8      
  0.01  4          0.0    1.0               2                 1.0      
  0.01  4          0.1    0.8               1                 0.8      
  0.01  4          0.1    0.8               1                 1.0      
  0.01  4          0.1    0.8               2                 0.8      
  0.01  4          0.1    0.8               2                 1.0      
  0.01  4          0.1    1.0               1                 0.8      
  0.01  4          0.1    1.0               1                 1.0      
  0.01  4          0.1    1.0               2                 0.8      
  0.01  4          0.1    1.0               2                 1.0      
  0.05  2          0.0    0.8               1                 0.8      
  0.05  2          0.0    0.8               1                 1.0      
  0.05  2          0.0    0.8               2                 0.8      
  0.05  2          0.0    0.8               2                 1.0      
  0.05  2          0.0    1.0               1                 0.8      
  0.05  2          0.0    1.0               1                 1.0      
  0.05  2          0.0    1.0               2                 0.8      
  0.05  2          0.0    1.0               2                 1.0      
  0.05  2          0.1    0.8               1                 0.8      
  0.05  2          0.1    0.8               1                 1.0      
  0.05  2          0.1    0.8               2                 0.8      
  0.05  2          0.1    0.8               2                 1.0      
  0.05  2          0.1    1.0               1                 0.8      
  0.05  2          0.1    1.0               1                 1.0      
  0.05  2          0.1    1.0               2                 0.8      
  0.05  2          0.1    1.0               2                 1.0      
  0.05  3          0.0    0.8               1                 0.8      
  0.05  3          0.0    0.8               1                 1.0      
  0.05  3          0.0    0.8               2                 0.8      
  0.05  3          0.0    0.8               2                 1.0      
  0.05  3          0.0    1.0               1                 0.8      
  0.05  3          0.0    1.0               1                 1.0      
  0.05  3          0.0    1.0               2                 0.8      
  0.05  3          0.0    1.0               2                 1.0      
  0.05  3          0.1    0.8               1                 0.8      
  0.05  3          0.1    0.8               1                 1.0      
  0.05  3          0.1    0.8               2                 0.8      
  0.05  3          0.1    0.8               2                 1.0      
  0.05  3          0.1    1.0               1                 0.8      
  0.05  3          0.1    1.0               1                 1.0      
  0.05  3          0.1    1.0               2                 0.8      
  0.05  3          0.1    1.0               2                 1.0      
  0.05  4          0.0    0.8               1                 0.8      
  0.05  4          0.0    0.8               1                 1.0      
  0.05  4          0.0    0.8               2                 0.8      
  0.05  4          0.0    0.8               2                 1.0      
  0.05  4          0.0    1.0               1                 0.8      
  0.05  4          0.0    1.0               1                 1.0      
  0.05  4          0.0    1.0               2                 0.8      
  0.05  4          0.0    1.0               2                 1.0      
  0.05  4          0.1    0.8               1                 0.8      
  0.05  4          0.1    0.8               1                 1.0      
  0.05  4          0.1    0.8               2                 0.8      
  0.05  4          0.1    0.8               2                 1.0      
  0.05  4          0.1    1.0               1                 0.8      
  0.05  4          0.1    1.0               1                 1.0      
  0.05  4          0.1    1.0               2                 0.8      
  0.05  4          0.1    1.0               2                 1.0      
  RMSE       Rsquared   MAE       
  0.2674426  0.8427061  0.23459442
  0.2665025  0.8435777  0.23389561
  0.2677552  0.8420158  0.23487203
  0.2666581  0.8436973  0.23402377
  0.2673682  0.8421636  0.23439542
  0.2663729  0.8438931  0.23386450
  0.2671335  0.8429491  0.23427391
  0.2663047  0.8445997  0.23384919
  0.2676488  0.8418476  0.23454578
  0.2666718  0.8433375  0.23398229
  0.2674658  0.8420859  0.23439216
  0.2663977  0.8441113  0.23384652
  0.2674369  0.8420214  0.23450497
  0.2664955  0.8436680  0.23393618
  0.2675489  0.8423303  0.23456927
  0.2663613  0.8445533  0.23385743
  0.2624078  0.8580467  0.23194906
  0.2617033  0.8585858  0.23177669
  0.2625388  0.8570844  0.23172941
  0.2616960  0.8586496  0.23162674
  0.2626995  0.8572430  0.23207201
  0.2618082  0.8582050  0.23182066
  0.2625111  0.8582894  0.23203975
  0.2617648  0.8584586  0.23161683
  0.2626191  0.8569038  0.23192935
  0.2618372  0.8582525  0.23179081
  0.2626499  0.8561484  0.23176740
  0.2615355  0.8585311  0.23126732
  0.2626204  0.8570590  0.23201030
  0.2618337  0.8578479  0.23178995
  0.2628234  0.8565929  0.23216312
  0.2617571  0.8588351  0.23159877
  0.2606377  0.8655160  0.23090431
  0.2600518  0.8648643  0.23082648
  0.2605597  0.8664500  0.23096934
  0.2599090  0.8650757  0.23045348
  0.2610646  0.8647910  0.23153417
  0.2601972  0.8648333  0.23080260
  0.2603953  0.8652052  0.23077552
  0.2600749  0.8649822  0.23053299
  0.2609384  0.8631836  0.23126733
  0.2599903  0.8634732  0.23069477
  0.2604561  0.8650215  0.23096952
  0.2602902  0.8638525  0.23064996
  0.2609973  0.8640400  0.23128405
  0.2599727  0.8640398  0.23053968
  0.2609179  0.8642933  0.23107640
  0.2600315  0.8646526  0.23052310
  0.1317881  0.8918497  0.08705925
  0.1328718  0.8900443  0.08964776
  0.1304375  0.8940294  0.08705810
  0.1314973  0.8923925  0.08895901
  0.1304682  0.8939120  0.08663787
  0.1322679  0.8908917  0.08996039
  0.1307059  0.8934723  0.08733899
  0.1312586  0.8925804  0.08949422
  0.1337954  0.8885581  0.08975669
  0.1359362  0.8854774  0.09270269
  0.1337471  0.8887607  0.08980617
  0.1361690  0.8849986  0.09251612
  0.1342147  0.8879668  0.08947439
  0.1363596  0.8847613  0.09287078
  0.1333915  0.8891499  0.08960885
  0.1359700  0.8854499  0.09268589
  0.1290224  0.8959769  0.08493457
  0.1266440  0.8996855  0.08537632
  0.1269220  0.8991915  0.08447927
  0.1285390  0.8967898  0.08641749
  0.1263128  0.9003197  0.08335503
  0.1274231  0.8981546  0.08600511
  0.1271342  0.8986386  0.08488650
  0.1282467  0.8972557  0.08592856
  0.1304566  0.8940208  0.08840227
  0.1335931  0.8891449  0.09106910
  0.1319498  0.8916188  0.08940726
  0.1345240  0.8876467  0.09157519
  0.1308307  0.8931915  0.08821965
  0.1353757  0.8863153  0.09263494
  0.1325931  0.8904917  0.08961553
  0.1350417  0.8870217  0.09242410
  0.1274684  0.8982670  0.08400865
  0.1265582  0.8996254  0.08542955
  0.1266545  0.8995481  0.08367745
  0.1274532  0.8985573  0.08495362
  0.1259326  0.9006082  0.08391668
  0.1270658  0.8989115  0.08554302
  0.1262197  0.9002912  0.08384277
  0.1276361  0.8981920  0.08526380
  0.1305978  0.8936195  0.08805463
  0.1324574  0.8912089  0.09047717
  0.1308349  0.8935777  0.08858110
  0.1340192  0.8885791  0.09124193
  0.1299655  0.8948461  0.08773780
  0.1355903  0.8859485  0.09312126
  0.1318776  0.8916703  0.08907883
  0.1351936  0.8869130  0.09290608

Tuning parameter &#39;nrounds&#39; was held constant at a value of 400
RMSE was used to select the optimal model using the smallest value.
The final values used for the model were nrounds = 400, max_depth = 4, eta
 = 0.05, gamma = 0, colsample_bytree = 1, min_child_weight = 1 and subsample
 = 0.8.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">xgb_model</span><span class="p">,</span>
<span class="w">     </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.25</span><span class="p">,</span>
<span class="w">     </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.75</span><span class="p">,</span>
<span class="w">     </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/a2b99d532eef35bef6c287c88ded625b841d6fef2f9efebc7571ac6db8499f79.png"><img alt="../_images/a2b99d532eef35bef6c287c88ded625b841d6fef2f9efebc7571ac6db8499f79.png" src="../_images/a2b99d532eef35bef6c287c88ded625b841d6fef2f9efebc7571ac6db8499f79.png" style="width: 720px; height: 480px;" /></a>
<a class="reference internal image-reference" href="../_images/0b953f7664e6e4cdb6389517ee09a2903fa1a0a1ba94bac96135b50ecec286c6.png"><img alt="../_images/0b953f7664e6e4cdb6389517ee09a2903fa1a0a1ba94bac96135b50ecec286c6.png" src="../_images/0b953f7664e6e4cdb6389517ee09a2903fa1a0a1ba94bac96135b50ecec286c6.png" style="width: 720px; height: 480px;" /></a>
<a class="reference internal image-reference" href="../_images/530eab34b6b27400858297592b76647738137f682d69465637b1a668a1657595.png"><img alt="../_images/530eab34b6b27400858297592b76647738137f682d69465637b1a668a1657595.png" src="../_images/530eab34b6b27400858297592b76647738137f682d69465637b1a668a1657595.png" style="width: 720px; height: 480px;" /></a>
<a class="reference internal image-reference" href="../_images/0652b0b4ce70c39c1d671da2f070ae012fcf2b44205b3e573c21aa5068dc3fe9.png"><img alt="../_images/0652b0b4ce70c39c1d671da2f070ae012fcf2b44205b3e573c21aa5068dc3fe9.png" src="../_images/0652b0b4ce70c39c1d671da2f070ae012fcf2b44205b3e573c21aa5068dc3fe9.png" style="width: 720px; height: 480px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predict final values using model</span>
<span class="n">xgb_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">xgb_model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_test</span><span class="p">)</span>
<span class="n">xgb_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">xgb_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># revert log-transform</span>

<span class="c1"># Prepare submission file</span>
<span class="n">xgb_submission</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span>
<span class="w">  </span><span class="n">SalePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xgb_predictions</span>
<span class="p">)</span>

<span class="c1"># Save submission file</span>
<span class="n">save_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;processed(r)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;xgb(r).csv&quot;</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="n">xgb_submission</span><span class="p">,</span><span class="w"> </span><span class="n">save_dir</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="stacking">
<h3>Stacking<a class="headerlink" href="#stacking" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 1: Get predictions from base models</span>
<span class="n">xgb_pred_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">xgb_model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_train</span><span class="p">)</span>
<span class="n">xgb_pred_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">xgb_model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_test</span><span class="p">)</span>

<span class="c1"># Get the best lambda value from cross-validation</span>
<span class="n">ridge_lambda</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ridge_model</span><span class="o">$</span><span class="n">lambda.min</span><span class="w">  </span><span class="c1"># Alternatively, use ridge_model$lambda.1se</span>

<span class="c1"># Predict using the trained ridge regression model</span>
<span class="n">ridge_pred_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">ridge_model</span><span class="o">$</span><span class="n">glmnet.fit</span><span class="p">,</span><span class="w"> </span><span class="n">newx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_train</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ridge_lambda</span><span class="p">)</span>
<span class="n">ridge_pred_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">ridge_model</span><span class="o">$</span><span class="n">glmnet.fit</span><span class="p">,</span><span class="w"> </span><span class="n">newx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ridge_lambda</span><span class="p">)</span>

<span class="n">svm_pred_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">svm_model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train</span><span class="p">)</span>
<span class="n">svm_pred_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">svm_model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">)</span>

<span class="c1"># Step 2: Construct Stacking Dataset</span>
<span class="n">stack_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">XGB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xgb_pred_train</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">Ridge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ridge_pred_train</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">SVM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">svm_pred_train</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">SalePrice_log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y_train</span>
<span class="p">)</span>

<span class="n">stack_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">XGB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xgb_pred_test</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">Ridge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ridge_pred_test</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">SVM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">svm_pred_test</span>
<span class="p">)</span>

<span class="c1"># Step 3: Train Meta-Learner (Using Ridge)</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">stack_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
<span class="w">  </span><span class="n">SalePrice_log</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stack_train</span><span class="p">,</span>
<span class="w">  </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;glmnet&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1"># Using Ridge as meta-learner</span>
<span class="w">  </span><span class="n">trControl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">trainControl</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;cv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">),</span>
<span class="w">  </span><span class="n">tuneGrid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expand.grid</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">0.0001</span><span class="p">,</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)),</span>
<span class="w">  </span><span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RMSE&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">stack_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>glmnet 

1460 samples
   3 predictor

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 1169, 1169, 1167, 1168, 1167 
Resampling results across tuning parameters:

  lambda       RMSE        Rsquared   MAE       
  0.000100000  0.06920248  0.9712447  0.05080970
  0.001109091  0.06920248  0.9712447  0.05080970
  0.002118182  0.06920248  0.9712447  0.05080970
  0.003127273  0.06920248  0.9712447  0.05080970
  0.004136364  0.06920248  0.9712447  0.05080970
  0.005145455  0.06920248  0.9712447  0.05080970
  0.006154545  0.06920248  0.9712447  0.05080970
  0.007163636  0.06920248  0.9712447  0.05080970
  0.008172727  0.06920248  0.9712447  0.05080970
  0.009181818  0.06920248  0.9712447  0.05080970
  0.010190909  0.06920248  0.9712447  0.05080970
  0.011200000  0.06920248  0.9712447  0.05080970
  0.012209091  0.06920248  0.9712447  0.05080970
  0.013218182  0.06920248  0.9712447  0.05080970
  0.014227273  0.06920248  0.9712447  0.05080970
  0.015236364  0.06920248  0.9712447  0.05080970
  0.016245455  0.06920248  0.9712447  0.05080970
  0.017254545  0.06920248  0.9712447  0.05080970
  0.018263636  0.06920248  0.9712447  0.05080970
  0.019272727  0.06920248  0.9712447  0.05080970
  0.020281818  0.06920248  0.9712447  0.05080970
  0.021290909  0.06920248  0.9712447  0.05080970
  0.022300000  0.06920248  0.9712447  0.05080970
  0.023309091  0.06920248  0.9712447  0.05080970
  0.024318182  0.06920248  0.9712447  0.05080970
  0.025327273  0.06920248  0.9712447  0.05080970
  0.026336364  0.06920248  0.9712447  0.05080970
  0.027345455  0.06920248  0.9712447  0.05080970
  0.028354545  0.06920248  0.9712447  0.05080970
  0.029363636  0.06920248  0.9712447  0.05080970
  0.030372727  0.06920248  0.9712447  0.05080970
  0.031381818  0.06920248  0.9712447  0.05080970
  0.032390909  0.06920248  0.9712447  0.05080970
  0.033400000  0.06920248  0.9712447  0.05080970
  0.034409091  0.06920248  0.9712447  0.05080970
  0.035418182  0.06920248  0.9712447  0.05080970
  0.036427273  0.06920248  0.9712447  0.05080970
  0.037436364  0.06920248  0.9712447  0.05080970
  0.038445455  0.06920248  0.9712447  0.05080970
  0.039454545  0.06923313  0.9712287  0.05082905
  0.040463636  0.06937357  0.9711465  0.05091653
  0.041472727  0.06956622  0.9710309  0.05103645
  0.042481818  0.06976022  0.9709146  0.05115911
  0.043490909  0.06995150  0.9708012  0.05128140
  0.044500000  0.07013157  0.9706984  0.05139659
  0.045509091  0.07030972  0.9705980  0.05151029
  0.046518182  0.07048914  0.9704972  0.05162472
  0.047527273  0.07066635  0.9703987  0.05173732
  0.048536364  0.07083584  0.9703078  0.05184512
  0.049545455  0.07100077  0.9702217  0.05194948
  0.050554545  0.07116689  0.9701353  0.05205444
  0.051563636  0.07133350  0.9700491  0.05215954
  0.052572727  0.07149832  0.9699652  0.05226330
  0.053581818  0.07165521  0.9698892  0.05236164
  0.054590909  0.07181169  0.9698143  0.05245916
  0.055600000  0.07196931  0.9697392  0.05255705
  0.056609091  0.07212720  0.9696645  0.05265457
  0.057618182  0.07228372  0.9695917  0.05275052
  0.058627273  0.07243319  0.9695259  0.05284224
  0.059636364  0.07258188  0.9694616  0.05293430
  0.060645455  0.07273166  0.9693971  0.05302806
  0.061654545  0.07288252  0.9693324  0.05312241
  0.062663636  0.07303221  0.9692694  0.05321531
  0.063672727  0.07317972  0.9692089  0.05330636
  0.064681818  0.07332201  0.9691539  0.05339481
  0.065690909  0.07346507  0.9690990  0.05348354
  0.066700000  0.07360915  0.9690439  0.05357251
  0.067709091  0.07375427  0.9689886  0.05366209
  0.068718182  0.07389835  0.9689349  0.05375123
  0.069727273  0.07404163  0.9688826  0.05384009
  0.070736364  0.07418000  0.9688354  0.05392562
  0.071745455  0.07431875  0.9687887  0.05401078
  0.072754545  0.07445848  0.9687419  0.05409597
  0.073763636  0.07459919  0.9686949  0.05418213
  0.074772727  0.07474020  0.9686483  0.05426877
  0.075781818  0.07488067  0.9686028  0.05435484
  0.076790909  0.07501922  0.9685597  0.05443918
  0.077800000  0.07515565  0.9685192  0.05452271
  0.078809091  0.07529295  0.9684786  0.05460752
  0.079818182  0.07543118  0.9684380  0.05469333
  0.080827273  0.07557034  0.9683972  0.05477985
  0.081836364  0.07571018  0.9683565  0.05486657
  0.082845455  0.07584907  0.9683172  0.05495237
  0.083854545  0.07598771  0.9682788  0.05503829
  0.084863636  0.07612216  0.9682446  0.05512334
  0.085872727  0.07625636  0.9682114  0.05520811
  0.086881818  0.07639144  0.9681781  0.05529287
  0.087890909  0.07652739  0.9681446  0.05537764
  0.088900000  0.07666422  0.9681111  0.05546289
  0.089909091  0.07680158  0.9680778  0.05554891
  0.090918182  0.07693860  0.9680453  0.05563521
  0.091927273  0.07707571  0.9680133  0.05572193
  0.092936364  0.07721019  0.9679839  0.05580700
  0.093945455  0.07734451  0.9679553  0.05589165
  0.094954545  0.07747966  0.9679266  0.05597654
  0.095963636  0.07761563  0.9678979  0.05606194
  0.096972727  0.07775242  0.9678691  0.05614964
  0.097981818  0.07789003  0.9678402  0.05623880
  0.098990909  0.07802758  0.9678119  0.05632857
  0.100000000  0.07816523  0.9677842  0.05641875

Tuning parameter &#39;alpha&#39; was held constant at a value of 0
RMSE was used to select the optimal model using the smallest value.
The final values used for the model were alpha = 0 and lambda = 0.03844545.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">stack_model</span><span class="p">,</span>
<span class="w">     </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">,</span>
<span class="w">     </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.75</span><span class="p">,</span>
<span class="w">     </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/70c0e6d36aae2215d40ac89c1814ef2dbe85ff73b7e76d102ce2f23c105b2aef.png"><img alt="../_images/70c0e6d36aae2215d40ac89c1814ef2dbe85ff73b7e76d102ce2f23c105b2aef.png" src="../_images/70c0e6d36aae2215d40ac89c1814ef2dbe85ff73b7e76d102ce2f23c105b2aef.png" style="width: 720px; height: 480px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 4: Make final predictions</span>
<span class="n">stack_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">stack_model</span><span class="o">$</span><span class="n">finalModel</span><span class="p">,</span><span class="w"> </span><span class="n">newx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">stack_test</span><span class="p">),</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stack_model</span><span class="o">$</span><span class="n">bestTune</span><span class="o">$</span><span class="n">lambda</span><span class="p">)</span>

<span class="c1"># Step 5: Convert predictions back to original scale</span>
<span class="n">stack_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">stack_predictions</span><span class="p">)</span><span class="w">  </span><span class="c1"># Assuming log-transformed target</span>

<span class="c1"># Prepare submission file</span>
<span class="n">stack_submission</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span>
<span class="w">  </span><span class="n">SalePrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.vector</span><span class="p">(</span><span class="n">stack_predictions</span><span class="p">)</span><span class="w"> </span><span class="c1"># avoid including column names</span>
<span class="p">)</span>

<span class="c1"># Save submission file</span>
<span class="n">save_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;house-prices&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;processed(r)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;stack(r).csv&quot;</span><span class="p">)</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="n">stack_submission</span><span class="p">,</span><span class="w"> </span><span class="n">save_dir</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Kaggle Competition: https://www.kaggle.com/competitions/house-prices-advanced-regression-techniques/overview</p></li>
<li><p>Dataset Description: https://www.kaggle.com/competitions/house-prices-advanced-regression-techniques/data</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./archive"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="house-prices-py.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">House Prices - Advanced Regression Techniques (Python)</p>
      </div>
    </a>
    <a class="right-next"
       href="twitter-sentiment-extactio.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tweet Sentiment Extraction</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practice-skills">Practice Skills</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgments">Acknowledgments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation">Evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#goal">Goal</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metric">Metric</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#file-descriptions">File descriptions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-engineering">Feature Engineering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-missing-values">Handling Missing Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encoding">Encoding</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#label-encoding">Label Encoding</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#one-hot-encoding">One-Hot Encoding</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize-data-standard-scaling">Normalize Data (Standard Scaling)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling">Modeling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#knn">kNN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#svm">SVM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression">Linear Regression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso">Lasso</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge">Ridge</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#elasticnet">ElasticNet</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-tree">Decision Tree</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bagging">Bagging</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest">Random Forest</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost">XGBoost</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking">Stacking</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Arno Zeng
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>